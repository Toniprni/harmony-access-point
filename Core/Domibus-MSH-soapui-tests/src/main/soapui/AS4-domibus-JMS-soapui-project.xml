<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="1c29d1fb-f8ae-4ddb-ac43-1469a15001ec" activeEnvironment="Default" name="TESTS_JMS" resourceRoot="" soapui-version="5.2.1" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings><con:setting id="ProjectSettings@hermesConfig">C:\ec</con:setting></con:settings><con:interface xsi:type="con:WsdlInterface" id="9581111c-248c-4085-bf9f-dc452577042f" wsaVersion="NONE" name="BackendService_1_1SoapBinding" type="wsdl" bindingName="{http://org.ecodex.backend/1_1/}BackendService_1_1SoapBinding" soapVersion="1_2" anonymous="optional" definition="http://localhost:8080/domibus/services/backend?wsdl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart="http://localhost:8080/domibus/services/backend?wsdl"><con:part><con:url>http://localhost:8080/domibus/services/backend?wsdl</con:url><con:content><![CDATA[<wsdl:definitions name="BackendService_1_1" targetNamespace="http://org.ecodex.backend/1_1/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:tns="http://org.ecodex.backend/1_1/" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" xmlns:ns2="http://schemas.xmlsoap.org/soap/http" xmlns:ns1="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/">
  <wsdl:types>
    <xsd:schema attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:tns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/">
      <xsd:import namespace="http://www.w3.org/XML/1998/namespace"/>
      <xsd:annotation>
        <xsd:appinfo>Schema for Domibus messages' headers submission</xsd:appinfo>
        <xsd:documentation xml:lang="en">This schema defines an XML subset of ebMS-3 headers which is used to validate messages submitted to Domibus
            through WS plugin.</xsd:documentation>
      </xsd:annotation>
      <xsd:element name="Messaging" type="Messaging"/>
      <xsd:complexType name="Messaging">
        <xsd:sequence>
          <xsd:element maxOccurs="1" minOccurs="0" name="UserMessage" type="UserMessage"/>
        </xsd:sequence>
        <xsd:attribute name="mustUnderstand" type="xsd:boolean" use="optional"/>
      </xsd:complexType>
      <xsd:complexType name="UserMessage">
        <xsd:all>
          <xsd:element maxOccurs="1" minOccurs="0" name="MessageInfo" type="MessageInfo"/>
          <xsd:element maxOccurs="1" minOccurs="1" name="PartyInfo" type="PartyInfo"/>
          <xsd:element maxOccurs="1" minOccurs="1" name="CollaborationInfo" type="CollaborationInfo"/>
          <xsd:element maxOccurs="1" minOccurs="1" name="MessageProperties" type="tns:MessageProperties"/>
          <xsd:element maxOccurs="1" minOccurs="1" name="PayloadInfo" type="tns:PayloadInfo"/>
        </xsd:all>
        <xsd:attribute name="mpc" type="xsd:anyURI" use="optional"/>
      </xsd:complexType>
      <xsd:complexType name="MessageInfo">
        <xsd:all>
          <xsd:element maxOccurs="1" minOccurs="0" name="Timestamp" type="xsd:dateTime"/>
          <xsd:element maxOccurs="1" minOccurs="0" name="MessageId" type="tns:max255-non-empty-string"/>
          <xsd:element maxOccurs="1" minOccurs="0" name="RefToMessageId" type="tns:max255-non-empty-string"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="PartyInfo">
        <xsd:all>
          <xsd:element maxOccurs="1" minOccurs="1" name="From" type="tns:From"/>
          <xsd:element maxOccurs="1" minOccurs="0" name="To" type="tns:To"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="PartyId">
        <xsd:simpleContent>
          <xsd:extension base="tns:max255-non-empty-string">
            <xsd:attribute name="type" type="tns:max255-non-empty-string" use="required"/>
          </xsd:extension>
        </xsd:simpleContent>
      </xsd:complexType>
      <xsd:complexType name="From">
        <xsd:all>
          <xsd:element maxOccurs="1" minOccurs="1" name="PartyId" type="tns:PartyId"/>
          <xsd:element maxOccurs="1" minOccurs="1" name="Role" type="tns:max255-non-empty-string"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="To">
        <xsd:all>
          <xsd:element maxOccurs="1" minOccurs="1" name="PartyId" type="tns:PartyId"/>
          <xsd:element maxOccurs="1" minOccurs="1" name="Role" type="tns:max255-non-empty-string"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="CollaborationInfo">
        <xsd:all>
          <xsd:element minOccurs="0" name="AgreementRef" type="tns:AgreementRef"/>
          <xsd:element maxOccurs="1" minOccurs="1" name="Service" type="tns:Service"/>
          <xsd:element maxOccurs="1" minOccurs="1" name="Action" type="xsd:token"/>
          <xsd:element maxOccurs="1" minOccurs="0" name="ConversationId" type="xsd:token"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="Service">
        <xsd:simpleContent>
          <xsd:extension base="tns:max255-non-empty-string">
            <xsd:attribute name="type" type="tns:max255-non-empty-string" use="required"/>
          </xsd:extension>
        </xsd:simpleContent>
      </xsd:complexType>
      <xsd:complexType name="AgreementRef">
        <xsd:simpleContent>
          <xsd:extension base="tns:max255-non-empty-string">
            <xsd:attribute name="type" type="tns:max255-non-empty-string" use="optional"/>
            <xsd:attribute name="pmode" type="tns:max255-non-empty-string" use="optional"/>
          </xsd:extension>
        </xsd:simpleContent>
      </xsd:complexType>
      <xsd:complexType name="PayloadInfo">
        <xsd:sequence>
          <xsd:element maxOccurs="unbounded" minOccurs="1" name="PartInfo" type="tns:PartInfo"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="PartInfo">
        <xsd:all>
          <xsd:element minOccurs="0" name="Schema" type="Schema"/>
          <xsd:element maxOccurs="1" minOccurs="0" name="Description" type="tns:Description"/>
          <xsd:element minOccurs="0" name="PartProperties" type="tns:PartProperties"/>
        </xsd:all>
        <xsd:attribute name="href" type="xsd:token" use="required"/>
      </xsd:complexType>
      <xsd:complexType name="Property">
        <xsd:simpleContent>
          <xsd:extension base="tns:max1024-non-empty-string">
            <xsd:attribute name="name" type="tns:max255-non-empty-string" use="required"/>
            <xsd:attribute name="type" type="tns:max255-non-empty-string" use="optional"/>
          </xsd:extension>
        </xsd:simpleContent>
      </xsd:complexType>
      <xsd:complexType name="PartProperties">
        <xsd:sequence>
          <xsd:element maxOccurs="unbounded" name="Property" type="tns:Property"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="MessageProperties">
        <xsd:sequence>
          <xsd:element maxOccurs="unbounded" name="Property" type="Property"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="Schema">
        <xsd:attribute name="location" type="xsd:anyURI" use="optional"/>
        <xsd:attribute name="version" type="tns:max255-non-empty-string" use="optional"/>
        <xsd:attribute name="namespace" type="tns:max255-non-empty-string" use="optional"/>
      </xsd:complexType>
      <xsd:complexType name="Description">
        <xsd:simpleContent>
          <xsd:extension base="tns:max255-non-empty-string">
            <xsd:attribute ref="xml:lang" use="required"/>
          </xsd:extension>
        </xsd:simpleContent>
      </xsd:complexType>
      <xsd:simpleType name="max255-non-empty-string">
        <xsd:restriction base="xsd:string">
          <xsd:minLength value="1"/>
          <xsd:maxLength value="255"/>
        </xsd:restriction>
      </xsd:simpleType>
      <xsd:simpleType name="max1024-non-empty-string">
        <xsd:restriction base="xsd:string">
          <xsd:minLength value="1"/>
          <xsd:maxLength value="1024"/>
        </xsd:restriction>
      </xsd:simpleType>
    </xsd:schema>
    <xsd:schema attributeFormDefault="unqualified" elementFormDefault="unqualified" targetNamespace="http://org.ecodex.backend/1_1/" xmlns:ns1="http://www.w3.org/2005/05/xmlmime">
      <xsd:import namespace="http://www.w3.org/2005/05/xmlmime"/>
      <xsd:simpleType name="max255-non-empty-string">
        <xsd:restriction base="xsd:string">
          <xsd:minLength value="1"/>
          <xsd:maxLength value="255"/>
        </xsd:restriction>
      </xsd:simpleType>
      <xsd:element name="FaultDetail">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="code" type="xsd:string"/>
            <xsd:element name="message" nillable="true" type="xsd:string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="retrieveMessageRequest">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="messageID" nillable="true" type="tns:max255-non-empty-string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="retrieveMessageResponse">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element minOccurs="0" name="bodyload" type="tns:LargePayloadType"/>
            <xsd:element maxOccurs="unbounded" minOccurs="0" name="payload" type="tns:LargePayloadType"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="listPendingMessagesRequest" nillable="false" type="xsd:anyType"/>
      <xsd:element name="listPendingMessagesResponse">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element maxOccurs="unbounded" minOccurs="0" name="messageID" nillable="true" type="xsd:string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="messageErrorsRequest">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="messageStatusRequest">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="submitRequest">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element minOccurs="0" name="bodyload" type="tns:LargePayloadType"/>
            <xsd:element maxOccurs="unbounded" minOccurs="0" name="payload" nillable="true" type="tns:LargePayloadType"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="submitResponse">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element maxOccurs="unbounded" minOccurs="0" name="messageID" nillable="true" type="xsd:string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:complexType name="PayloadType">
        <xsd:simpleContent>
          <xsd:extension base="ns1:base64Binary">
            <xsd:attribute name="payloadId" type="xsd:token" use="required"/>
          </xsd:extension>
        </xsd:simpleContent>
      </xsd:complexType>
      <xsd:complexType name="LargePayloadType">
        <xsd:sequence>
          <xsd:element name="value" ns1:expectedContentTypes="application/octet-stream" type="xsd:base64Binary"/>
        </xsd:sequence>
        <xsd:attribute name="payloadId" type="xsd:token" use="required"/>
        <xsd:attribute name="contentType" type="xsd:string"/>
      </xsd:complexType>
      <xsd:complexType name="errorResultImpl">
        <xsd:sequence>
          <xsd:element minOccurs="0" name="errorCode" type="tns:errorCode"/>
          <xsd:element minOccurs="0" name="errorDetail" type="xsd:string"/>
          <xsd:element minOccurs="0" name="messageInErrorId" type="xsd:string"/>
          <xsd:element minOccurs="0" name="mshRole" type="tns:mshRole"/>
          <xsd:element minOccurs="0" name="notified" type="xsd:dateTime"/>
          <xsd:element minOccurs="0" name="timestamp" type="xsd:dateTime"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="PayloadURLType">
        <xsd:simpleContent>
          <xsd:extension base="xsd:string">
            <xsd:attribute name="payloadId" type="xsd:token" use="required"/>
          </xsd:extension>
        </xsd:simpleContent>
      </xsd:complexType>
      <xsd:simpleType name="messageStatus">
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="READY_TO_SEND"/>
          <xsd:enumeration value="READY_TO_PULL"/>
          <xsd:enumeration value="BEING_PULLED"/>
          <xsd:enumeration value="SEND_ENQUEUED"/>
          <xsd:enumeration value="SEND_IN_PROGRESS"/>
          <xsd:enumeration value="WAITING_FOR_RECEIPT"/>
          <xsd:enumeration value="ACKNOWLEDGED"/>
          <xsd:enumeration value="ACKNOWLEDGED_WITH_WARNING"/>
          <xsd:enumeration value="SEND_ATTEMPT_FAILED"/>
          <xsd:enumeration value="SEND_FAILURE"/>
          <xsd:enumeration value="NOT_FOUND"/>
          <xsd:enumeration value="WAITING_FOR_RETRY"/>
          <xsd:enumeration value="RECEIVED"/>
          <xsd:enumeration value="RECEIVED_WITH_WARNINGS"/>
          <xsd:enumeration value="DELETED"/>
          <xsd:enumeration value="DOWNLOADED"/>
        </xsd:restriction>
      </xsd:simpleType>
      <xsd:simpleType name="errorCode">
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="EBMS_0001"/>
          <xsd:enumeration value="EBMS_0002"/>
          <xsd:enumeration value="EBMS_0003"/>
          <xsd:enumeration value="EBMS_0004"/>
          <xsd:enumeration value="EBMS_0005"/>
          <xsd:enumeration value="EBMS_0006"/>
          <xsd:enumeration value="EBMS_0007"/>
          <xsd:enumeration value="EBMS_0008"/>
          <xsd:enumeration value="EBMS_0009"/>
          <xsd:enumeration value="EBMS_0010"/>
          <xsd:enumeration value="EBMS_0011"/>
          <xsd:enumeration value="EBMS_0101"/>
          <xsd:enumeration value="EBMS_0102"/>
          <xsd:enumeration value="EBMS_0103"/>
          <xsd:enumeration value="EBMS_0201"/>
          <xsd:enumeration value="EBMS_0202"/>
          <xsd:enumeration value="EBMS_0301"/>
          <xsd:enumeration value="EBMS_0302"/>
          <xsd:enumeration value="EBMS_0303"/>
          <xsd:enumeration value="EBMS_0020"/>
          <xsd:enumeration value="EBMS_0021"/>
          <xsd:enumeration value="EBMS_0022"/>
          <xsd:enumeration value="EBMS_0023"/>
          <xsd:enumeration value="EBMS_0030"/>
          <xsd:enumeration value="EBMS_0031"/>
          <xsd:enumeration value="EBMS_0040"/>
          <xsd:enumeration value="EBMS_0041"/>
          <xsd:enumeration value="EBMS_0042"/>
          <xsd:enumeration value="EBMS_0043"/>
          <xsd:enumeration value="EBMS_0044"/>
          <xsd:enumeration value="EBMS_0045"/>
          <xsd:enumeration value="EBMS_0046"/>
          <xsd:enumeration value="EBMS_0047"/>
          <xsd:enumeration value="EBMS_0048"/>
          <xsd:enumeration value="EBMS_0049"/>
          <xsd:enumeration value="EBMS_0050"/>
          <xsd:enumeration value="EBMS_0051"/>
          <xsd:enumeration value="EBMS_0052"/>
          <xsd:enumeration value="EBMS_0053"/>
          <xsd:enumeration value="EBMS_0054"/>
          <xsd:enumeration value="EBMS_0055"/>
          <xsd:enumeration value="EBMS_0060"/>
          <xsd:enumeration value="EBMS_0065"/>
        </xsd:restriction>
      </xsd:simpleType>
      <xsd:simpleType name="mshRole">
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="SENDING"/>
          <xsd:enumeration value="RECEIVING"/>
        </xsd:restriction>
      </xsd:simpleType>
      <xsd:complexType final="#all" name="errorResultImplArray">
        <xsd:sequence>
          <xsd:element maxOccurs="unbounded" minOccurs="0" name="item" nillable="true" type="tns:errorResultImpl"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:element name="getStatusRequest" nillable="true">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="statusRequest" nillable="true">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="getStatusResponse" nillable="true" type="tns:messageStatus"/>
      <xsd:element name="getErrorsRequest" nillable="true">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="getMessageErrorsResponse" nillable="true" type="tns:errorResultImplArray"/>
    </xsd:schema>
    <xs:schema targetNamespace="http://www.w3.org/XML/1998/namespace" xml:lang="en" xmlns:xs="http://www.w3.org/2001/XMLSchema">
      <xs:annotation>
        <xs:documentation>See http://www.w3.org/XML/1998/namespace.html and
   http://www.w3.org/TR/REC-xml for information about this namespace.

    This schema document describes the XML namespace, in a form
    suitable for import by other schema documents.

    Note that local names in this namespace are intended to be defined
    only by the World Wide Web Consortium or its subgroups.  The
    following names are currently defined in this namespace and should
    not be used with conflicting semantics by any Working Group,
    specification, or document instance:

    base (as an attribute name): denotes an attribute whose value
         provides a URI to be used as the base for interpreting any
         relative URIs in the scope of the element on which it
         appears; its value is inherited.  This name is reserved
         by virtue of its definition in the XML Base specification.

    id   (as an attribute name): denotes an attribute whose value
         should be interpreted as if declared to be of type ID.
         The xml:id specification is not yet a W3C Recommendation,
         but this attribute is included here to facilitate experimentation
         with the mechanisms it proposes.  Note that it is _not_ included
         in the specialAttrs attribute group.

    lang (as an attribute name): denotes an attribute whose value
         is a language code for the natural language of the content of
         any element; its value is inherited.  This name is reserved
         by virtue of its definition in the XML specification.

    space (as an attribute name): denotes an attribute whose
         value is a keyword indicating what whitespace processing
         discipline is intended for the content of the element; its
         value is inherited.  This name is reserved by virtue of its
         definition in the XML specification.

    Father (in any context at all): denotes Jon Bosak, the chair of
         the original XML Working Group.  This name is reserved by
         the following decision of the W3C XML Plenary and
         XML Coordination groups:

             In appreciation for his vision, leadership and dedication
             the W3C XML Plenary on this 10th day of February, 2000
             reserves for Jon Bosak in perpetuity the XML name
             xml:Father</xs:documentation>
      </xs:annotation>
      <xs:annotation>
        <xs:documentation>This schema defines attributes and an attribute group
        suitable for use by
        schemas wishing to allow xml:base, xml:lang, xml:space or xml:id
        attributes on elements they define.

        To enable this, such a schema must import this schema
        for the XML namespace, e.g. as follows:
        &lt;schema . . .>
         . . .
         &lt;import namespace="http://www.w3.org/XML/1998/namespace"
                    schemaLocation="http://www.w3.org/2001/xml.xsd"/>

        Subsequently, qualified reference to any of the attributes
        or the group defined below will have the desired effect, e.g.

        &lt;type . . .>
         . . .
         &lt;attributeGroup ref="xml:specialAttrs"/>

         will define a type which will schema-validate an instance
         element with any of those attributes</xs:documentation>
      </xs:annotation>
      <xs:annotation>
        <xs:documentation>In keeping with the XML Schema WG's standard versioning
   policy, this schema document will persist at
   http://www.w3.org/2005/08/xml.xsd.
   At the date of issue it can also be found at
   http://www.w3.org/2001/xml.xsd.
   The schema document at that URI may however change in the future,
   in order to remain compatible with the latest version of XML Schema
   itself, or with the XML namespace itself.  In other words, if the XML
   Schema or XML namespaces change, the version of this document at
   http://www.w3.org/2001/xml.xsd will change
   accordingly; the version at
   http://www.w3.org/2005/08/xml.xsd will not change.</xs:documentation>
      </xs:annotation>
      <xs:attribute name="lang">
        <xs:annotation>
          <xs:documentation>Attempting to install the relevant ISO 2- and 3-letter
         codes as the enumerated possible values is probably never
         going to be a realistic possibility.  See
         RFC 3066 at http://www.ietf.org/rfc/rfc3066.txt and the IANA registry
         at http://www.iana.org/assignments/lang-tag-apps.htm for
         further information.

         The union allows for the 'un-declaration' of xml:lang with
         the empty string.</xs:documentation>
        </xs:annotation>
        <xs:simpleType>
          <xs:union memberTypes="xs:language">
            <xs:simpleType>
              <xs:restriction base="xs:string">
                <xs:enumeration value=""/>
              </xs:restriction>
            </xs:simpleType>
          </xs:union>
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute name="space">
        <xs:simpleType>
          <xs:restriction base="xs:NCName">
            <xs:enumeration value="default"/>
            <xs:enumeration value="preserve"/>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute name="base" type="xs:anyURI">
        <xs:annotation>
          <xs:documentation>See http://www.w3.org/TR/xmlbase/ for
                     information about this attribute.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute name="id" type="xs:ID">
        <xs:annotation>
          <xs:documentation>See http://www.w3.org/TR/xml-id/ for
                     information about this attribute.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attributeGroup name="specialAttrs">
        <xs:attribute ref="xml:base"/>
        <xs:attribute ref="xml:lang"/>
        <xs:attribute ref="xml:space"/>
      </xs:attributeGroup>
    </xs:schema>
    <xs:schema targetNamespace="http://www.w3.org/2005/05/xmlmime" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xmime="http://www.w3.org/2005/05/xmlmime">
      <xs:attribute name="contentType">
        <xs:simpleType>
          <xs:restriction base="xs:string">
            <xs:minLength value="3"/>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute name="expectedContentTypes" type="xs:string"/>
      <xs:complexType name="base64Binary">
        <xs:simpleContent>
          <xs:extension base="xs:base64Binary">
            <xs:attribute ref="xmime:contentType"/>
          </xs:extension>
        </xs:simpleContent>
      </xs:complexType>
      <xs:complexType name="hexBinary">
        <xs:simpleContent>
          <xs:extension base="xs:hexBinary">
            <xs:attribute ref="xmime:contentType"/>
          </xs:extension>
        </xs:simpleContent>
      </xs:complexType>
    </xs:schema>
  </wsdl:types>
  <wsdl:message name="getStatusResponse">
    <wsdl:part element="tns:getStatusResponse" name="getStatusResponse"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="listPendingMessagesResponse">
    <wsdl:part element="tns:listPendingMessagesResponse" name="listPendingMessagesResponse"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getMessageErrorsResponse">
    <wsdl:part element="tns:getMessageErrorsResponse" name="getMessageErrorsResponse"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="submitMessageResponse">
    <wsdl:part element="tns:submitResponse" name="submitResponse"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="RetrieveMessageFault">
    <wsdl:part element="tns:FaultDetail" name="RetrieveMessageFault"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getMessageErrors">
    <wsdl:part element="tns:getErrorsRequest" name="getErrorsRequest"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getStatus">
    <wsdl:part element="tns:statusRequest" name="statusRequest"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="listPendingMessages">
    <wsdl:part element="tns:listPendingMessagesRequest" name="listPendingMessagesRequest"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="SubmitMessageFault">
    <wsdl:part element="tns:FaultDetail" name="SubmitMessageFault"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="StatusFault">
    <wsdl:part element="tns:FaultDetail" name="StatusFault"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="submitMessage">
    <wsdl:part element="tns:submitRequest" name="submitRequest"></wsdl:part>
    <wsdl:part element="ns1:Messaging" name="ebMSHeaderInfo"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="retrieveMessage">
    <wsdl:part element="tns:retrieveMessageRequest" name="retrieveMessageRequest"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="retrieveMessageResponse">
    <wsdl:part element="tns:retrieveMessageResponse" name="retrieveMessageResponse"></wsdl:part>
    <wsdl:part element="ns1:Messaging" name="ebMSHeaderInfo"></wsdl:part>
  </wsdl:message>
  <wsdl:portType name="BackendInterface">
    <wsdl:operation name="listPendingMessages">
      <wsdl:input message="tns:listPendingMessages" name="listPendingMessages"></wsdl:input>
      <wsdl:output message="tns:listPendingMessagesResponse" name="listPendingMessagesResponse"></wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="getMessageErrors">
      <wsdl:input message="tns:getMessageErrors" name="getMessageErrors"></wsdl:input>
      <wsdl:output message="tns:getMessageErrorsResponse" name="getMessageErrorsResponse"></wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="getStatus">
      <wsdl:input message="tns:getStatus" name="getStatus"></wsdl:input>
      <wsdl:output message="tns:getStatusResponse" name="getStatusResponse"></wsdl:output>
      <wsdl:fault message="tns:StatusFault" name="StatusFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="submitMessage">
      <wsdl:input message="tns:submitMessage" name="submitMessage"></wsdl:input>
      <wsdl:output message="tns:submitMessageResponse" name="submitMessageResponse"></wsdl:output>
      <wsdl:fault message="tns:SubmitMessageFault" name="SubmitMessageFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="retrieveMessage" parameterOrder="retrieveMessageRequest retrieveMessageResponse ebMSHeaderInfo">
      <wsdl:input message="tns:retrieveMessage" name="retrieveMessage"></wsdl:input>
      <wsdl:output message="tns:retrieveMessageResponse" name="retrieveMessageResponse"></wsdl:output>
      <wsdl:fault message="tns:RetrieveMessageFault" name="RetrieveMessageFault"></wsdl:fault>
    </wsdl:operation>
  </wsdl:portType>
  <wsdl:binding name="BackendService_1_1SoapBinding" type="tns:BackendInterface">
    <soap12:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
    <wsdl:operation name="listPendingMessages">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="listPendingMessages">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="listPendingMessagesResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="getMessageErrors">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="getMessageErrors">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getMessageErrorsResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="getStatus">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="getStatus">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getStatusResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="StatusFault">
        <soap12:fault name="StatusFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="submitMessage">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="submitMessage">
        <soap12:header message="tns:submitMessage" part="ebMSHeaderInfo" use="literal"></soap12:header>
        <soap12:body parts="submitRequest" use="literal"/>
      </wsdl:input>
      <wsdl:output name="submitMessageResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="SubmitMessageFault">
        <soap12:fault name="SubmitMessageFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="retrieveMessage">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="retrieveMessage">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="retrieveMessageResponse">
        <soap12:header message="tns:retrieveMessageResponse" part="ebMSHeaderInfo" use="literal"></soap12:header>
        <soap12:body parts="retrieveMessageResponse" use="literal"/>
      </wsdl:output>
      <wsdl:fault name="RetrieveMessageFault">
        <soap12:fault name="RetrieveMessageFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
  </wsdl:binding>
  <wsdl:service name="BackendService_1_1">
    <wsdl:port binding="tns:BackendService_1_1SoapBinding" name="BACKEND_PORT">
      <soap12:address location="http://localhost:8080/domibus/services/backend"/>
    </wsdl:port>
  </wsdl:service>
</wsdl:definitions>]]></con:content><con:type>http://schemas.xmlsoap.org/wsdl/</con:type></con:part></con:definitionCache><con:endpoints><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:endpoint>http://localhost:8080/domibus/services/backend</con:endpoint><con:endpoint>http://wltdgt02.cc.cec.eu.int:1063/domibus/services/backend</con:endpoint></con:endpoints><con:operation id="767cb481-8b7d-45ef-957f-e823696a27be" isOneWay="false" action="" name="getMessageErrors" bindingOperationName="getMessageErrors" type="Request-Response" outputName="getMessageErrorsResponse" inputName="getMessageErrors" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/></con:operation><con:operation id="f3563058-db2b-4135-a5e0-ddcfb8386683" isOneWay="false" action="" name="listPendingMessages" bindingOperationName="listPendingMessages" type="Request-Response" outputName="listPendingMessagesResponse" inputName="listPendingMessages" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/></con:operation><con:operation id="854782c9-2abc-4349-93f6-240147556428" isOneWay="false" action="" name="submitMessage" bindingOperationName="submitMessage" type="Request-Response" outputName="submitMessageResponse" inputName="submitMessage" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="3f133f98-0a64-4fae-bcf5-2e64d1a04e16" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:_1="http://org.ecodex.backend/1_1/">
   <soap:Header>
      <ns:Messaging mustUnderstand="?">
         </ns:Messaging>
   </soap:Header>
   <soap:Body>
      <_1:submitRequest>
         </_1:submitRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/submitMessage"/><con:wsrmConfig version="1.2"/></con:call><con:call id="e984a797-da44-4ed9-88e6-118cdebcc075" name="Request 2"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header>\r
      <ns:Messaging mustUnderstand="?">\r
         <!--Optional:-->\r
         <ns:UserMessage mpc="?">\r
            <!--You may enter the following 5 items in any order-->\r
            <!--Optional:-->\r
            <ns:MessageInfo>\r
               <!--You may enter the following 3 items in any order-->\r
               <!--Optional:-->\r
               <ns:Timestamp>?</ns:Timestamp>\r
               <!--Optional:-->\r
               <ns:MessageId>?</ns:MessageId>\r
               <!--Optional:-->\r
               <ns:RefToMessageId>?</ns:RefToMessageId>\r
            </ns:MessageInfo>\r
            <ns:PartyInfo>\r
               <!--You may enter the following 2 items in any order-->\r
               <ns:From>\r
                  <!--You may enter the following 2 items in any order-->\r
                  <ns:PartyId type="?">?</ns:PartyId>\r
                  <ns:Role>?</ns:Role>\r
               </ns:From>\r
               <!--Optional:-->\r
               <ns:To>\r
                  <!--You may enter the following 2 items in any order-->\r
                  <ns:PartyId type="?">?</ns:PartyId>\r
                  <ns:Role>?</ns:Role>\r
               </ns:To>\r
            </ns:PartyInfo>\r
            <ns:CollaborationInfo>\r
               <!--You may enter the following 4 items in any order-->\r
               <!--Optional:-->\r
               <ns:AgreementRef type="?" pmode="?">?</ns:AgreementRef>\r
               <ns:Service type="?">?</ns:Service>\r
               <ns:Action>?</ns:Action>\r
               <!--Optional:-->\r
               <ns:ConversationId>?</ns:ConversationId>\r
            </ns:CollaborationInfo>\r
            <ns:MessageProperties>\r
               <!--1 or more repetitions:-->\r
               <ns:Property name="?" type="?">?</ns:Property>\r
            </ns:MessageProperties>\r
            <ns:PayloadInfo>\r
               <!--1 or more repetitions:-->\r
               <ns:PartInfo href="?">\r
                  <!--Optional:-->\r
                  <ns:PartProperties>\r
                     <!--1 or more repetitions:-->\r
                     <ns:Property name="?" type="?">?</ns:Property>\r
                  </ns:PartProperties>\r
               </ns:PartInfo>\r
            </ns:PayloadInfo>\r
         </ns:UserMessage>\r
      </ns:Messaging>\r
   </soap:Header>\r
   <soap:Body>\r
      <_1:submitRequest>\r
         <!--Optional:-->\r
         <bodyload payloadId="?" contentType="?">\r
            <value>cid:527230167435</value>\r
         </bodyload>\r
         <!--Zero or more repetitions:-->\r
         <payload payloadId="?" contentType="?">\r
            <value>cid:993829285671</value>\r
         </payload>\r
      </_1:submitRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/submitMessage"/><con:wsrmConfig version="1.2"/></con:call></con:operation><con:operation id="fa93f66f-0dee-457b-9182-2f3dac23e65c" isOneWay="false" action="" name="retrieveMessage" bindingOperationName="retrieveMessage" type="Request-Response" outputName="retrieveMessageResponse" inputName="retrieveMessage" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="8955e910-8ad0-4f6a-84e5-e5305aa8bda4" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:retrieveMessageRequest>\r
         <messageID>?</messageID>\r
      </_1:retrieveMessageRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/retrieveMessage"/></con:call><con:call id="e7667214-6a86-430e-a470-7a5c7d463ed5" name="Request 2"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:retrieveMessageRequest>\r
         <messageID>?</messageID>\r
      </_1:retrieveMessageRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/retrieveMessage"/><con:wsrmConfig version="1.2"/></con:call></con:operation><con:operation id="f3c6fe64-3e6d-4241-b6ef-c2238e21fd0b" isOneWay="false" action="" name="getStatus" bindingOperationName="getStatus" type="Request-Response" outputName="getStatusResponse" inputName="getStatus" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="9e9c4dbc-0255-4c97-bd4e-59e96bee396d" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:statusRequest>\r
         <messageID>?</messageID>\r
      </_1:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getStatus"/><con:wsrmConfig version="1.2"/></con:call></con:operation></con:interface><con:interface xsi:type="con:RestService" id="4105cbbc-1cb0-42ac-b367-be4eb6c1ce49" wadlVersion="http://wadl.dev.java.net/2009/02" name="TESTS_JMS" type="rest" definitionUrl="jmsSer" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache/><con:endpoints/></con:interface><con:interface xsi:type="con:WsdlInterface" id="873472e9-9ce6-43e6-9316-b6c32485d705" wsaVersion="NONE" name="WebServicePluginSoapBinding" type="wsdl" bindingName="{http://eu.domibus.wsplugin/}WebServicePluginSoapBinding" soapVersion="1_2" anonymous="optional" definition="http://localhost:8080/domibus/services/wsplugin?wsdl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart="http://localhost:8080/domibus/services/wsplugin?wsdl"><con:part><con:url>http://localhost:8080/domibus/services/wsplugin?wsdl</con:url><con:content><![CDATA[<wsdl:definitions name="WebServicePlugin" targetNamespace="http://eu.domibus.wsplugin/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:tns="http://eu.domibus.wsplugin/" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" xmlns:ns2="http://schemas.xmlsoap.org/soap/http" xmlns:ns1="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/">
  <wsdl:types>
    <xsd:schema attributeFormDefault="unqualified" elementFormDefault="unqualified" targetNamespace="http://eu.domibus.wsplugin/" xmlns:ns1="http://www.w3.org/2005/05/xmlmime">
      <xsd:import namespace="http://www.w3.org/2005/05/xmlmime"/>
      <xsd:simpleType name="max255-non-empty-string">
        <xsd:restriction base="xsd:string">
          <xsd:minLength value="1"/>
          <xsd:maxLength value="255"/>
        </xsd:restriction>
      </xsd:simpleType>
      <xsd:element name="FaultDetail">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="code" type="xsd:string"/>
            <xsd:element name="message" nillable="true" type="xsd:string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="markMessageAsDownloadedRequest">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="messageID" nillable="true" type="tns:max255-non-empty-string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="markMessageAsDownloadedResponse">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="messageID" nillable="true" type="tns:max255-non-empty-string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="retrieveMessageRequest">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="messageID" nillable="true" type="tns:max255-non-empty-string"/>
          </xsd:sequence>
          <xsd:attribute default="true" name="markAsDownloaded" type="xsd:string"/>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="retrieveMessageResponse">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element minOccurs="0" name="bodyload" type="tns:LargePayloadType"/>
            <xsd:element maxOccurs="unbounded" minOccurs="0" name="payload" type="tns:LargePayloadType"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="listPendingMessagesRequest">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element minOccurs="0" name="messageId" type="tns:max255-non-empty-string"/>
            <xsd:element minOccurs="0" name="conversationId" type="tns:max255-non-empty-string"/>
            <xsd:element minOccurs="0" name="refToMessageId" type="tns:max255-non-empty-string"/>
            <xsd:element minOccurs="0" name="fromPartyId" type="tns:max255-non-empty-string"/>
            <xsd:element minOccurs="0" name="finalRecipient" type="tns:max255-non-empty-string"/>
            <xsd:element minOccurs="0" name="originalSender" type="tns:max255-non-empty-string"/>
            <xsd:element minOccurs="0" name="receivedFrom" type="xsd:dateTime"/>
            <xsd:element minOccurs="0" name="receivedTo" type="xsd:dateTime"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="listPushFailedMessagesRequest">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element minOccurs="0" name="messageId" type="tns:max255-non-empty-string"/>
            <xsd:element minOccurs="0" name="finalRecipient" type="tns:max255-non-empty-string"/>
            <xsd:element minOccurs="0" name="originalSender" type="tns:max255-non-empty-string"/>
            <xsd:element minOccurs="0" name="receivedFrom" type="xsd:dateTime"/>
            <xsd:element minOccurs="0" name="receivedTo" type="xsd:dateTime"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="rePushFailedMessagesRequest">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element maxOccurs="unbounded" minOccurs="0" name="messageID" nillable="true" type="xsd:string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="listPendingMessagesResponse">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element maxOccurs="unbounded" minOccurs="0" name="messageID" nillable="true" type="xsd:string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="listPushFailedMessagesResponse">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element maxOccurs="unbounded" minOccurs="0" name="messageID" nillable="true" type="xsd:string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="messageErrorsRequest">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="messageStatusRequest">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="submitRequest">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element minOccurs="0" name="bodyload" type="tns:LargePayloadType"/>
            <xsd:element maxOccurs="unbounded" minOccurs="0" name="payload" nillable="true" type="tns:LargePayloadType"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="submitResponse">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element maxOccurs="unbounded" minOccurs="0" name="messageID" nillable="true" type="xsd:string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:complexType name="PayloadType">
        <xsd:simpleContent>
          <xsd:extension base="ns1:base64Binary">
            <xsd:attribute name="payloadId" type="xsd:token" use="required"/>
          </xsd:extension>
        </xsd:simpleContent>
      </xsd:complexType>
      <xsd:complexType name="LargePayloadType">
        <xsd:sequence>
          <xsd:element name="value" ns1:expectedContentTypes="application/octet-stream" type="xsd:base64Binary"/>
        </xsd:sequence>
        <xsd:attribute name="payloadId" type="xsd:token"/>
        <xsd:attribute name="contentType" type="xsd:string"/>
      </xsd:complexType>
      <xsd:complexType name="errorResultImpl">
        <xsd:sequence>
          <xsd:element minOccurs="0" name="domibusErrorCode" type="tns:domibusErrorCode"/>
          <xsd:element minOccurs="0" name="errorDetail" type="xsd:string"/>
          <xsd:element minOccurs="0" name="messageInErrorId" type="xsd:string"/>
          <xsd:element minOccurs="0" name="mshRole" type="tns:mshRole"/>
          <xsd:element minOccurs="0" name="notified" type="xsd:dateTime"/>
          <xsd:element minOccurs="0" name="timestamp" type="xsd:dateTime"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="PayloadURLType">
        <xsd:simpleContent>
          <xsd:extension base="xsd:string">
            <xsd:attribute name="payloadId" type="xsd:token" use="required"/>
          </xsd:extension>
        </xsd:simpleContent>
      </xsd:complexType>
      <xsd:simpleType name="messageStatus">
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="READY_TO_SEND"/>
          <xsd:enumeration value="READY_TO_PULL"/>
          <xsd:enumeration value="BEING_PULLED"/>
          <xsd:enumeration value="SEND_ENQUEUED"/>
          <xsd:enumeration value="SEND_IN_PROGRESS"/>
          <xsd:enumeration value="WAITING_FOR_RECEIPT"/>
          <xsd:enumeration value="ACKNOWLEDGED"/>
          <xsd:enumeration value="ACKNOWLEDGED_WITH_WARNING"/>
          <xsd:enumeration value="SEND_ATTEMPT_FAILED"/>
          <xsd:enumeration value="SEND_FAILURE"/>
          <xsd:enumeration value="NOT_FOUND"/>
          <xsd:enumeration value="WAITING_FOR_RETRY"/>
          <xsd:enumeration value="RECEIVED"/>
          <xsd:enumeration value="RECEIVED_WITH_WARNINGS"/>
          <xsd:enumeration value="DELETED"/>
          <xsd:enumeration value="DOWNLOADED"/>
        </xsd:restriction>
      </xsd:simpleType>
      <xsd:simpleType name="domibusErrorCode">
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="EBMS_0001"/>
          <xsd:enumeration value="EBMS_0002"/>
          <xsd:enumeration value="EBMS_0003"/>
          <xsd:enumeration value="EBMS_0004"/>
          <xsd:enumeration value="EBMS_0005"/>
          <xsd:enumeration value="EBMS_0006"/>
          <xsd:enumeration value="EBMS_0007"/>
          <xsd:enumeration value="EBMS_0008"/>
          <xsd:enumeration value="EBMS_0009"/>
          <xsd:enumeration value="EBMS_0010"/>
          <xsd:enumeration value="EBMS_0011"/>
          <xsd:enumeration value="EBMS_0101"/>
          <xsd:enumeration value="EBMS_0102"/>
          <xsd:enumeration value="EBMS_0103"/>
          <xsd:enumeration value="EBMS_0201"/>
          <xsd:enumeration value="EBMS_0202"/>
          <xsd:enumeration value="EBMS_0301"/>
          <xsd:enumeration value="EBMS_0302"/>
          <xsd:enumeration value="EBMS_0303"/>
          <xsd:enumeration value="EBMS_0020"/>
          <xsd:enumeration value="EBMS_0021"/>
          <xsd:enumeration value="EBMS_0022"/>
          <xsd:enumeration value="EBMS_0023"/>
          <xsd:enumeration value="EBMS_0030"/>
          <xsd:enumeration value="EBMS_0031"/>
          <xsd:enumeration value="EBMS_0040"/>
          <xsd:enumeration value="EBMS_0041"/>
          <xsd:enumeration value="EBMS_0042"/>
          <xsd:enumeration value="EBMS_0043"/>
          <xsd:enumeration value="EBMS_0044"/>
          <xsd:enumeration value="EBMS_0045"/>
          <xsd:enumeration value="EBMS_0046"/>
          <xsd:enumeration value="EBMS_0047"/>
          <xsd:enumeration value="EBMS_0048"/>
          <xsd:enumeration value="EBMS_0049"/>
          <xsd:enumeration value="EBMS_0050"/>
          <xsd:enumeration value="EBMS_0051"/>
          <xsd:enumeration value="EBMS_0052"/>
          <xsd:enumeration value="EBMS_0053"/>
          <xsd:enumeration value="EBMS_0054"/>
          <xsd:enumeration value="EBMS_0055"/>
          <xsd:enumeration value="EBMS_0060"/>
          <xsd:enumeration value="EBMS_0065"/>
        </xsd:restriction>
      </xsd:simpleType>
      <xsd:simpleType name="errorCode">
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="WS_PLUGIN:0001"/>
          <xsd:enumeration value="WS_PLUGIN:0002"/>
          <xsd:enumeration value="WS_PLUGIN:0003"/>
          <xsd:enumeration value="WS_PLUGIN:0004"/>
          <xsd:enumeration value="WS_PLUGIN:0005"/>
          <xsd:enumeration value="WS_PLUGIN:0006"/>
          <xsd:enumeration value="WS_PLUGIN:0007"/>
          <xsd:enumeration value="WS_PLUGIN:0008"/>
          <xsd:enumeration value="WS_PLUGIN:0009"/>
        </xsd:restriction>
      </xsd:simpleType>
      <xsd:simpleType name="mshRole">
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="SENDING"/>
          <xsd:enumeration value="RECEIVING"/>
        </xsd:restriction>
      </xsd:simpleType>
      <xsd:complexType final="#all" name="errorResultImplArray">
        <xsd:sequence>
          <xsd:element maxOccurs="unbounded" minOccurs="0" name="item" nillable="true" type="tns:errorResultImpl"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:element name="getStatusRequest" nillable="true">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="statusRequest" nillable="true">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="getStatusResponse" nillable="true" type="tns:messageStatus"/>
      <xsd:element name="getErrorsRequest" nillable="true">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="getMessageErrorsResponse" nillable="true" type="tns:errorResultImplArray"/>
    </xsd:schema>
    <xsd:schema attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:tns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/">
      <xsd:import namespace="http://www.w3.org/XML/1998/namespace"/>
      <xsd:annotation>
        <xsd:appinfo>Schema for Domibus messages' headers submission</xsd:appinfo>
        <xsd:documentation xml:lang="en">This schema defines an XML subset of ebMS-3 headers which is used to validate messages submitted to Domibus
            through WS plugin.</xsd:documentation>
      </xsd:annotation>
      <xsd:element name="Messaging" type="Messaging"/>
      <xsd:complexType name="Messaging">
        <xsd:sequence>
          <xsd:element minOccurs="0" name="UserMessage" type="UserMessage"/>
        </xsd:sequence>
        <xsd:attribute name="mustUnderstand" type="xsd:boolean" use="optional"/>
      </xsd:complexType>
      <xsd:simpleType name="ProcessingType">
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="PUSH"/>
          <xsd:enumeration value="PULL"/>
          <xsd:minLength value="0"/>
        </xsd:restriction>
      </xsd:simpleType>
      <xsd:complexType name="UserMessage">
        <xsd:all>
          <xsd:element minOccurs="0" name="MessageInfo" type="MessageInfo"/>
          <xsd:element name="PartyInfo" type="PartyInfo"/>
          <xsd:element name="CollaborationInfo" type="CollaborationInfo"/>
          <xsd:element minOccurs="0" name="MessageProperties" type="tns:MessageProperties"/>
          <xsd:element minOccurs="0" name="PayloadInfo" type="tns:PayloadInfo"/>
          <xsd:element default="PUSH" minOccurs="0" name="ProcessingType" type="ProcessingType"/>
        </xsd:all>
        <xsd:attribute name="mpc" type="xsd:anyURI" use="optional"/>
      </xsd:complexType>
      <xsd:complexType name="MessageInfo">
        <xsd:all>
          <xsd:element minOccurs="0" name="Timestamp" type="xsd:dateTime"/>
          <xsd:element minOccurs="0" name="MessageId" type="tns:max255-non-empty-string"/>
          <xsd:element minOccurs="0" name="RefToMessageId" type="tns:max255-non-empty-string"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="PartyInfo">
        <xsd:all>
          <xsd:element name="From" type="tns:From"/>
          <xsd:element minOccurs="0" name="To" type="tns:To"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="PartyId">
        <xsd:simpleContent>
          <xsd:extension base="tns:max255-non-empty-string">
            <xsd:attribute name="type" type="tns:max255-non-empty-string"/>
          </xsd:extension>
        </xsd:simpleContent>
      </xsd:complexType>
      <xsd:complexType name="From">
        <xsd:all>
          <xsd:element name="PartyId" type="tns:PartyId"/>
          <xsd:element name="Role" type="tns:max255-non-empty-string"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="To">
        <xsd:all>
          <xsd:element name="PartyId" type="tns:PartyId"/>
          <xsd:element name="Role" type="tns:max255-non-empty-string"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="CollaborationInfo">
        <xsd:all>
          <xsd:element minOccurs="0" name="AgreementRef" type="tns:AgreementRef"/>
          <xsd:element name="Service" type="tns:Service"/>
          <xsd:element name="Action" type="xsd:token"/>
          <xsd:element minOccurs="0" name="ConversationId" type="xsd:token"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="Service">
        <xsd:simpleContent>
          <xsd:extension base="tns:max255-non-empty-string">
            <xsd:attribute name="type" type="tns:max255-non-empty-string" use="optional"/>
          </xsd:extension>
        </xsd:simpleContent>
      </xsd:complexType>
      <xsd:complexType name="AgreementRef">
        <xsd:simpleContent>
          <xsd:extension base="tns:max255-non-empty-string">
            <xsd:attribute name="type" type="tns:max255-non-empty-string" use="optional"/>
            <xsd:attribute name="pmode" type="tns:max255-non-empty-string" use="optional"/>
          </xsd:extension>
        </xsd:simpleContent>
      </xsd:complexType>
      <xsd:complexType name="PayloadInfo">
        <xsd:sequence>
          <xsd:element maxOccurs="unbounded" name="PartInfo" type="tns:PartInfo"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="PartInfo">
        <xsd:all>
          <xsd:element minOccurs="0" name="PartProperties" type="tns:PartProperties"/>
        </xsd:all>
        <xsd:attribute name="href" type="xsd:token"/>
      </xsd:complexType>
      <xsd:complexType name="Property">
        <xsd:simpleContent>
          <xsd:extension base="tns:max1024-non-empty-string">
            <xsd:attribute name="name" type="tns:max255-non-empty-string" use="required"/>
            <xsd:attribute name="type" type="tns:max255-non-empty-string" use="optional"/>
          </xsd:extension>
        </xsd:simpleContent>
      </xsd:complexType>
      <xsd:complexType name="PartProperties">
        <xsd:sequence>
          <xsd:element maxOccurs="unbounded" name="Property" type="tns:Property"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="MessageProperties">
        <xsd:sequence>
          <xsd:element maxOccurs="unbounded" name="Property" type="Property"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:simpleType name="max255-non-empty-string">
        <xsd:restriction base="xsd:string">
          <xsd:minLength value="1"/>
          <xsd:maxLength value="255"/>
        </xsd:restriction>
      </xsd:simpleType>
      <xsd:simpleType name="max1024-non-empty-string">
        <xsd:restriction base="xsd:string">
          <xsd:minLength value="1"/>
          <xsd:maxLength value="1024"/>
        </xsd:restriction>
      </xsd:simpleType>
    </xsd:schema>
    <xs:schema targetNamespace="http://www.w3.org/XML/1998/namespace" xml:lang="en" xmlns:xs="http://www.w3.org/2001/XMLSchema">
      <xs:annotation>
        <xs:documentation>See http://www.w3.org/XML/1998/namespace.html and
   http://www.w3.org/TR/REC-xml for information about this namespace.

    This schema document describes the XML namespace, in a form
    suitable for import by other schema documents.  

    Note that local names in this namespace are intended to be defined
    only by the World Wide Web Consortium or its subgroups.  The
    following names are currently defined in this namespace and should
    not be used with conflicting semantics by any Working Group,
    specification, or document instance:

    base (as an attribute name): denotes an attribute whose value
         provides a URI to be used as the base for interpreting any
         relative URIs in the scope of the element on which it
         appears; its value is inherited.  This name is reserved
         by virtue of its definition in the XML Base specification.

    id   (as an attribute name): denotes an attribute whose value
         should be interpreted as if declared to be of type ID.
         The xml:id specification is not yet a W3C Recommendation,
         but this attribute is included here to facilitate experimentation
         with the mechanisms it proposes.  Note that it is _not_ included
         in the specialAttrs attribute group.

    lang (as an attribute name): denotes an attribute whose value
         is a language code for the natural language of the content of
         any element; its value is inherited.  This name is reserved
         by virtue of its definition in the XML specification.
  
    space (as an attribute name): denotes an attribute whose
         value is a keyword indicating what whitespace processing
         discipline is intended for the content of the element; its
         value is inherited.  This name is reserved by virtue of its
         definition in the XML specification.

    Father (in any context at all): denotes Jon Bosak, the chair of 
         the original XML Working Group.  This name is reserved by 
         the following decision of the W3C XML Plenary and 
         XML Coordination groups:

             In appreciation for his vision, leadership and dedication
             the W3C XML Plenary on this 10th day of February, 2000
             reserves for Jon Bosak in perpetuity the XML name
             xml:Father</xs:documentation>
      </xs:annotation>
      <xs:annotation>
        <xs:documentation>This schema defines attributes and an attribute group
        suitable for use by
        schemas wishing to allow xml:base, xml:lang, xml:space or xml:id
        attributes on elements they define.

        To enable this, such a schema must import this schema
        for the XML namespace, e.g. as follows:
        &lt;schema . . .>
         . . .
         &lt;import namespace="http://www.w3.org/XML/1998/namespace"
                    schemaLocation="http://www.w3.org/2001/xml.xsd"/>

        Subsequently, qualified reference to any of the attributes
        or the group defined below will have the desired effect, e.g.

        &lt;type . . .>
         . . .
         &lt;attributeGroup ref="xml:specialAttrs"/>
 
         will define a type which will schema-validate an instance
         element with any of those attributes</xs:documentation>
      </xs:annotation>
      <xs:annotation>
        <xs:documentation>In keeping with the XML Schema WG's standard versioning
   policy, this schema document will persist at
   http://www.w3.org/2005/08/xml.xsd.
   At the date of issue it can also be found at
   http://www.w3.org/2001/xml.xsd.
   The schema document at that URI may however change in the future,
   in order to remain compatible with the latest version of XML Schema
   itself, or with the XML namespace itself.  In other words, if the XML
   Schema or XML namespaces change, the version of this document at
   http://www.w3.org/2001/xml.xsd will change
   accordingly; the version at
   http://www.w3.org/2005/08/xml.xsd will not change.</xs:documentation>
      </xs:annotation>
      <xs:attribute name="lang">
        <xs:annotation>
          <xs:documentation>Attempting to install the relevant ISO 2- and 3-letter
         codes as the enumerated possible values is probably never
         going to be a realistic possibility.  See
         RFC 3066 at http://www.ietf.org/rfc/rfc3066.txt and the IANA registry
         at http://www.iana.org/assignments/lang-tag-apps.htm for
         further information.

         The union allows for the 'un-declaration' of xml:lang with
         the empty string.</xs:documentation>
        </xs:annotation>
        <xs:simpleType>
          <xs:union memberTypes="xs:language">
            <xs:simpleType>
              <xs:restriction base="xs:string">
                <xs:enumeration value=""/>
              </xs:restriction>
            </xs:simpleType>
          </xs:union>
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute name="space">
        <xs:simpleType>
          <xs:restriction base="xs:NCName">
            <xs:enumeration value="default"/>
            <xs:enumeration value="preserve"/>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute name="base" type="xs:anyURI">
        <xs:annotation>
          <xs:documentation>See http://www.w3.org/TR/xmlbase/ for
                     information about this attribute.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute name="id" type="xs:ID">
        <xs:annotation>
          <xs:documentation>See http://www.w3.org/TR/xml-id/ for
                     information about this attribute.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attributeGroup name="specialAttrs">
        <xs:attribute ref="xml:base"/>
        <xs:attribute ref="xml:lang"/>
        <xs:attribute ref="xml:space"/>
      </xs:attributeGroup>
    </xs:schema>
    <xs:schema targetNamespace="http://www.w3.org/2005/05/xmlmime" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xmime="http://www.w3.org/2005/05/xmlmime">
      <xs:attribute name="contentType">
        <xs:simpleType>
          <xs:restriction base="xs:string">
            <xs:minLength value="3"/>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute name="expectedContentTypes" type="xs:string"/>
      <xs:complexType name="base64Binary">
        <xs:simpleContent>
          <xs:extension base="xs:base64Binary">
            <xs:attribute ref="xmime:contentType"/>
          </xs:extension>
        </xs:simpleContent>
      </xs:complexType>
      <xs:complexType name="hexBinary">
        <xs:simpleContent>
          <xs:extension base="xs:hexBinary">
            <xs:attribute ref="xmime:contentType"/>
          </xs:extension>
        </xs:simpleContent>
      </xs:complexType>
    </xs:schema>
  </wsdl:types>
  <wsdl:message name="submitMessage">
    <wsdl:part element="tns:submitRequest" name="submitRequest"></wsdl:part>
    <wsdl:part element="ns1:Messaging" name="ebMSHeaderInfo"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="rePushFailedMessagesResponse"></wsdl:message>
  <wsdl:message name="retrieveMessage">
    <wsdl:part element="tns:retrieveMessageRequest" name="retrieveMessageRequest"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="SubmitMessageFault">
    <wsdl:part element="tns:FaultDetail" name="SubmitMessageFault"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="listPendingMessages">
    <wsdl:part element="tns:listPendingMessagesRequest" name="listPendingMessagesRequest"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="MarkMessageAsDownloadedFault">
    <wsdl:part element="tns:FaultDetail" name="MarkMessageAsDownloadedFault"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="ListPushFailedMessagesFault">
    <wsdl:part element="tns:FaultDetail" name="ListPushFailedMessagesFault"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="listPushFailedMessagesResponse">
    <wsdl:part element="tns:listPushFailedMessagesResponse" name="listPushFailedMessagesResponse"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="StatusFault">
    <wsdl:part element="tns:FaultDetail" name="StatusFault"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="retrieveMessageResponse">
    <wsdl:part element="tns:retrieveMessageResponse" name="retrieveMessageResponse"></wsdl:part>
    <wsdl:part element="ns1:Messaging" name="ebMSHeaderInfo"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="listPushFailedMessages">
    <wsdl:part element="tns:listPushFailedMessagesRequest" name="listPushFailedMessagesRequest"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="ListPendingMessagesFault">
    <wsdl:part element="tns:FaultDetail" name="ListPendingMessagesFault"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="RePushFailedMessagesFault">
    <wsdl:part element="tns:FaultDetail" name="RePushFailedMessagesFault"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="submitMessageResponse">
    <wsdl:part element="tns:submitResponse" name="submitResponse"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="markMessageAsDownloaded">
    <wsdl:part element="tns:markMessageAsDownloadedRequest" name="markMessageAsDownloadedRequest"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getStatusResponse">
    <wsdl:part element="tns:getStatusResponse" name="getStatusResponse"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="listPendingMessagesResponse">
    <wsdl:part element="tns:listPendingMessagesResponse" name="listPendingMessagesResponse"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="rePushFailedMessages">
    <wsdl:part element="tns:rePushFailedMessagesRequest" name="rePushFailedMessagesRequest"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getMessageErrorsResponse">
    <wsdl:part element="tns:getMessageErrorsResponse" name="getMessageErrorsResponse"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="RetrieveMessageFault">
    <wsdl:part element="tns:FaultDetail" name="RetrieveMessageFault"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getMessageErrors">
    <wsdl:part element="tns:getErrorsRequest" name="getErrorsRequest"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getStatus">
    <wsdl:part element="tns:statusRequest" name="statusRequest"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="GetMessageErrorsFault">
    <wsdl:part element="tns:FaultDetail" name="GetMessageErrorsFault"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="markMessageAsDownloadedResponse">
    <wsdl:part element="tns:markMessageAsDownloadedResponse" name="markMessageAsDownloadedResponse"></wsdl:part>
    <wsdl:part element="ns1:Messaging" name="ebMSHeaderInfo"></wsdl:part>
  </wsdl:message>
  <wsdl:portType name="WebServicePluginInterface">
    <wsdl:operation name="submitMessage">
      <wsdl:input message="tns:submitMessage" name="submitMessage"></wsdl:input>
      <wsdl:output message="tns:submitMessageResponse" name="submitMessageResponse"></wsdl:output>
      <wsdl:fault message="tns:SubmitMessageFault" name="SubmitMessageFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="retrieveMessage" parameterOrder="retrieveMessageRequest retrieveMessageResponse ebMSHeaderInfo">
      <wsdl:input message="tns:retrieveMessage" name="retrieveMessage"></wsdl:input>
      <wsdl:output message="tns:retrieveMessageResponse" name="retrieveMessageResponse"></wsdl:output>
      <wsdl:fault message="tns:RetrieveMessageFault" name="RetrieveMessageFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="listPendingMessages">
      <wsdl:input message="tns:listPendingMessages" name="listPendingMessages"></wsdl:input>
      <wsdl:output message="tns:listPendingMessagesResponse" name="listPendingMessagesResponse"></wsdl:output>
      <wsdl:fault message="tns:ListPendingMessagesFault" name="ListPendingMessagesFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="markMessageAsDownloaded" parameterOrder="markMessageAsDownloadedRequest markMessageAsDownloadedResponse ebMSHeaderInfo">
      <wsdl:input message="tns:markMessageAsDownloaded" name="markMessageAsDownloaded"></wsdl:input>
      <wsdl:output message="tns:markMessageAsDownloadedResponse" name="markMessageAsDownloadedResponse"></wsdl:output>
      <wsdl:fault message="tns:MarkMessageAsDownloadedFault" name="MarkMessageAsDownloadedFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="rePushFailedMessages">
      <wsdl:input message="tns:rePushFailedMessages" name="rePushFailedMessages"></wsdl:input>
      <wsdl:output message="tns:rePushFailedMessagesResponse" name="rePushFailedMessagesResponse"></wsdl:output>
      <wsdl:fault message="tns:RePushFailedMessagesFault" name="RePushFailedMessagesFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getMessageErrors">
      <wsdl:input message="tns:getMessageErrors" name="getMessageErrors"></wsdl:input>
      <wsdl:output message="tns:getMessageErrorsResponse" name="getMessageErrorsResponse"></wsdl:output>
      <wsdl:fault message="tns:GetMessageErrorsFault" name="GetMessageErrorsFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getStatus">
      <wsdl:input message="tns:getStatus" name="getStatus"></wsdl:input>
      <wsdl:output message="tns:getStatusResponse" name="getStatusResponse"></wsdl:output>
      <wsdl:fault message="tns:StatusFault" name="StatusFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="listPushFailedMessages">
      <wsdl:input message="tns:listPushFailedMessages" name="listPushFailedMessages"></wsdl:input>
      <wsdl:output message="tns:listPushFailedMessagesResponse" name="listPushFailedMessagesResponse"></wsdl:output>
      <wsdl:fault message="tns:ListPushFailedMessagesFault" name="ListPushFailedMessagesFault"></wsdl:fault>
    </wsdl:operation>
  </wsdl:portType>
  <wsdl:binding name="WebServicePluginSoapBinding" type="tns:WebServicePluginInterface">
    <soap12:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
    <wsdl:operation name="submitMessage">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="submitMessage">
        <soap12:header message="tns:submitMessage" part="ebMSHeaderInfo" use="literal"></soap12:header>
        <soap12:body parts="submitRequest" use="literal"/>
      </wsdl:input>
      <wsdl:output name="submitMessageResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="SubmitMessageFault">
        <soap12:fault name="SubmitMessageFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="retrieveMessage">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="retrieveMessage">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="retrieveMessageResponse">
        <soap12:header message="tns:retrieveMessageResponse" part="ebMSHeaderInfo" use="literal"></soap12:header>
        <soap12:body parts="retrieveMessageResponse" use="literal"/>
      </wsdl:output>
      <wsdl:fault name="RetrieveMessageFault">
        <soap12:fault name="RetrieveMessageFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="listPendingMessages">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="listPendingMessages">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="listPendingMessagesResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="ListPendingMessagesFault">
        <soap12:fault name="ListPendingMessagesFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="markMessageAsDownloaded">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="markMessageAsDownloaded">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="markMessageAsDownloadedResponse">
        <soap12:header message="tns:markMessageAsDownloadedResponse" part="ebMSHeaderInfo" use="literal"></soap12:header>
        <soap12:body parts="markMessageAsDownloadedResponse" use="literal"/>
      </wsdl:output>
      <wsdl:fault name="MarkMessageAsDownloadedFault">
        <soap12:fault name="MarkMessageAsDownloadedFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="rePushFailedMessages">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="rePushFailedMessages">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="rePushFailedMessagesResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="RePushFailedMessagesFault">
        <soap12:fault name="RePushFailedMessagesFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getMessageErrors">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="getMessageErrors">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getMessageErrorsResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="GetMessageErrorsFault">
        <soap12:fault name="GetMessageErrorsFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getStatus">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="getStatus">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getStatusResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="StatusFault">
        <soap12:fault name="StatusFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="listPushFailedMessages">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="listPushFailedMessages">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="listPushFailedMessagesResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="ListPushFailedMessagesFault">
        <soap12:fault name="ListPushFailedMessagesFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
  </wsdl:binding>
  <wsdl:service name="WebServicePlugin">
    <wsdl:port binding="tns:WebServicePluginSoapBinding" name="WEBSERVICEPLUGIN_PORT">
      <soap12:address location="http://localhost:8080/domibus/services/wsplugin"/>
    </wsdl:port>
  </wsdl:service>
</wsdl:definitions>]]></con:content><con:type>http://schemas.xmlsoap.org/wsdl/</con:type></con:part></con:definitionCache><con:endpoints><con:endpoint>http://localhost:8080/domibus/services/wsplugin</con:endpoint></con:endpoints><con:operation id="04a3edb2-b6f7-480f-bf28-4d70444081f9" isOneWay="false" action="" name="getMessageErrors" bindingOperationName="getMessageErrors" type="Request-Response" outputName="getMessageErrorsResponse" inputName="getMessageErrors" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="2097c367-da55-4d0f-8954-792d0fa0d1be" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/domibus/services/wsplugin</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:eu="http://eu.domibus.wsplugin/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <eu:getErrorsRequest>\r
         <messageID>?</messageID>\r
      </eu:getErrorsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://eu.domibus.wsplugin/WebServicePluginInterface/getMessageErrors"/></con:call></con:operation><con:operation id="f6e1ecd9-6b9c-49bf-9b55-2594a803376f" isOneWay="false" action="" name="getStatus" bindingOperationName="getStatus" type="Request-Response" outputName="getStatusResponse" inputName="getStatus" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="4c70fe60-104c-4592-b3dc-623b235dbb90" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/domibus/services/wsplugin</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:eu="http://eu.domibus.wsplugin/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <eu:statusRequest>\r
         <messageID>?</messageID>\r
      </eu:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://eu.domibus.wsplugin/WebServicePluginInterface/getStatus"/></con:call></con:operation><con:operation id="f1daae61-52cf-4c73-bef1-f329a8a1d738" isOneWay="false" action="" name="listPendingMessages" bindingOperationName="listPendingMessages" type="Request-Response" outputName="listPendingMessagesResponse" inputName="listPendingMessages" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="036e7adc-c868-4f41-b675-61aeb4baaab2" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/domibus/services/wsplugin</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:eu="http://eu.domibus.wsplugin/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <eu:listPendingMessagesRequest>\r
         <!--Optional:-->\r
         <messageId>?</messageId>\r
         <!--Optional:-->\r
         <conversationId>?</conversationId>\r
         <!--Optional:-->\r
         <refToMessageId>?</refToMessageId>\r
         <!--Optional:-->\r
         <fromPartyId>?</fromPartyId>\r
         <!--Optional:-->\r
         <finalRecipient>?</finalRecipient>\r
         <!--Optional:-->\r
         <originalSender>?</originalSender>\r
         <!--Optional:-->\r
         <receivedFrom>?</receivedFrom>\r
         <!--Optional:-->\r
         <receivedTo>?</receivedTo>\r
      </eu:listPendingMessagesRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://eu.domibus.wsplugin/WebServicePluginInterface/listPendingMessages"/></con:call></con:operation><con:operation id="b8456f24-813f-458a-88e4-8e2618f5b8d1" isOneWay="false" action="" name="listPushFailedMessages" bindingOperationName="listPushFailedMessages" type="Request-Response" outputName="listPushFailedMessagesResponse" inputName="listPushFailedMessages" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="e797a24e-376b-431a-b057-b40e6b8f6b5a" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/domibus/services/wsplugin</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:eu="http://eu.domibus.wsplugin/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <eu:listPushFailedMessagesRequest>\r
         <!--Optional:-->\r
         <messageId>?</messageId>\r
         <!--Optional:-->\r
         <finalRecipient>?</finalRecipient>\r
         <!--Optional:-->\r
         <originalSender>?</originalSender>\r
         <!--Optional:-->\r
         <receivedFrom>?</receivedFrom>\r
         <!--Optional:-->\r
         <receivedTo>?</receivedTo>\r
      </eu:listPushFailedMessagesRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://eu.domibus.wsplugin/WebServicePluginInterface/listPushFailedMessages"/></con:call></con:operation><con:operation id="87343fcb-7a8b-4e7a-bd58-d2b0b81ece55" isOneWay="false" action="" name="markMessageAsDownloaded" bindingOperationName="markMessageAsDownloaded" type="Request-Response" outputName="markMessageAsDownloadedResponse" inputName="markMessageAsDownloaded" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="8c11ecef-6a0d-406a-9709-69e39060b9ca" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/domibus/services/wsplugin</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:eu="http://eu.domibus.wsplugin/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <eu:markMessageAsDownloadedRequest>\r
         <messageID>?</messageID>\r
      </eu:markMessageAsDownloadedRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://eu.domibus.wsplugin/WebServicePluginInterface/markMessageAsDownloaded"/></con:call></con:operation><con:operation id="81623c9c-5f8e-47f9-9290-ea269fbc2236" isOneWay="false" action="" name="rePushFailedMessages" bindingOperationName="rePushFailedMessages" type="Request-Response" outputName="rePushFailedMessagesResponse" inputName="rePushFailedMessages" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="ec636a9a-d585-4d83-9e0e-dd9fa89a79a4" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/domibus/services/wsplugin</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:eu="http://eu.domibus.wsplugin/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <eu:rePushFailedMessagesRequest>\r
         <!--Zero or more repetitions:-->\r
         <messageID>?</messageID>\r
      </eu:rePushFailedMessagesRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://eu.domibus.wsplugin/WebServicePluginInterface/rePushFailedMessages"/></con:call></con:operation><con:operation id="57ee4e19-8592-4282-946d-dcbcf9157c56" isOneWay="false" action="" name="retrieveMessage" bindingOperationName="retrieveMessage" type="Request-Response" outputName="retrieveMessageResponse" inputName="retrieveMessage" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="123dc288-f73b-4c3c-9d46-75d1f5347f02" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/domibus/services/wsplugin</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:eu="http://eu.domibus.wsplugin/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <eu:retrieveMessageRequest markAsDownloaded="true">\r
         <messageID>?</messageID>\r
      </eu:retrieveMessageRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://eu.domibus.wsplugin/WebServicePluginInterface/retrieveMessage"/></con:call></con:operation><con:operation id="3047d6b6-b461-4f48-a0dd-48390fa83360" isOneWay="false" action="" name="submitMessage" bindingOperationName="submitMessage" type="Request-Response" outputName="submitMessageResponse" inputName="submitMessage" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="e3c411f9-f845-4ee7-81eb-18dde3ccf0f4" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/domibus/services/wsplugin</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:eu="http://eu.domibus.wsplugin/">\r
   <soap:Header>\r
      <ns:Messaging mustUnderstand="?">\r
         <!--Optional:-->\r
         <ns:UserMessage mpc="?">\r
            <!--You may enter the following 6 items in any order-->\r
            <!--Optional:-->\r
            <ns:MessageInfo>\r
               <!--You may enter the following 3 items in any order-->\r
               <!--Optional:-->\r
               <ns:Timestamp>?</ns:Timestamp>\r
               <!--Optional:-->\r
               <ns:MessageId>?</ns:MessageId>\r
               <!--Optional:-->\r
               <ns:RefToMessageId>?</ns:RefToMessageId>\r
            </ns:MessageInfo>\r
            <ns:PartyInfo>\r
               <!--You may enter the following 2 items in any order-->\r
               <ns:From>\r
                  <!--You may enter the following 2 items in any order-->\r
                  <ns:PartyId type="?">?</ns:PartyId>\r
                  <ns:Role>?</ns:Role>\r
               </ns:From>\r
               <!--Optional:-->\r
               <ns:To>\r
                  <!--You may enter the following 2 items in any order-->\r
                  <ns:PartyId type="?">?</ns:PartyId>\r
                  <ns:Role>?</ns:Role>\r
               </ns:To>\r
            </ns:PartyInfo>\r
            <ns:CollaborationInfo>\r
               <!--You may enter the following 4 items in any order-->\r
               <!--Optional:-->\r
               <ns:AgreementRef type="?" pmode="?">?</ns:AgreementRef>\r
               <ns:Service type="?">?</ns:Service>\r
               <ns:Action>?</ns:Action>\r
               <!--Optional:-->\r
               <ns:ConversationId>?</ns:ConversationId>\r
            </ns:CollaborationInfo>\r
            <!--Optional:-->\r
            <ns:MessageProperties>\r
               <!--1 or more repetitions:-->\r
               <ns:Property name="?" type="?">?</ns:Property>\r
            </ns:MessageProperties>\r
            <!--Optional:-->\r
            <ns:PayloadInfo>\r
               <!--1 or more repetitions:-->\r
               <ns:PartInfo href="?">\r
                  <!--Optional:-->\r
                  <ns:PartProperties>\r
                     <!--1 or more repetitions:-->\r
                     <ns:Property name="?" type="?">?</ns:Property>\r
                  </ns:PartProperties>\r
               </ns:PartInfo>\r
            </ns:PayloadInfo>\r
            <!--Optional:-->\r
            <ns:ProcessingType>PUSH</ns:ProcessingType>\r
         </ns:UserMessage>\r
      </ns:Messaging>\r
   </soap:Header>\r
   <soap:Body>\r
      <eu:submitRequest>\r
         <!--Optional:-->\r
         <bodyload payloadId="?" contentType="?">\r
            <value>cid:910775930871</value>\r
         </bodyload>\r
         <!--Zero or more repetitions:-->\r
         <payload payloadId="?" contentType="?">\r
            <value>cid:706009338319</value>\r
         </payload>\r
      </eu:submitRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://eu.domibus.wsplugin/WebServicePluginInterface/submitMessage"/></con:call></con:operation></con:interface><con:interface xsi:type="con:WsdlInterface" id="9e3f50dc-a102-4731-98d4-f04757de4d3a" wsaVersion="NONE" name="BackendServiceSoapBinding" type="wsdl" bindingName="{eu.domibus}BackendServiceSoapBinding" soapVersion="1_2" anonymous="optional" definition="file:/C:/work/digit/tools/domibus/5.1RC2/domibus-msh-distribution-5.1-20221004.095246-108-default-ws-plugin/conf/domibus/plugins/backend/BackendService.wsdl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart="file:/C:/work/digit/tools/domibus/5.1RC2/domibus-msh-distribution-5.1-20221004.095246-108-default-ws-plugin/conf/domibus/plugins/backend/BackendService.wsdl"><con:part><con:url>file:/C:/work/digit/tools/domibus/5.1RC2/domibus-msh-distribution-5.1-20221004.095246-108-default-ws-plugin/conf/domibus/plugins/backend/BackendService.wsdl</con:url><con:content><![CDATA[<wsdl:definitions name="backendService" targetNamespace="eu.domibus" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" xmlns:tns="eu.domibus">
  <wsdl:types>
    <schema xmlns="http://www.w3.org/2001/XMLSchema">
      <import namespace="eu.domibus" schemaLocation="BackendService.xsd"/>
    </schema>
  </wsdl:types>
  <wsdl:message name="submitMessage">
    <wsdl:part element="tns:submitRequest" name="submitRequest"/>
    <wsdl:part element="tns:Messaging" name="headerInfo"/>
  </wsdl:message>
  <wsdl:message name="submitMessageResponse"/>
  <wsdl:message name="submitMessageFault">
    <wsdl:part element="tns:BackendFaultDetail" name="submitMessageFault"/>
  </wsdl:message>
  <wsdl:message name="sendSuccess">
    <wsdl:part element="tns:sendSuccess" name="sendSuccess"/>
  </wsdl:message>
  <wsdl:message name="sendSuccessResponse"/>
  <wsdl:message name="sendSuccessFault">
    <wsdl:part element="tns:BackendFaultDetail" name="sendSuccessFault"/>
  </wsdl:message>
  <wsdl:message name="sendFailure">
    <wsdl:part element="tns:sendFailure" name="sendFailure"/>
  </wsdl:message>
  <wsdl:message name="sendFailureResponse"/>
  <wsdl:message name="sendFailureFault">
    <wsdl:part element="tns:BackendFaultDetail" name="sendFailureFault"/>
  </wsdl:message>
  <wsdl:message name="receiveSuccess">
    <wsdl:part element="tns:receiveSuccess" name="receiveSuccess"/>
  </wsdl:message>
  <wsdl:message name="receiveSuccessResponse"/>
  <wsdl:message name="receiveSuccessFault">
    <wsdl:part element="tns:BackendFaultDetail" name="receiveSuccessFault"/>
  </wsdl:message>
  <wsdl:message name="receiveFailure">
    <wsdl:part element="tns:receiveFailure" name="receiveFailure"/>
  </wsdl:message>
  <wsdl:message name="receiveFailureResponse"/>
  <wsdl:message name="receiveFailureFault">
    <wsdl:part element="tns:BackendFaultDetail" name="receiveFailureFault"/>
  </wsdl:message>
  <wsdl:message name="delete">
    <wsdl:part element="tns:delete" name="delete"/>
  </wsdl:message>
  <wsdl:message name="deleteResponse"/>
  <wsdl:message name="deleteFault">
    <wsdl:part element="tns:BackendFaultDetail" name="deleteFault"/>
  </wsdl:message>
  <wsdl:message name="deleteBatch">
    <wsdl:part element="tns:deleteBatch" name="deleteBatch"/>
  </wsdl:message>
  <wsdl:message name="deleteBatchResponse"/>
  <wsdl:message name="deleteBatchFault">
    <wsdl:part element="tns:BackendFaultDetail" name="deleteBatchFault"/>
  </wsdl:message>
  <wsdl:message name="messageStatusChange">
    <wsdl:part element="tns:messageStatusChange" name="messageStatusChange"/>
  </wsdl:message>
  <wsdl:message name="messageStatusChangeResponse"/>
  <wsdl:message name="messageStatusChangeFault">
    <wsdl:part element="tns:BackendFaultDetail" name="messageStatusChangeFault"/>
  </wsdl:message>
  <wsdl:portType name="BackendInterface">
    <wsdl:operation name="submitMessage">
      <wsdl:input message="tns:submitMessage" name="submitRequest"></wsdl:input>
      <wsdl:output message="tns:submitMessageResponse" name="submitMessageResponse"></wsdl:output>
      <wsdl:fault message="tns:submitMessageFault" name="submitMessageFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="sendSuccess">
      <wsdl:input message="tns:sendSuccess" name="sendSuccess"></wsdl:input>
      <wsdl:output message="tns:sendSuccessResponse" name="sendSuccessResponse"></wsdl:output>
      <wsdl:fault message="tns:sendSuccessFault" name="sendSuccessFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="sendFailure">
      <wsdl:input message="tns:sendFailure" name="sendFailure"></wsdl:input>
      <wsdl:output message="tns:sendFailureResponse" name="sendFailureResponse"></wsdl:output>
      <wsdl:fault message="tns:sendFailureFault" name="sendFailureFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="receiveSuccess">
      <wsdl:input message="tns:receiveSuccess" name="receiveSuccess"></wsdl:input>
      <wsdl:output message="tns:receiveSuccessResponse" name="receiveSuccessResponse"></wsdl:output>
      <wsdl:fault message="tns:receiveSuccessFault" name="receiveSuccessFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="receiveFailure">
      <wsdl:input message="tns:receiveFailure" name="receiveFailure"></wsdl:input>
      <wsdl:output message="tns:receiveFailureResponse" name="receiveFailureResponse"></wsdl:output>
      <wsdl:fault message="tns:receiveFailureFault" name="receiveFailureFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="delete">
      <wsdl:input message="tns:delete" name="delete"></wsdl:input>
      <wsdl:output message="tns:deleteResponse" name="deleteResponse"></wsdl:output>
      <wsdl:fault message="tns:deleteFault" name="deleteFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="deleteBatch">
      <wsdl:input message="tns:deleteBatch" name="deleteBatch"></wsdl:input>
      <wsdl:output message="tns:deleteBatchResponse" name="deleteBatchResponse"></wsdl:output>
      <wsdl:fault message="tns:deleteBatchFault" name="deleteBatchFault"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="messageStatusChange">
      <wsdl:input message="tns:messageStatusChange" name="messageStatusChange"></wsdl:input>
      <wsdl:output message="tns:messageStatusChangeResponse" name="messageStatusChangeResponse"></wsdl:output>
      <wsdl:fault message="tns:messageStatusChangeFault" name="messageStatusChangeFault"></wsdl:fault>
    </wsdl:operation>
  </wsdl:portType>
  <wsdl:binding name="BackendServiceSoapBinding" type="tns:BackendInterface">
    <soap12:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
    <wsdl:operation name="submitMessage">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="submitMessage">
        <soap12:header message="tns:submitMessage" part="headerInfo" use="literal"/>
        <soap12:body parts="submitRequest" use="literal"/>
      </wsdl:input>
      <wsdl:output name="submitMessageResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="submitMessageFault">
        <soap12:fault name="submitMessageFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="sendSuccess">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="sendSuccess">
        <soap12:body parts="sendSuccess" use="literal"/>
      </wsdl:input>
      <wsdl:output name="sendSuccessResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="sendSuccessFault">
        <soap12:fault name="sendSuccessFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="sendFailure">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="sendFailure">
        <soap12:body parts="sendFailure" use="literal"/>
      </wsdl:input>
      <wsdl:output name="sendFailureResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="sendFailureFault">
        <soap12:fault name="sendFailureFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="receiveSuccess">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="receiveSuccess">
        <soap12:body parts="receiveSuccess" use="literal"/>
      </wsdl:input>
      <wsdl:output name="receiveSuccessResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="receiveSuccessFault">
        <soap12:fault name="receiveSuccessFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="receiveFailure">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="receiveFailure">
        <soap12:body parts="receiveFailure" use="literal"/>
      </wsdl:input>
      <wsdl:output name="receiveFailureResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="receiveFailureFault">
        <soap12:fault name="receiveFailureFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="delete">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="delete">
        <soap12:body parts="delete" use="literal"/>
      </wsdl:input>
      <wsdl:output name="deleteResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="deleteFault">
        <soap12:fault name="deleteFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="deleteBatch">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="deleteBatch">
        <soap12:body parts="deleteBatch" use="literal"/>
      </wsdl:input>
      <wsdl:output name="deleteBatchResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="deleteBatchFault">
        <soap12:fault name="deleteBatchFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="messageStatusChange">
      <soap12:operation soapAction="" style="document"/>
      <wsdl:input name="messageStatusChange">
        <soap12:body parts="messageStatusChange" use="literal"/>
      </wsdl:input>
      <wsdl:output name="messageStatusChangeResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="messageStatusChangeFault">
        <soap12:fault name="messageStatusChangeFault" use="literal"/>
      </wsdl:fault>
    </wsdl:operation>
  </wsdl:binding>
  <wsdl:service name="BackendService">
    <wsdl:port binding="tns:BackendServiceSoapBinding" name="BACKEND_PORT">
      <soap12:address location="http://localhost:8080/backend"/>
    </wsdl:port>
  </wsdl:service>
</wsdl:definitions>]]></con:content><con:type>http://schemas.xmlsoap.org/wsdl/</con:type></con:part><con:part><con:url>file:\C:\work\digit\tools\domibus\5.1RC2\domibus-msh-distribution-5.1-20221004.095246-108-default-ws-plugin\conf\domibus\plugins\backend\BackendService.xsd</con:url><con:content><![CDATA[<xsd:schema targetNamespace="eu.domibus" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xmime="http://www.w3.org/2005/05/xmlmime" xmlns:tns="eu.domibus">
  <xsd:simpleType name="max255-non-empty-string">
    <xsd:restriction base="xsd:string">
      <xsd:minLength value="1"/>
      <xsd:maxLength value="255"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="max1024-non-empty-string">
    <xsd:restriction base="xsd:string">
      <xsd:minLength value="1"/>
      <xsd:maxLength value="1024"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="messageStatus">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="READY_TO_SEND"/>
      <xsd:enumeration value="READY_TO_PULL"/>
      <xsd:enumeration value="BEING_PULLED"/>
      <xsd:enumeration value="SEND_ENQUEUED"/>
      <xsd:enumeration value="SEND_IN_PROGRESS"/>
      <xsd:enumeration value="WAITING_FOR_RECEIPT"/>
      <xsd:enumeration value="ACKNOWLEDGED"/>
      <xsd:enumeration value="ACKNOWLEDGED_WITH_WARNING"/>
      <xsd:enumeration value="SEND_ATTEMPT_FAILED"/>
      <xsd:enumeration value="SEND_FAILURE"/>
      <xsd:enumeration value="NOT_FOUND"/>
      <xsd:enumeration value="WAITING_FOR_RETRY"/>
      <xsd:enumeration value="RECEIVED"/>
      <xsd:enumeration value="RECEIVED_WITH_WARNINGS"/>
      <xsd:enumeration value="DELETED"/>
      <xsd:enumeration value="DOWNLOADED"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="LargePayloadType">
    <xsd:sequence>
      <xsd:element name="value" type="xsd:base64Binary" xmime:expectedContentTypes="application/octet-stream"/>
    </xsd:sequence>
    <xsd:attribute name="payloadId" type="xsd:token"/>
    <xsd:attribute name="contentType" type="xsd:string"/>
    <xsd:attribute name="mimeType" type="xsd:string"/>
    <xsd:attribute name="payloadName" type="xsd:string"/>
  </xsd:complexType>
  <xsd:element name="submitRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element minOccurs="0" name="bodyload" type="tns:LargePayloadType"/>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="payload" type="tns:LargePayloadType"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="Messaging" type="tns:Messaging"/>
  <xsd:complexType name="Messaging">
    <xsd:sequence>
      <xsd:element name="UserMessage" type="tns:UserMessage" minOccurs="0"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="UserMessage">
    <xsd:all>
      <xsd:element name="MessageInfo" type="tns:MessageInfo" minOccurs="0"/>
      <xsd:element name="PartyInfo" type="tns:PartyInfo"/>
      <xsd:element name="CollaborationInfo" type="tns:CollaborationInfo"/>
      <xsd:element name="MessageProperties" type="tns:MessageProperties" minOccurs="0"/>
      <xsd:element name="PayloadInfo" type="tns:PayloadInfo" minOccurs="0"/>
      <xsd:element name="ProcessingType" type="tns:ProcessingType" minOccurs="0" default="PUSH"/>
    </xsd:all>
    <xsd:attribute name="mpc" type="xsd:anyURI" use="optional"/>
  </xsd:complexType>
  <xsd:simpleType name="ProcessingType">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="PUSH"/>
      <xsd:enumeration value="PULL"/>
      <xsd:minLength value="0"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="MessageInfo">
    <xsd:all>
      <xsd:element name="Timestamp" type="xsd:dateTime" minOccurs="0"/>
      <xsd:element name="MessageId" type="tns:max255-non-empty-string" minOccurs="0"/>
      <xsd:element name="RefToMessageId" type="tns:max255-non-empty-string" minOccurs="0"/>
    </xsd:all>
  </xsd:complexType>
  <xsd:complexType name="PartyInfo">
    <xsd:all>
      <xsd:element name="From" type="tns:From"/>
      <xsd:element name="To" type="tns:To" minOccurs="0"/>
    </xsd:all>
  </xsd:complexType>
  <xsd:complexType name="PartyId">
    <xsd:simpleContent>
      <xsd:extension base="tns:max255-non-empty-string">
        <xsd:attribute name="type" type="tns:max255-non-empty-string"/>
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="From">
    <xsd:all>
      <xsd:element name="PartyId" type="tns:PartyId"/>
      <xsd:element name="Role" type="tns:max255-non-empty-string"/>
    </xsd:all>
  </xsd:complexType>
  <xsd:complexType name="To">
    <xsd:all>
      <xsd:element name="PartyId" type="tns:PartyId"/>
      <xsd:element name="Role" type="tns:max255-non-empty-string"/>
    </xsd:all>
  </xsd:complexType>
  <xsd:complexType name="CollaborationInfo">
    <xsd:all>
      <xsd:element name="AgreementRef" type="tns:AgreementRef" minOccurs="0"/>
      <xsd:element name="Service" type="tns:Service"/>
      <xsd:element name="Action" type="xsd:token"/>
      <xsd:element name="ConversationId" type="xsd:token" minOccurs="0"/>
    </xsd:all>
  </xsd:complexType>
  <xsd:complexType name="Service">
    <xsd:simpleContent>
      <xsd:extension base="tns:max255-non-empty-string">
        <xsd:attribute name="type" type="tns:max255-non-empty-string" use="optional"/>
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="AgreementRef">
    <xsd:simpleContent>
      <xsd:extension base="tns:max255-non-empty-string">
        <xsd:attribute name="type" type="tns:max255-non-empty-string" use="optional"/>
        <xsd:attribute name="pmode" type="tns:max255-non-empty-string" use="optional"/>
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="PayloadInfo">
    <xsd:sequence>
      <xsd:element name="PartInfo" type="tns:PartInfo" maxOccurs="unbounded"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="PartInfo">
    <xsd:all>
      <xsd:element name="PartProperties" type="tns:PartProperties" minOccurs="0"/>
    </xsd:all>
    <xsd:attribute name="href" type="xsd:token"/>
  </xsd:complexType>
  <xsd:complexType name="Property">
    <xsd:simpleContent>
      <xsd:extension base="tns:max1024-non-empty-string">
        <xsd:attribute name="name" type="tns:max255-non-empty-string" use="required"/>
        <xsd:attribute name="type" type="tns:max255-non-empty-string" use="optional"/>
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="PartProperties">
    <xsd:sequence>
      <xsd:element name="Property" type="tns:Property" maxOccurs="unbounded"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="MessageProperties">
    <xsd:sequence>
      <xsd:element name="Property" type="tns:Property" maxOccurs="unbounded"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="BackendFaultDetail">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="code" type="xsd:string"/>
        <xsd:element name="message" nillable="true" type="xsd:string"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="sendSuccess">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="sendFailure">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="receiveSuccess">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="receiveFailure">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="delete">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="deleteBatch">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="messageIds" nillable="true" type="xsd:string"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="messageStatusChange">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="messageID" type="tns:max255-non-empty-string"/>
        <xsd:element name="messageStatus" type="tns:messageStatus"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
</xsd:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part></con:definitionCache><con:endpoints><con:endpoint>http://localhost:8080/backend</con:endpoint></con:endpoints><con:operation id="3aea26af-d290-4f7e-beeb-0e3658d4dd0d" isOneWay="false" action="" name="delete" bindingOperationName="delete" type="Request-Response" outputName="deleteResponse" inputName="delete" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="5531e639-3390-48e7-8ee7-9700a58dc340" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:eu="eu.domibus">\r
   <soap:Header/>\r
   <soap:Body>\r
      <eu:delete>\r
         <messageID>?</messageID>\r
      </eu:delete>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="eu.domibus/BackendInterface/delete"/></con:call></con:operation><con:operation id="e44ffe5e-bcff-430d-b7d4-47393f28f497" isOneWay="false" action="" name="deleteBatch" bindingOperationName="deleteBatch" type="Request-Response" outputName="deleteBatchResponse" inputName="deleteBatch" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="3c5a865d-f15c-45b9-a017-c66701ca8f29" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:eu="eu.domibus">\r
   <soap:Header/>\r
   <soap:Body>\r
      <eu:deleteBatch>\r
         <!--Zero or more repetitions:-->\r
         <messageIds>?</messageIds>\r
      </eu:deleteBatch>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="eu.domibus/BackendInterface/deleteBatch"/></con:call></con:operation><con:operation id="bdd25a1a-561b-4a0a-8f2d-1a25251d0b35" isOneWay="false" action="" name="messageStatusChange" bindingOperationName="messageStatusChange" type="Request-Response" outputName="messageStatusChangeResponse" inputName="messageStatusChange" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="6a8f090b-7804-4960-84a2-a7e783c0b0de" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:eu="eu.domibus">\r
   <soap:Header/>\r
   <soap:Body>\r
      <eu:messageStatusChange>\r
         <messageID>?</messageID>\r
         <messageStatus>?</messageStatus>\r
      </eu:messageStatusChange>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="eu.domibus/BackendInterface/messageStatusChange"/></con:call></con:operation><con:operation id="c591aeaf-658e-4b0b-b79b-14d028729e09" isOneWay="false" action="" name="receiveFailure" bindingOperationName="receiveFailure" type="Request-Response" outputName="receiveFailureResponse" inputName="receiveFailure" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="71dc8509-894c-41ce-b1a8-91d7d6ef39ab" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:eu="eu.domibus">\r
   <soap:Header/>\r
   <soap:Body>\r
      <eu:receiveFailure>\r
         <messageID>?</messageID>\r
      </eu:receiveFailure>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="eu.domibus/BackendInterface/receiveFailure"/></con:call></con:operation><con:operation id="5ba388a8-0ccf-4d11-9c32-013618ffd884" isOneWay="false" action="" name="receiveSuccess" bindingOperationName="receiveSuccess" type="Request-Response" outputName="receiveSuccessResponse" inputName="receiveSuccess" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="a5ade44f-5b6a-474f-8688-f35a4f286caa" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:eu="eu.domibus">\r
   <soap:Header/>\r
   <soap:Body>\r
      <eu:receiveSuccess>\r
         <messageID>?</messageID>\r
      </eu:receiveSuccess>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="eu.domibus/BackendInterface/receiveSuccess"/></con:call></con:operation><con:operation id="260002e1-a7be-4dc8-9abb-dedb584ac7e1" isOneWay="false" action="" name="sendFailure" bindingOperationName="sendFailure" type="Request-Response" outputName="sendFailureResponse" inputName="sendFailure" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="8a65afae-b0dd-4998-b503-6140d0850326" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:eu="eu.domibus">\r
   <soap:Header/>\r
   <soap:Body>\r
      <eu:sendFailure>\r
         <messageID>?</messageID>\r
      </eu:sendFailure>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="eu.domibus/BackendInterface/sendFailure"/></con:call></con:operation><con:operation id="414eb7d3-5ac1-4e16-9678-c0170ae593ff" isOneWay="false" action="" name="sendSuccess" bindingOperationName="sendSuccess" type="Request-Response" outputName="sendSuccessResponse" inputName="sendSuccess" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="5c292e14-8308-4b40-b12d-80847149732d" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8080/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:eu="eu.domibus">\r
   <soap:Header/>\r
   <soap:Body>\r
      <eu:sendSuccess>\r
         <messageID>?</messageID>\r
      </eu:sendSuccess>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="eu.domibus/BackendInterface/sendSuccess"/></con:call></con:operation></con:interface><con:testSuite id="ecb51f9d-a4c1-4d02-b805-30c82dad3934" name="Administration" disabled="true"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Clean Database" searchProperties="true" id="89b9e9c1-5002-4967-89cc-e64407286583">
            <con:settings/>












            <con:testStep type="groovy" name="Clean All" id="0b9af247-383a-49a8-b255-80f349f0e735"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDatabaseAll()
test.finalize()
</script></con:config></con:testStep><con:tearDownScript>Domibus.reportTestCaseCsv(testRunner, log)</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase id="fbc236c7-7235-4db3-baeb-e23f49671aad" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestConnection" searchProperties="true"><con:settings/><con:testStep type="groovy" name="test connection DB" id="e5b3e0e1-d3f0-44cc-94fc-93b329c68e87" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.openConnection()
log.info "CONNECTION OPENED";
test.closeConnection()
log.info "CONNECTION CLOSED";
test.finalize()</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Configuration-localhost-tomcat-tomcat" searchProperties="true" id="19b456a7-c073-470e-83ab-3dd37e9401eb">
            <con:settings/>












            <con:testStep type="groovy" name="Set custom properties-Default-Default" id="d691981f-60e3-44b2-bab0-c1a1bcf95bca"><con:settings/><con:config><script>// blue: tomcat (localhost)
testRunner.testCase.testSuite.project.setPropertyValue("localUrl", "http://localhost:8080/domibus");

// red: tomcat (localhost)
testRunner.testCase.testSuite.project.setPropertyValue("remoteUrl", "http://localhost:8180/domibus");

// Set DB configurations
testRunner.testCase.testSuite.project.setPropertyValue("allDomainsProperties",'''\
{"C2Default":{"site":"C2","domainName":"default","domNo":0,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_blue?useLegacyDatetimeCode=false&amp;serverTimezone=UTC","dbUser":"edelivery","dbPassword":"edelivery"},
"C3Default":{"site":"C3","domainName":"default","domNo":0,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_red?useLegacyDatetimeCode=false&amp;serverTimezone=UTC","dbUser":"edelivery","dbPassword":"edelivery"}}''');

testRunner.testCase.testSuite.project.setPropertyValue("allJMSDomainsProperties",'''\
{"C2Default":{"site":"C2","jmsClientType":"tomcat","hostname":"localhost","jmxPort":"1199","jmsUrl":"tcp://localhost:61616","jmsServerUsername":"domibus","jmsServerPassword":"changeit","jmsPluginUsername":"","jmsPluginPassword":"","jmsQueue":"domibus.backend.jms.inQueue","jmsConnectionFactoryJNDI":""},"C3Default":{"site":"C3","jmsClientType":"tomcat","hostname":"localhost","jmxPort":"1299","jmsUrl":"tcp://localhost:61716","jmsServerUsername":"domibus","jmsServerPassword":"changeit","jmsPluginUsername":"","jmsPluginPassword":"","jmsQueue":"domibus.backend.jms.inQueue","jmsConnectionFactoryJNDI":""}}
''');

// Set third gateway option
testRunner.testCase.testSuite.project.setPropertyValue("thirdGateway", "false");

// Set Multitenancy Modes
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "0");
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0");

// Set C2 and C3 deployment paths
testRunner.testCase.testSuite.project.setPropertyValue("pathBlue", "C:/domibus/1-mainBranch/sender/domibus/");
testRunner.testCase.testSuite.project.setPropertyValue("pathRed", "C:/domibus/1-mainBranch/receiver/domibus/");
testRunner.testCase.testSuite.project.setPropertyValue("pathGreen", "C:/domibus/1-mainBranch/greenReceiver/domibus/");

log.info "Update done.";

</script></con:config></con:testStep><con:testStep type="groovy" name="Set custom properties-multitenancy" id="19b623ae-28b2-4cce-8e37-38b12cc9f74d"><con:settings/><con:config><script><![CDATA[// blue: tomcat (localhost)
testRunner.testCase.testSuite.project.setPropertyValue("localUrl", "http://localhost:8080/domibus")
// red: tomcat (localhost)
testRunner.testCase.testSuite.project.setPropertyValue("remoteUrl", "http://localhost:8180/domibus")

// Set DB configurations
testRunner.testCase.testSuite.project.setPropertyValue("allDomainsProperties",'''\
{"C2Default":{"site":"C2","domainName":"default","domNo":0,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_blue_default?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"edelivery","dbPassword":"edelivery"},
"C3Default":{"site":"C3","domainName":"default","domNo":0,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_red_default?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"edelivery","dbPassword":"edelivery"},
"C2Dom1":{"site":"C2","domainName":"domibus_C2Dom1","domNo":1,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_c2dom1?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"edelivery","dbPassword":"edelivery"},
"C2Dom2":{"site":"C2","domainName":"domibus_C2Dom2","domNo":2,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_c2dom2?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"edelivery","dbPassword":"edelivery"},
"C2Dom3":{"site":"C2","domainName":"a","domNo":3,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_c2dom3?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"edelivery","dbPassword":"edelivery"},
"C2Dom4":{"site":"C2","domainName":"length_equal_50_aaaabbbbbbbbbbbbbbbbbbbbcccccccccc","domNo":4,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_c2dom4?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"edelivery","dbPassword":"edelivery"},
"C3Dom1":{"site":"C3","domainName":"domibus_C3Dom1","domNo":1,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_c3dom1?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"edelivery","dbPassword":"edelivery"},
"C3Dom2":{"site":"C3","domainName":"domibus_C3Dom2","domNo":2,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_c3dom2?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"edelivery","dbPassword":"edelivery"} }''');

// Set third gateway option
testRunner.testCase.testSuite.project.setPropertyValue("thirdGateway", "false")
// Set Multitenancy Modes
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "0")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0")
log.info "Update done.";
]]></script></con:config></con:testStep><con:tearDownScript>Domibus.reportTestCaseCsv(testRunner, log)</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase id="860ceecc-3afc-4146-b991-879ccbb81372" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Configuration-localhost-weblogic-tomcat" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Set custom properties-Default-Default" id="5bc93da8-10be-42cd-84b1-9675b7ef52ad"><con:settings/><con:config><script>// blue: tomcat (localhost)
testRunner.testCase.testSuite.project.setPropertyValue("localUrl", "http://localhost:7003/domibus");

// red: tomcat (localhost)
testRunner.testCase.testSuite.project.setPropertyValue("remoteUrl", "http://localhost:8180/domibus");

// Set DB configurations
testRunner.testCase.testSuite.project.setPropertyValue("allDomainsProperties",'''\
{"C2Default":{"site":"C2","domainName":"default","domNo":0,"dbType":"oracle","dbDriver":"oracle.jdbc.OracleDriver","dbJdbcUrl":"jdbc:oracle:thin:@localhost:1521/orcl","dbUser":"domibus_weblogic","dbPassword":"domibus_weblogic"},
"C3Default":{"site":"C3","domainName":"default","domNo":0,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_red?useLegacyDatetimeCode=false&amp;serverTimezone=UTC","dbUser":"edelivery","dbPassword":"edelivery"}}''');


testRunner.testCase.testSuite.project.setPropertyValue("allJMSDomainsProperties",'''\
{"C2Default":{"site":"C2","jmsClientType":"weblogic","hostname":"localhost","jmxPort":"1199","jmsUrl":"t3://localhost:7003/","jmsServerUsername":"weblogic","jmsServerPassword":"Domibus-123","jmsPluginUsername":"","jmsPluginPassword":"","jmsQueue":"jms/domibus.backend.jms.inQueue","jmsConnectionFactoryJNDI":"jms/ConnectionFactory"},"C3Default":{"site":"C3","jmsClientType":"tomcat","hostname":"localhost","jmxPort":"1299","jmsUrl":"tcp://localhost:61716","jmsServerUsername":"domibus","jmsServerPassword":"changeit","jmsPluginUsername":"","jmsPluginPassword":"","jmsQueue":"domibus.backend.jms.inQueue","jmsConnectionFactoryJNDI":""}}
''');

// Set third gateway option
testRunner.testCase.testSuite.project.setPropertyValue("thirdGateway", "false");

// Set Multitenancy Modes
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "0");
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0");

// Set C2 and C3 deployment paths
testRunner.testCase.testSuite.project.setPropertyValue("pathBlue", "C:/Oracle/Middleware/Oracle_Home/user_projects/domains/standard_domain/");
testRunner.testCase.testSuite.project.setPropertyValue("pathRed", "C:/domibus/1-mainBranch/receiver/domibus/");
testRunner.testCase.testSuite.project.setPropertyValue("pathGreen", "C:/domibus/1-mainBranch/greenReceiver/domibus/");


log.info "Update done.";
</script></con:config></con:testStep><con:testStep type="groovy" name="Set custom properties-Default-Default-bugfix" id="b1704875-4889-4199-9b91-224e6ff7480b"><con:settings/><con:config><script>// blue: tomcat (localhost)
testRunner.testCase.testSuite.project.setPropertyValue("localUrl", "http://localhost:8080/domibus");

// red: tomcat (localhost)
testRunner.testCase.testSuite.project.setPropertyValue("remoteUrl", "http://localhost:8180/domibus");

// Set DB configurations
testRunner.testCase.testSuite.project.setPropertyValue("allDomainsProperties",'''\
{"C2Default":{"site":"C2","domainName":"default","domNo":0,"dbType":"oracle","dbDriver":"oracle.jdbc.OracleDriver","dbJdbcUrl":"jdbc:oracle:thin:@localhost:1521/orcl","dbUser":"domibus_weblogic_bugfix","dbPassword":"domibus_weblogic_bugfix"},
"C3Default":{"site":"C3","domainName":"default","domNo":0,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_red_bugfix?useLegacyDatetimeCode=false&amp;serverTimezone=UTC","dbUser":"edelivery","dbPassword":"edelivery"}}''');


testRunner.testCase.testSuite.project.setPropertyValue("allJMSDomainsProperties",'''\
{"C2Default":{"site":"C2","jmsClientType":"weblogic","hostname":"localhost","jmxPort":"1199","jmsUrl":"t3://localhost:7003/","jmsServerUsername":"weblogic","jmsServerPassword":"Domibus-123","jmsPluginUsername":"","jmsPluginPassword":"","jmsQueue":"jms/domibus.backend.jms.inQueue","jmsConnectionFactoryJNDI":"jms/ConnectionFactory"},"C3Default":{"site":"C3","jmsClientType":"tomcat","hostname":"localhost","jmxPort":"1299","jmsUrl":"tcp://localhost:61716","jmsServerUsername":"domibus","jmsServerPassword":"changeit","jmsPluginUsername":"","jmsPluginPassword":"","jmsQueue":"domibus.backend.jms.inQueue","jmsConnectionFactoryJNDI":""}}
''');
// Set third gateway option
testRunner.testCase.testSuite.project.setPropertyValue("thirdGateway", "false");

// Set Multitenancy Modes
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "0");
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0");

// Set C2 and C3 deployment paths
testRunner.testCase.testSuite.project.setPropertyValue("pathBlue", "C:/Oracle/Middleware/Oracle_Home/user_projects/domains/bugfix_domain/");
testRunner.testCase.testSuite.project.setPropertyValue("pathRed", "C:/domibus/2-bugfixBranch/receiver/domibus/");
testRunner.testCase.testSuite.project.setPropertyValue("pathGreen", "C:/domibus/2-bugfixBranch/greenReceiver/domibus/");


log.info "Update done.";
</script></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="956c05ad-4503-4d82-91bf-5c4bd8a6d9e0" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Start default configuration" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Set custom properties" id="51e2bdfd-110f-4818-921b-0fc089f97498"><con:settings/><con:config><script><![CDATA[// blue: tomcat (localhost)
testRunner.testCase.testSuite.project.setPropertyValue("localUrl", "http://localhost:8080/domibus")
// red: tomcat (localhost)
testRunner.testCase.testSuite.project.setPropertyValue("remoteUrl", "http://localhost:8180/domibus")
// Set DB configurations
testRunner.testCase.testSuite.project.setPropertyValue("allDomainsProperties",'''\
{"C2Default":{"site":"C2","domainName":"default","domNo":0,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_blue?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"root","dbPassword":"root"},
"C3Default":{"site":"C3","domainName":"default","domNo":0,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_red?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"root","dbPassword":"root"},
"thirdDefault":{"site":"third","domainName":"default","domNo":0,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_green?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"root","dbPassword":"root"},
"C2Dom1":{"site":"C2","domainName":"domibus_C2Dom1","domNo":1,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_C2Dom1?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"root","dbPassword":"root"},
"C2Dom2":{"site":"C2","domainName":"domibus_C2Dom2","domNo":2,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_C2Dom2?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"root","dbPassword":"root"},
"C2Dom3":{"site":"C2","domainName":"domibus_C2Dom3","domNo":3,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_C2Dom3?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"root","dbPassword":"root"},
"C3Dom1":{"site":"C3","domainName":"domibus_C3Dom1","domNo":1,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_C3Dom1?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"root","dbPassword":"root"},
"C3Dom2":{"site":"C3","domainName":"domibus_C3Dom2","domNo":2,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_C3Dom2?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"root","dbPassword":"root"},
"C3Dom3":{"site":"C3","domainName":"domibus_C3Dom3","domNo":3,"dbType":"mysql","dbDriver":"com.mysql.cj.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_C3Dom3?useLegacyDatetimeCode=false&serverTimezone=UTC","dbUser":"root","dbPassword":"root"} }''')
// Set third gateway option
testRunner.testCase.testSuite.project.setPropertyValue("thirdGateway", "false")
// Set Multitenancy Modes
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "0")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0")
log.info "Update done.";
]]></script></con:config></con:testStep><con:testStep type="groovy" name="Start Blue-Red" id="83516c0f-b490-4df8-ba71-431f5ac3ecd0"><con:settings/><con:config><script>// Start 2 Domibus: sender and receiver
Domibus.startSetMSHs(1,1,0,context,log)
</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="bc1ecd10-b264-4a11-9ed1-f2d66c752037"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Upload default PModes Blue-Red" id="4e1dc271-b80c-4da3-936e-662976830164"><con:settings/><con:config><script>// Upload PModes: default Pmodes (blue for sender and red for receiver)
PModeUtils.uploadPmode("sender","default","\\blue\\domibus-pmode-blue.xml",context,log)
PModeUtils.uploadPmode("receiver","default","\\red\\domibus-pmode-red.xml",context,log);</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="4a46de03-4211-4650-8b2a-c38cf4a9dc3f"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Upload default truststores Blue-Red" id="56097e58-3c8d-4ab9-9d41-abc8801410c8"><con:settings/><con:config><script>// Upload truststores: default truststores (blue for sender and red for receiver)
TruststoreUtils.uploadTruststore("sender","default","\\blue\\gateway_truststore.jks",context,log)
TruststoreUtils.uploadTruststore("receiver","default","\\red\\gateway_truststore.jks",context,log);</script></con:config></con:testStep><con:testStep type="delay" name="D3" id="87360477-ba31-4df1-9840-087877e309b1"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to JMS Blue-Red" id="42f80b76-a0f6-4335-ad36-ed96e8475b38"><con:settings/><con:config><script>Domibus.setMessageFilters("sender","Jms",context,log)
Domibus.setMessageFilters("receiver","Jms",context,log)
</script></con:config></con:testStep><con:tearDownScript/><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>65ecdf7b-e0e2-477b-b020-da4c7fb8c855</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>3bc33515-eae2-46e7-a50f-1104a8d1a301</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>7aefe4d7-98b5-43b1-8f34-4aa71764de77</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase id="825f027b-a1ab-4821-871e-4a40b42a5dc6" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Start 3 gateways configuration" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Set custom properties" id="b231a9cb-56bb-4be9-a248-7d83b2ce2b21"><con:settings/><con:config><script>// blue: tomcat (edeltest1)
testRunner.testCase.testSuite.project.setPropertyValue("localUrl", "http://localhost:8080/domibus")
testRunner.testCase.testSuite.project.setPropertyValue("databaseBlue", "mysql")
testRunner.testCase.testSuite.project.setPropertyValue("driverBlue", "com.mysql.cj.jdbc.Driver")
testRunner.testCase.testSuite.project.setPropertyValue("jdbcUrlBlue", "jdbc:mysql://localhost:3306/domibus?useLegacyDatetimeCode=false&amp;serverTimezone=UTC")
testRunner.testCase.testSuite.project.setPropertyValue("blueDbPassword", "root")
testRunner.testCase.testSuite.project.setPropertyValue("blueDbPassword", "root")
// red: tomcat (edeltest2)
testRunner.testCase.testSuite.project.setPropertyValue("remoteUrl", "http://localhost:8180/domibus")
testRunner.testCase.testSuite.project.setPropertyValue("databaseRed", "mysql")
testRunner.testCase.testSuite.project.setPropertyValue("driverRed", "com.mysql.cj.jdbc.Driver")
testRunner.testCase.testSuite.project.setPropertyValue("jdbcUrlRed", "jdbc:mysql://localhost:3306/domibus?useLegacyDatetimeCode=false&amp;serverTimezone=UTC")
testRunner.testCase.testSuite.project.setPropertyValue("redDbPassword", "root")
testRunner.testCase.testSuite.project.setPropertyValue("redDbPassword", "root")
testRunner.testCase.testSuite.project.setPropertyValue("thirdGateway", "true")
log.info "Update done.";
</script></con:config></con:testStep><con:testStep type="groovy" name="Start Blue-Red-Green" id="9b479ba2-4281-475b-9db4-2720481014c4"><con:settings/><con:config><script>// Start 3 Domibus: sender, receiver and green.
Domibus.startSetMSHs(1,1,1,context,log)
</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="333d7d54-a398-4359-a7ea-105bffc3da16"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes Blue-Red-Green" id="04c6463a-6296-4e2d-9a78-5913ac3c88fc"><con:settings/><con:config><script>// Upload PModes: blue for sender, red for receiver and green for the third Domibus.
PModeUtils.uploadPmode("sender","special","\\Threegateways\\blue\\domibus-pmode-blue.xml",context,log)
PModeUtils.uploadPmode("receiver","special","\\Threegateways\\red\\domibus-pmode-red.xml",context,log)
PModeUtils.uploadPmode("receivergreen","special","\\Threegateways\\green\\domibus-pmode-green.xml",context,log);</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="f3c9b1ad-9af8-4048-a442-8625f0144dc8"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Upload truststores Blue-Red-Green" id="ed31e288-5d5f-4a3f-ad2e-584863076557"><con:settings/><con:config><script>// Upload truststores: blue for sender, red for receiver and green for the third Domibus.
TruststoreUtils.uploadTruststore("sender","special","\\Threegateways\\blue\\gateway_truststore.jks",context,log)
TruststoreUtils.uploadTruststore("receiver","special","\\Threegateways\\red\\gateway_truststore.jks",context,log)
TruststoreUtils.uploadTruststore("receivergreen","special","\\Threegateways\\green\\gateway_truststore.jks",context,log)
</script></con:config></con:testStep><con:testStep type="delay" name="D3" id="afff02a3-ec9b-405c-80f1-3b4f92787cdc"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to JMS Blue-Red-Green" id="a3c04dfb-510d-4a2c-9a87-80388c800b29"><con:settings/><con:config><script>Domibus.setMessageFilters("sender","Jms",context,log)
Domibus.setMessageFilters("receiver","Jms",context,log)
Domibus.setMessageFilters("receivergreen","Jms",context,log)
</script></con:config></con:testStep><con:tearDownScript/><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>8d861779-0a64-417b-b81f-dbaed89dc796</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>42781f68-9908-4231-93af-c83bd2d27190</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f10dbea4-cf15-49a7-93b9-ab0ef7752097</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase id="63a8e636-e5d7-4ea7-b973-a614ce119c9d" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Add or change Teardown script" searchProperties="true"><con:settings/><con:testStep type="groovy" name="AddToTearDown" id="6aa43adb-f1d7-46e8-bb56-138c4077d9b5"><con:settings/><con:config><script>def lineToAdd = "Domibus.reportTestCaseCsv(testRunner, log)"
log.info "START: Amendment tear down sciprts"
testRunner.testCase.testSuite.project.getTestSuiteList().each { testSuite ->
	testSuite.getTestCaseList().each { testCase ->
 		def td = testCase.getTearDownScript()
  		if (td == null)
  		{
  			testCase.setTearDownScript(lineToAdd)
  		}
  		else if(!td.contains("Domibus.reportTestCaseCsv")) {
  			def newTearDown = td + System.getProperty("line.separator") + lineToAdd
  			testCase.setTearDownScript(newTearDown)
  		}
 	}
 }
log.info "END: Amendment tear down sciprts"
</script></con:config></con:testStep><con:testStep type="groovy" name="ReplaceTearDownLine" id="258a28ca-5857-4660-a3ca-4abcadfd57b2"><con:settings/><con:config><script>def newLine = System.getProperty("line.separator")
/*testRunner.testCase.testSuite.project.getTestSuiteList().each{
	testsuite -> log.info testsuite.name
}*/
//def oldLineToBeChanged = /(?&lt;!\/)Domibus.reportTestCaseCsv/
//def newLineToBeChanged = "Domibus.reportTestCaseCsv"

def newLineToBeChanged = "Domibus.reportTestCaseCsv"
def oldLineToBeChanged = Domibus.reportTestCaseCsv/


log.info "START: Amend tear down scripts"
testRunner.testCase.testSuite.project.getTestSuiteList().each { testSuite ->
	testSuite.getTestCaseList().each { testCase ->
 		def tdScript = testCase.getTearDownScript()
 		log.info tdScript;
  		if (tdScript != null) {
  			testCase.setTearDownScript( tdScript.replaceAll(oldLineToBeChanged, newLineToBeChanged) )
  		}
 	}
 }

 log.info end</script></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="12602fa4-5c92-48aa-89ee-2e6545b7eb08"><con:settings/><con:config><script>def newLine = System.getProperty("line.separator")
def oldLineToBeChanged = /(?&lt;!\/)Domibus.reportTestCaseCsv/

def newLineToBeChanged = "Domibus.reportTestCaseCsv"

def tdScript="""
Domibus.reportTestCaseCsv(testRunner, log)

def test = new Domibus(log,null,context)
def msgID = context.expand( '\${Submit Message#Response#//messageID}' )
test.cleanDBMessageID(msgID)
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
  Domibus.reportTestCaseCsv(testRunner, log)
"""

tdScript.trim().replaceAll(oldLineToBeChanged, newLineToBeChanged)
log.info tdScript</script></con:config></con:testStep><con:tearDownScript>Domibus.reportTestCaseCsv(testRunner, log)</con:tearDownScript><con:properties/><con:reportParameters/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Hash Participant" searchProperties="true" id="30279864-597d-4734-9c69-bdd2aa1d44bf">
            <con:settings/>












            <con:testStep type="groovy" name="Hash" id="1cde6b49-28af-440a-957a-6d15c1b1bb1d"><con:settings/><con:config><script>def test = new BDMSL(log,null,context)
def CNAMEhash=test.encodeHash("0088:579800000778","MD5",false)
def NAPTRhash=test.encodeHash("0088:579800000778","SHA256",true)
log.info "CNAMEhash:"+CNAMEhash;
log.info "NAPTRhash:"+NAPTRhash;
test.finalize()</script></con:config></con:testStep><con:tearDownScript>Domibus.reportTestCaseCsv(testRunner, log)</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase id="7e53cfef-55a5-48f8-91ba-7bba35d88fe4" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Properties handling" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Sample  domibus.property change" id="6eb9f434-db4d-4339-87b8-7c98d6dcf25e"><con:settings/><con:config><script>def newValueToAssignOne="test1s23"
def propertyToChangeNameOne = "domibus.security.keystore.password"
def propValueDict = ["${propertyToChangeNameOne}" : newValueToAssignOne, 'domibus.database.port':'13306', 'domibus.deployment.clustered' : 'true']

Domibus.changeDomibusProperties("RED", propValueDict,  log, context, testRunner)
Domibus.restoreDomibusPropertiesFromBackup("RED",  log, context, testRunner)

</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="55f7cad3-c083-45d3-8e4c-203f47603f76" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Set Third gateway property" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Set true" id="7a122e70-305e-42f3-9636-6ed1d6e6dd12"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("thirdGateway", "true")
log.info "thirdGateway custom property set to true."</script></con:config></con:testStep><con:testStep type="groovy" name="Set false" id="f65f3c39-fe05-418b-adca-dace254dc676"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("thirdGateway", "false")
log.info "thirdGateway custom property set to false."</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="33d0971a-0ba2-470c-9cac-5c1e0834335b" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Pmode Update" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Default Pmodes upload step for reuse" id="d3d895f7-d982-4df2-ba59-ecc1fd97dcc6"><con:settings/><con:config><script>import java.nio.file.Paths
def suffix =  "_SoapuiStringReplace"
def joinedPath = Paths.get(context.expand('${#Project#defaultPModesPath}'),"/blue/domibus-pmode-blue.xml").toUri()
PModeUtils.updatePmodeEndpoints(log, context, testRunner, joinedPath, suffix)
PModeUtils.uploadPmode("sender","default","/blue/domibus-pmode-blue.xml" + suffix, context, log)

joinedPath = Paths.get(context.expand('${#Project#defaultPModesPath}'),"/red/domibus-pmode-red.xml").toUri()
PModeUtils.updatePmodeEndpoints(log, context, testRunner, joinedPath, suffix)
PModeUtils.uploadPmode("receiver","default","/red/domibus-pmode-red.xml" + suffix, context, log)</script></con:config></con:testStep><con:testStep type="groovy" name="Default blue Pmodes upload step for reuse" id="3079302c-23c0-476b-89ac-29fccde0f71b"><con:settings/><con:config><script>import java.nio.file.Paths
def suffix =  "_SoapuiStringReplace"
def joinedPath = Paths.get(context.expand('${#Project#defaultPModesPath}'),"/blue/domibus-pmode-blue.xml").toUri()
PModeUtils.updatePmodeEndpoints(log, context, testRunner, joinedPath, suffix)
PModeUtils.uploadPmode("sender","default","/blue/domibus-pmode-blue.xml" + suffix, context, log)</script></con:config></con:testStep><con:testStep type="groovy" name="Sample Pmode upload" id="35e5527a-c588-44f2-aab7-32eddd4b4236" disabled="true"><con:settings/><con:config><script>import java.nio.file.Paths
def suffix =  "_SoapuiStringReplace"
def joinedPath = Paths.get(context.expand('${#Project#defaultPModesPath}'),"\\blue\\domibus-pmode-blue.xml").toUri()
PModeUtils.updatePmodeEndpoints(log, context, testRunner, joinedPath, suffix)
PModeUtils.uploadPmode("sender","default","\\blue\\domibus-pmode-blue.xml" + suffix, context, log)

joinedPath = Paths.get(context.expand('${#Project#defaultPModesPath}'),"\\red\\domibus-pmode-red.xml").toUri()
PModeUtils.updatePmodeEndpoints(log, context, testRunner, joinedPath, suffix)
PModeUtils.uploadPmode("receiver","default","\\red\\domibus-pmode-red.xml" + suffix, context, log)</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="05d059f9-b965-4eed-834a-152ae9e311f6" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Weblogic sending" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Submit message" id="de4c6d0a-b447-48ae-8f33-387617b80f7f"><con:settings/><con:config><script>import org.apache.commons.io.IOUtils;
import javax.jms.*;
import javax.naming.Context;
import javax.naming.InitialContext;
import javax.security.auth.Subject;
import java.io.InputStream;
import java.security.PrivilegedActionException;
import java.security.PrivilegedExceptionAction;
import java.util.Hashtable;
import java.util.Map;

public class SendJMSMessageOnWeblogic {

    private static final String PROVIDER_URL = "t3://localhost:7001"; // 172.27.0.3    "t3://89.37.56.158:7001"
    private static final String USER = "wls-domibus";
    private static final String PASSWORD = "wls-password-01";
    private static final String CONNECTION_FACTORY_JNDI = "jms/ConnectionFactory";
    private static final String QUEUE = "jms/domibus.backend.jms.inQueue";

   public void run(log) throws RuntimeException {
       log.info "starting"

  try{
       InitialContext ic = getInitialContext(PROVIDER_URL, USER, PASSWORD)

       QueueConnectionFactory cf = (QueueConnectionFactory) ic.lookup(CONNECTION_FACTORY_JNDI)
       QueueConnection qc = cf.createQueueConnection()
       QueueSession qs = qc.createQueueSession(false, Session.AUTO_ACKNOWLEDGE)

       Queue queue = (Queue) ic.lookup( QUEUE)
       QueueSender qsr = qs.createSender(queue)

 final String messageContent = "&lt;hello>world&lt;/hello>";
       qsr.send(createTestMessage(qs, messageContent))
       ic.close()
       log.info "Success"
  } catch(Exception ex) {
  log.info "Error " + ex
  }
    }

    private Message createTestMessage(QueueSession session, String messageContent) throws Exception {
        MapMessage messageMap = session.createMapMessage()
        messageMap.setStringProperty("messageType", "submitMessage")
        messageMap.setStringProperty("service", "bdx:noprocess")
        messageMap.setStringProperty("serviceType", "tc1")
        messageMap.setStringProperty("action", "TC1Leg1")
        messageMap.setStringProperty("fromPartyId", "domibus-blue")
        messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
        messageMap.setStringProperty("toPartyId", "domibus-red")
        messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
        messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
        messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
        messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
        messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
        messageMap.setStringProperty("protocol", "AS4")
        // Optional
        // messageMap.setStringProperty("conversationId", "123")
        // messageMap.setStringProperty("refToMessageId", "11")
  messageMap.setStringProperty("messageId", "c22-jms-" + new Date().getTime())
        messageMap.setJMSCorrelationID("12345")
        messageMap.setStringProperty("totalNumberOfPayloads", "1")
        messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
        messageMap.setStringProperty("payload_1_mimeType", "text/xml")
        messageMap.setStringProperty("payload_1_description", "message")

        byte[] payload = messageContent.getBytes()
        messageMap.setBytes("payload_1", payload)
        return messageMap;
    }

    InitialContext getInitialContext(String providerUrl, String userName, String password) throws Exception {
        InitialContext ic = null;
        if (providerUrl != null) {
            Hashtable&lt;String, String> env = new Hashtable&lt;String, String>()
            env.put(Context.PROVIDER_URL, providerUrl)
            env.put(Context.INITIAL_CONTEXT_FACTORY, "weblogic.jndi.WLInitialContextFactory")
            if (userName != null) {
                env.put(Context.SECURITY_PRINCIPAL, userName)
            }
            if (password != null) {
                env.put(Context.SECURITY_CREDENTIALS, password)
            }
            ic = new InitialContext(env)
        } else {
            ic = new InitialContext()
        }
        return ic;
    }

}

def smw = new SendJMSMessageOnWeblogic()
smw.run(log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="a0de112b-18c4-451e-9ff5-e9ffc976d294"><con:settings/><con:config><script>import javax.jms.*;
import javax.naming.Context;
import javax.naming.InitialContext;
import javax.security.auth.Subject;
import java.io.InputStream;
import java.security.PrivilegedActionException;
import java.security.PrivilegedExceptionAction;
import java.util.Date;
import java.util.Hashtable;
import java.util.Map;

public class JMSDomibusTest {

    private static final String PROVIDER_URL = "t3://localhost:8002"; //172.27.0.3
    private static final String USER = "wls-domibus";
    private static final String PASSWORD = "wls-password-01";
    private static final String CONNECTION_FACTORY_JNDI = "jms/ConnectionFactory";
    private static final String QUEUE = "jms/domibus.backend.jms.inQueue";


    static  Message createTestMessage(QueueSession session, String messageContent) throws Exception {
        MapMessage messageMap = session.createMapMessage()
        messageMap.setStringProperty("messageType", "submitMessage")
        messageMap.setStringProperty("service", "bdx:noprocess")
        messageMap.setStringProperty("serviceType", "tc1")
        messageMap.setStringProperty("action", "TC1Leg1")
        messageMap.setStringProperty("fromPartyId", "domibus-blue")
        messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
        messageMap.setStringProperty("toPartyId", "domibus-red")
        messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
        messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
        messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
        messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
        messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
        messageMap.setStringProperty("protocol", "AS4")
        // Optional
        // messageMap.setStringProperty("conversationId", "123")
        // messageMap.setStringProperty("refToMessageId", "11")
        messageMap.setStringProperty("messageId", "c22-jms-" + new Date().getTime())
        messageMap.setJMSCorrelationID("12345")
        messageMap.setStringProperty("totalNumberOfPayloads", "1")
        messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
        messageMap.setStringProperty("payload_1_mimeType", "text/xml")
        messageMap.setStringProperty("payload_1_description", "message")
        byte[] payload = messageContent.getBytes()
        messageMap.setBytes("payload_1", payload)
        return messageMap;
    }

    static InitialContext getInitialContext(String providerUrl, String userName, String password) throws Exception {
        InitialContext ic = null;
        if (providerUrl != null) {
            Hashtable&lt;String, String> env = new Hashtable&lt;String, String>()
            env.put(Context.PROVIDER_URL, providerUrl)
            env.put(Context.INITIAL_CONTEXT_FACTORY, "weblogic.jndi.WLInitialContextFactory")
            if (userName != null) {
                env.put(Context.SECURITY_PRINCIPAL, userName)
            }
            if (password != null) {
                env.put(Context.SECURITY_CREDENTIALS, password)
            }
            ic = new InitialContext(env)
        } else {
            ic = new InitialContext()
        }
        return ic;
    }


    public static  void run(log) {
    	         log.info "run started"
        try{
        	log.info "run started"
            InitialContext ic = getInitialContext(PROVIDER_URL, USER, PASSWORD)
            log.info "Contect initialized"
            QueueConnectionFactory cf = (QueueConnectionFactory) ic.lookup(CONNECTION_FACTORY_JNDI)
            QueueConnection qc = cf.createQueueConnection()
            QueueSession qs = qc.createQueueSession(false, Session.AUTO_ACKNOWLEDGE)
            log.info("Contect initialized")
            Queue queue = (Queue) ic.lookup( QUEUE)
            log.info("Got Queue: " +queue)
            QueueSender qsr = qs.createSender(queue)
            final String messageContent = "&lt;hello>world&lt;/hello>";
            qsr.send(createTestMessage(qs, messageContent))
            log.info("Send message: ")
            ic.close()
            log.info "Close connection message: "
        } catch(Exception ex) {
        	log.error "catch  $ex"
            ex.printStackTrace()
        }
    }
}


def smw = new JMSDomibusTest()
smw.run(log)
</script></con:config></con:testStep><con:properties/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="77e7a3b0-5ab0-489d-9038-5447dafadf31" name="JMS-oneway Push-Auto for Bamboo"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS000-Setup Environment and Database" searchProperties="true" id="58f94605-f8f7-44f0-94fe-9420906631cf" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Clean All DBs" id="1ed5a4a6-8b61-4e3a-811d-1ddf714ed353"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDatabaseAll()
test.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Add plugin users" id="bbfe745b-6611-4029-a78d-9df48e2027ec"><con:settings/><con:config><script>def unsecureLoginAllowed = context.expand("\${#Project#unsecureLoginAllowed}").toLowerCase()
if (unsecureLoginAllowed == "false" || unsecureLoginAllowed == 0) {
		 def domainValue="Default"
		 def userC2U=context.expand('${#Project#pluginAdminC2Default}')
		 def userC3U=context.expand('${#Project#pluginAdminC3Default}')
		 def passwordPl=context.expand('${#Project#adminDefaultPassword}')
		 def userRole="ROLE_ADMIN"
		 def originalUserC2="urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1"

		Domibus.removePluginUser("C2", context, log, domainValue, userC2U)
		Domibus.addPluginUser("C2", context, log, domainValue, userRole, userC2U, passwordPl, "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")

		Domibus.removePluginUser("C3",context,log,domainValue,userC3U)
		Domibus.addPluginUser("C3", context, log, domainValue, userRole, userC3U, passwordPl, "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
 }</script></con:config></con:testStep><con:tearDownScript>Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS001-Submit Message-Basic Flow" searchProperties="true" id="09c7671c-9ec6-492d-a49c-fc48bb9b2d9a">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message To C2" id="0b039a63-a074-486c-a75b-160130ed1b10"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)


messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message To C3" id="da4ddaac-e793-4f02-aeda-1be674754869"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin



def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC3()
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)


messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-red")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-blue")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="ee32e1f5-990f-4f61-ae4e-2d85a3537400" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS001-") // Message ID not set to fix value => test step disabled
test.finalize()
</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS001-")
test.finalize()

Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS002-Submit Message-Basic Flow-Message with ID" searchProperties="true" id="9cf1bea9-7223-49a7-adaf-1d6dcbff3f5f">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="76ca6264-4763-4c2a-b5aa-2e6c828dca12"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc11")
messageMap.setStringProperty("action", "TC11Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushShortRetention")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS002-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="a908066f-80f0-4095-9de8-806b0907f13a"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS002-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS002-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS006-Submit Message-Exceptional flow-Data-Message ID-Unicity" searchProperties="true" id="e1c31dd1-418b-4d1f-ae76-f27ee83d9349">
            <con:settings/>
            <con:testStep type="groovy" name="Submit Message 1" id="c55c70f7-d2a6-454e-a61c-46544188624e"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS006-")
messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep>











            <con:testStep type="groovy" name="Test 1" id="7c668c46-d8f4-462e-980f-9cb45f4c3f43"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS006-")
test.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="09583593-c8b1-4d8e-9370-23cd898cc527"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS006-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test 2" id="a3ebb782-75fd-4df4-a09f-694ea7f01861"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessageUnicity("-DomJMS006-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS006-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>5b884e9e-8168-43ec-a800-c1e72d658f40</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>36f270ac-60cf-4343-beeb-264d81eb2c0d</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>79af0a89-82d5-40dc-8246-f7524f20975f</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>9a04f265-9f1d-4a32-a7ab-54f65dc0cbc8</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS007-Submit Message-messageType-Mandatory" searchProperties="true" id="7c3d57a7-5f71-4a12-a43b-2537a8b27f7c">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="8c94763a-b0c0-4b2a-ae05-5e2f7e9a5e56"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

//messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS007-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="a7b8d8a6-819e-4fb9-80af-9639df60cc04"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS007-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS007-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS008-Submit Message-messageType-Value" searchProperties="true" id="4da5a4eb-1854-418e-bb43-3f3861e050b2">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="25e74207-92ca-4840-bd3a-1a48fe57b3f2"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "pushMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS008-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="8b7acfa0-d425-4ca6-a05f-daa904ecef57"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS008-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS008-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS009-Submit Message-action-Mandatory" searchProperties="true" id="154959a9-5f83-4390-8024-bbf79f7ed5b4">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="a2b0e2b9-ba9a-4611-b8fe-08033be7bf5f"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
//messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS009-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="21c156be-42d6-48ea-be59-3e5b3da4b4c9"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS009-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS009-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS012-Submit Message-Service-Mandatory" searchProperties="true" id="5357f2a4-dab6-40b0-b0f8-d0968070506a">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="710b1558-67ad-49c0-9ab9-3651c925782c"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
//messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS012-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="8209c140-4820-4c85-bd3d-301303082d33"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS012-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS012-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS014-Submit Message-serviceType-Optional-service untyped" searchProperties="true" id="7eb1fd67-0025-4238-b9b9-3113e7f4b98d">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="94fe5311-2e5f-44cb-83da-db39a7177b74"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocessuntyped")
//messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS014-");

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="ffc8646a-f605-4f2f-819a-e05c93d4f969"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test" id="b7239bdc-500d-4148-825e-084bb2dddf70"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS014-");
test.finalize();</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS014-");
test.finalize();
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS015-Submit Message-serviceType-Mandatory-service typed" searchProperties="true" id="579c04a9-d59a-444c-a3af-c9339551a8aa">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="5cfd1b80-608e-4f6e-bdbd-e7ee0d179b38"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
//messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS015-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="7df5af29-acc2-4904-9226-cbf598c38a86"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS015-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS015-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS017-Submit Message-conversationId" searchProperties="true" id="0f53a707-df89-4b1c-aa07-73a95d2c1139">
            <con:description/><con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="2002b4a1-a3dd-41de-8cd2-6a8ef1e5c8ef"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS017-1-")
messageMap.setStringProperty("conversationId", "123")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="8e6e75a9-a789-40a2-aede-8b981a7713be"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC3()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-red")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-blue")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap, "pluginAdminC3Default")

messageMap.setStringProperty("messageId", "-DomJMS017-2-")
messageMap.setStringProperty("conversationId", "123")
messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 3" id="8c82e9d6-84bb-44bd-8ecf-f4b01a958963"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS017-3-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="5b9875d0-0c39-4889-b6f4-724fdc673410"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS017-1-")
test.waitForStatus("DOWNLOADED","ACKNOWLEDGED","-DomJMS017-2-","300")
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS017-3-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS017-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS018-Submit Message-refToMessageId" searchProperties="true" id="e76a546c-205e-434c-8cc5-5a55f2276da0">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="43ce25cd-6590-4dbb-aa0c-e60c77eff39d"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS018-1-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="13bc3aaa-6a05-4220-a0e9-9c7fa270361d"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS018-2-")
messageMap.setStringProperty("refToMessageId", "-DomJMS018-1-")


messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 3" id="c0bb13d8-e6b4-49aa-887b-d0141faed0da"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS018-3-")
messageMap.setStringProperty("refToMessageId", "-random-")
messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="421960e5-5b87-4752-a08f-5f02a0f2da4c"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS018-1-")
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS018-2-")
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS018-3-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS018-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS020-Submit Message-agreementRef-Optional" searchProperties="true" id="71c7527a-7d68-4cf9-80e8-7118339c20ae">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="8a5ec52f-c343-4401-a78b-dc3397f8ae0a"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc4")
messageMap.setStringProperty("action", "TC4Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS020-1-");
messageMap.setStringProperty("agreementRef", "DummyAgr");


messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="10f96922-5ba7-4d4e-a8be-d307d1ea53ea"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test 1" id="7c6b5f82-381c-4a4e-8aee-f9d20a2c2f4c"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS020-1-");
test.finalize();</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="a7cb6a45-d7af-40af-a1fa-b598b03020e1"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="dc6b07ba-a0c9-43e5-a614-926e19d6ca1f"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS020-2-");

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="3bd7d0c1-0fdf-4a39-b815-91408ecfc477"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test 2" id="699f356f-3bca-4a6f-a330-c3fb4f23ff77"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS020-2-");
test.finalize();</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS020-");
test.finalize();
Domibus.reportTestCaseCsv(testRunner, log);
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS023-Submit Message-agreementRefType-Optional" searchProperties="true" id="48087276-f522-4270-a456-51ee7eed6a31">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="20fccce9-a916-485c-9a27-362217e68e24"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc4")
messageMap.setStringProperty("action", "TC4Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS023-1-");
messageMap.setStringProperty("agreementRef", "DummyAgr");
messageMap.setStringProperty("agreementRefType", "DUM");

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="4cdd2bdd-36d5-4cdd-9696-23fa11310392"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test 1" id="f8f5d49f-40d4-41b7-b54c-d66fcf9298a5"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS023-1-");
test.finalize();</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="062ace48-f007-4735-acee-dbd754898f70"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="3636525c-2731-4821-af90-f770e7c256ee"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc4")
messageMap.setStringProperty("action", "TC4Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS023-2-");
messageMap.setStringProperty("agreementRef", "DummyAgr");

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="360ab290-132d-477b-b6c3-bc6d7f2566f0"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test 2" id="957cbb54-3301-466a-a376-7628cc6a6814"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS023-2-");
test.finalize();</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS023-");
test.finalize();
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS024-Submit Message-fromRole-Mandatory" searchProperties="true" id="4d8c8d04-63f1-4ba4-b484-ed3996d908d0">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="245def92-8d3e-43fb-b019-d5157da90143"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
//messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS024-1-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="bb26a55d-5a1b-446f-b53c-e890791efb53"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS024-2-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="2d3fdf5c-abde-493d-b771-687d56f0a455"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS024-2-")
test.verifyMessagePresence(0,0,"-DomJMS024-1-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS024-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS025-Submit Message-fromRole-Empty" searchProperties="true" id="11d02294-6ca4-4469-b70e-fe6978f627ee">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="950582b0-1bba-400c-8d70-91b9223b73a8"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "")
messageMap.setStringProperty("toRole", "")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS025-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="383e5de7-0aea-47c3-8ba4-20e80107e68e"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS025-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS025-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS028-Submit Message-toRole-Mandatory" searchProperties="true" id="c4ec71b7-a7b7-45f7-b56c-055dc67f30c5">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="3db2339c-aa45-4b1f-8e0d-2e25b8ba4f21"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
//messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS028-1-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="96fe4b2a-dd52-49b3-8815-30ef4d85ab01"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS028-2-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="99493d82-dff7-4239-b452-a00a86beee32"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS028-2-")
test.verifyMessagePresence(0,0,"-DomJMS028-1-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS028-1-")
test.cleanDBMessageID("-DomJMS028-2-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS029-Submit Message-toRole-Empty" searchProperties="true" id="229d5bd7-a8c0-4fe0-a6af-12f8fd8ce596">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="fa37af45-b1f9-4d24-9104-f56cd8a72604"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "")
messageMap.setStringProperty("toRole", "")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS029-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="e1a6dbd4-f80e-4805-83f4-45a776c88e3f"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS029-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS029-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS032-Submit Message-fromPartyId-Mandatory" searchProperties="true" id="c7491a08-7f10-4579-96ec-a1e3be0ab4e6">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="0986fc9e-9456-41d4-b54a-b81c28d286a2"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("Timestamp", "2016-01-10")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
//messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS032-1-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="dde0e0ec-3e29-47e5-936f-7011ce835b68"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS032-2-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="3d280e73-624f-486f-970d-96bda540713e"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS032-2-")
test.verifyMessagePresence(0,0,"-DomJMS032-1-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS032-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS034-Submit Message-fromPartyType-Mandatory" searchProperties="true" id="1475cd6e-5249-496a-90e6-9d00ae32bbc7">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="9a8e3daf-40db-4768-8734-340826a05837"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
//messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS034-1-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="a1d5034a-b061-4324-8670-0d6616fd9aab"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS034-2-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="5c02f95b-86da-40bb-aa84-5be24286fbac"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS034-2-")
test.verifyMessagePresence(0,0,"-DomJMS034-1-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS034-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS036-Submit Message-toPartyId-Mandatory" searchProperties="true" id="11dadda3-e68d-476c-ab41-b8d0f553014c">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="d571e0e1-db74-4777-ad93-5f701d4e47d8"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
//messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS036-1-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="e76e2dac-1cdf-4f19-9f73-5274ae0a7971"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS036-2-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="67789b3c-0abc-499c-9aef-58270e1006f4"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS036-2-")
test.verifyMessagePresence(0,0,"-DomJMS036-1-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS036-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS038-Submit Message-toPartyType-Mandatory" searchProperties="true" id="d67a2aeb-6e19-44e5-8180-02b52cc24dc7">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="6961f9fd-0cd0-42e7-916c-4f63f2a9e82b"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
//messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS038-1-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="1237bd6e-661c-45e6-8dee-24816c3838ac"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS038-2-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="471b4bbe-a301-47f1-839b-7759f6477765"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS038-2-")
test.verifyMessagePresence(0,0,"-DomJMS038-1-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS038-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS040-Submit Message-JMScorrelationId-Optional" searchProperties="true" id="a2182a71-837b-4794-a585-66cb58636f5b">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="803c344c-f245-4429-a132-47da4470d1f5"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS040-1-");
messageMap.setStringProperty("JMScorrelationId", "-DomJMS040-1-JMScorrelationId-");

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="8d55db9a-b9d7-492d-aefc-1a26f80139e5"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test 1" id="e5a13d13-c0f2-4a09-bb89-1f1ff713bc8a"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS040-1-")
test.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="9521afda-c05b-423d-8a20-43ef2accb1c8"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="49a3e254-55eb-4557-9c74-d31c3f4cc87a"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS040-2-");

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="5932ec5e-d76d-4150-b483-956bd806730d"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test 2" id="9560c2c7-a0fa-44a2-8329-9baa2142de7b"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS040-2-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS040-");
test.finalize();
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS041-Submit Message-originalSender-FinalReceiver-Optional" searchProperties="true" id="e3ef98ff-0850-4910-a950-2d12f9d624a7">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="77ef6b23-174a-4875-9b50-925e5944c3eb"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocessuntyped")
messageMap.setStringProperty("action", "TC33Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
//messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
//messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS041-");

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="9c4d0d68-e0cc-4282-a87b-3049c12d18b3"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS041-");
test.finalize();</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS041-");
test.finalize();

Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS043-Submit Message-protocol-Optional" searchProperties="true" id="13d65060-7986-4e57-a159-930a0032398d">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="432d005a-a6cf-4f94-a3ff-74c42384a95c"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS043-1-");

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="a874a945-2546-4fd3-b5c7-bb023fe998ba"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test 1" id="099ac723-075a-4c11-a87b-1a058181793a"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS043-1-");
test.finalize();</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="6e4de959-da15-4440-883d-61808fa2eb56"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="8019df00-99c8-481f-8e58-ec056036b4da"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS043-2-");

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="4edc79cc-107b-4c29-9615-597058791b03"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test 2" id="8d161a4e-93d9-4695-885f-7ab50529de11"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS043-2-");
test.finalize();</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS043-");
test.finalize();

Domibus.reportTestCaseCsv(testRunner, log);
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS044-Submit Message-totalNumberOfPayloads-Mandatory" searchProperties="true" id="b20f4b37-3abe-4d2e-9c4f-d35ee8ef2ad2">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="861463e3-5f4e-4d36-9c82-baa76c047824"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS044-1-")

//messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="f3b8d6c7-2992-4a61-adbb-6513fa46ab89"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS044-2-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="6c5b0306-966a-4f12-845e-5dad8967706e"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS044-2-")
test.verifyMessagePresence(0,0,"-DomJMS044-1-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS044-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS045-Submit Message-totalNumberOfPayloads-Mandatory" searchProperties="true" id="139f234d-1929-4dd5-b419-7af48f983257">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="2dd5f6cd-eb0b-4e82-9a04-27c04a2f809d"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS045-1-");

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="c5ad65e6-8e67-47ca-9427-2b8ed1e6b88e"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test 1" id="f18db718-223c-4e29-95ee-d5791a910f1a"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS045-1-");
test.finalize();</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="528c6a7f-2a1a-4adb-895b-f51121bc170e"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="f3985c05-f389-452e-9539-b821ccfbcb65"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS045-2-");

//messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="f9bf50ee-6bdd-4f28-8900-8ef50cf8e0cb"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test 2" id="36e7bb0d-6135-40b0-bf46-e4f3b95ae555"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS045-");
test.finalize();</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS045-");
test.finalize();

Domibus.reportTestCaseCsv(testRunner, log);</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS048-Submit Message-payload_contentId" searchProperties="true" id="c24cdd09-61e4-489e-915c-b1687f9cea6b">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="f5be7934-dd60-494f-951c-9da1cbbd00cb"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS048-1-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:whatever")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="ceb4ab35-53a3-4ce0-9278-57be98f9f2f5"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS048-2-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 3" id="ad36be4e-be8e-40c0-b394-c19fd06e6c49"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS048-3-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
//messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="a6bee7e0-7303-499b-b1e4-6c995e1de9e8"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS048-1-")
test.verifyMessagePresence(0,0,"-DomJMS048-2-")
test.verifyMessagePresence(0,0,"-DomJMS048-3-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS048-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS049-Submit Message-MimeType-Optional" searchProperties="true" id="c87ff1b9-2648-4a7b-8a62-ceba8456f548">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="4de70ab0-ee0c-48d6-b1d3-108515622d0f"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS049-1-");


messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="bdfc2185-2bfe-4423-9bf8-7da1fcfd75bc"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test 1" id="165e563c-a507-4b85-8941-17b1a603b977"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS049-1-");
test.finalize();</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="13489a71-1c89-48fd-9787-b1b64efd9d45"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="37bbcb70-8ce6-4351-aefc-6fec81da6853"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS049-2-");

messageMap.setStringProperty("p1InBody", "false");
messageMap.setStringProperty("totalNumberOfPayloads", "2")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload1 = pay1.getBytes()
messageMap.setBytes("payload_1", payload1)
messageMap.setStringProperty("payload_2_mimeContentId", "cid:osattachment")
//messageMap.setStringProperty("payload_2_mimeType", "application/pdf")
String pay2 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload2 = pay2.getBytes()
messageMap.setBytes("payload_2", payload2)


domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="9e5ae279-68c9-4932-a67a-a604e3dec0a7"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test 2" id="bfddb373-3d2d-441d-a0b5-77bbf5d8bcc6"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS049-2-");
test.finalize();</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS049-");
test.finalize();
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>79d16b81-f2af-42dc-bac7-9f612c89790c</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>6164c7d4-d54a-4386-a077-9c8ecc7be02b</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase id="15b0c98d-537c-4c7c-a87b-316e6ea04945" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS050-Test Experience-Several payloads" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Submit Message" id="7690f466-2808-41b2-ad29-b6b09e8eb395"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS050-")
messageMap.setStringProperty("p1InBody", "false");
messageMap.setStringProperty("totalNumberOfPayloads", "2")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload1 = pay1.getBytes()
messageMap.setBytes("payload_1", payload1)
messageMap.setStringProperty("payload_2_mimeContentId", "cid:attachment")
messageMap.setStringProperty("payload_2_mimeType", "application/pdf")
messageMap.setStringProperty("payload_2_description", "message")
String pay2 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload2 = pay2.getBytes()
messageMap.setBytes("payload_2", payload2)
/*messageMap.setStringProperty("payload_3-mimeContentId", "cid:message")
messageMap.setStringProperty("payload_3-mimeType", "text/xml")
messageMap.setStringProperty("payload_3-description", "message")
String pay3 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload3 = pay3.getBytes()
messageMap.setBytes("payload_3", payload3);*/

domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="5188021e-8ccc-4f5e-9a2f-d06cd765b818"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS050-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS050-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/><con:reportParameters/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS051-Submit message-Tab and spaces" searchProperties="true" id="4421062c-c199-4464-a271-e43f7606f78c">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="853f2f01-a2c3-4e6d-a403-d523a0a74b21"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", " bdx:noprocess	")
messageMap.setStringProperty("serviceType", "  tc1")
messageMap.setStringProperty("action", "TC1Leg1		")
messageMap.setStringProperty("fromPartyId", "	domibus-blue ")
messageMap.setStringProperty("fromPartyType", " urn:oasis:names:tc:ebcore:partyid-type:unregistered	")
messageMap.setStringProperty("toPartyId", "   domibus-red ")
messageMap.setStringProperty("toPartyType", " urn:oasis:names:tc:ebcore:partyid-type:unregistered	")
messageMap.setStringProperty("fromRole", " http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator ")
messageMap.setStringProperty("toRole", "	http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder	")
messageMap.setStringProperty("originalSender", " urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1   ")
messageMap.setStringProperty("finalRecipient", "		urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS051-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "	cid:message	")
messageMap.setStringProperty("payload_1_mimeType", "	text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="3c777f72-3b83-48c8-a331-f86c76181ae8"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS051-", "", "110")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS051-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>1296a5b0-a2bc-4847-9b70-f896c3bc1ce2</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS056-EDELIVERY-3119-Issue with custom properties using JMS plugin" searchProperties="true" id="900baad0-4895-4a03-8f27-1d565e368d8b">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="fa0f77ad-8e19-4142-8644-d193960c2213"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS056-")
messageMap.setStringProperty("property_propWithoutType", "some value")
messageMap.setStringProperty("property_propWithType", "value")
messageMap.setStringProperty("propertyType_propWithType", "type")
messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="6dd9568c-5c0a-4409-9b6e-46664077e25e"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS056-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS056-")
test.finalize()

Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS057-Security Enabled-Incorrect password of plugin user" searchProperties="true" id="709787b4-48fc-43f8-8100-bd3baaddf3a2" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="9cec75df-d0cd-49d7-97a6-9dc21210c21a"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
def u = context.expand('${#Project#pluginAdminC2Default}')
def p = context.expand('${#Project#adminDefaultPassword}')
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap, u, p + "incorect" )

messageMap.setStringProperty("messageId", "-DomJMS057-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="ff472f51-9ccf-46ed-9b9d-4baffb16d1e0"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS057-")
test.finalize()</script></con:config></con:testStep><con:setupScript/><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS057-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS058-Security Enabled-Not existing plugin user" searchProperties="true" id="6062ab75-d206-4450-95d5-b22316f7cb80" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="99f2bfd9-c445-40a2-87b1-fb91d4907a67"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
def u = context.expand('${#Project#pluginAdminC2Default}')
def p = context.expand('${#Project#adminDefaultPassword}')
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap, u + "not existing", p)

messageMap.setStringProperty("messageId", "-DomJMS058-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="08faa1e3-3075-45c8-8f8c-26addaca3197"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS058-")
test.finalize()</script></con:config></con:testStep><con:setupScript/><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS058-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS059-Security Enabled-Authentication properties not provided" searchProperties="true" id="30e798b0-c308-4611-b434-b56aa47e30ce" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="66c2accd-6c1a-443a-8234-78eb0e37de0c"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
// Authentication information not added to message properties
// domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS058-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="cf800a70-cdc0-4dfa-8824-09f7f1b69f8b"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS059-")
test.finalize()</script></con:config></con:testStep><con:setupScript/><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS058-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS060-Submit Message-send larger payload" searchProperties="true" id="326bf820-f74e-42fb-b0f7-0c26cbb7df3e" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="d4e42707-c3b0-4069-b3e1-014b34dcb213"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS060-")

messageMap.setStringProperty("p1InBody", "false");
messageMap.setStringProperty("totalNumberOfPayloads", "2")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
//send the payload as a file system reference
messageMap.setStringProperty("payload_2_mimeContentId", "cid:attachment")
messageMap.setStringProperty("payload_2_mimeType", "application/pdf")
messageMap.setStringProperty("payload_2_description", "message")
def attachmentPath = context.expand("\${#Project#pdfAttachment}")
log.info "Try to use file from hard drive as attachment: ${attachmentPath}"
File file = new File(attachmentPath)
assert file.exists() : "Attachment/file not found"
assert file.canRead() : "Attachment/file cannot be read"

messageMap.setStringProperty("payload_2_fileName", file.getName())
messageMap.setString("payload_2", "file:////${attachmentPath}")

domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="7cf58528-4efc-42c6-9a24-0c3f75fded42"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS060-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS060-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS070-Submit Message-Basic Flow-PULL" searchProperties="true" id="016645a6-869e-4cbf-82ef-695aeef84a4d">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message" id="6ccbf3b6-a52d-4cd1-a9de-d5a162780070"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc13")
messageMap.setStringProperty("action", "TC13Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPull")
messageMap.setStringProperty("processingType", "PULL")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS070-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="556cfa37-9401-4a72-9f7c-c3a599616c45"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS070-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS070-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS073-Submit Message-File-Reference-File" searchProperties="true" id="ec961fdd-4eb9-4fbf-b156-e4e5c23a28c1" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message To C2" id="b05e67da-0a5b-40fc-bfe5-1a2875693bf5"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)


messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

messageMap.setStringProperty("messageId", "-DomJMS073-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")

def filePath=context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml"

messageMap.setStringProperty("payload_1","file:///"+context.expand('${#Project#pdfAttachment}'));
messageMap.setStringProperty("payload_1","file:///"+filePath);

domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="591c2fdc-acb9-44bd-8261-a5da9a63edd9"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS073-") 
test.finalize()
</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS073-")
test.finalize()

Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:properties/><con:setupScript>def unsecureLoginAllowed = context.expand('${#Project#unsecureLoginAllowed}')
def inputList = [ "DomJMS057", "DomJMS058", "DomJMS059"]

if (unsecureLoginAllowed == "true" || unsecureLoginAllowed == "1" || unsecureLoginAllowed == "y" || unsecureLoginAllowed == "yes") {
	log.info "As project property unsecureLoginAllowed value is: " + unsecureLoginAllowed + " try to disable test cases for authentication: ${inputList}"
	inputList.each { tcName ->
		def tcList = testSuite.testCaseList.findAll {it.name =~ /${tcName}/ }
		if (tcList.size() == 0) 	log.error "Incorrect name of test case for disabling: ${tcName}"
		else {
			tcList.each { tc ->
				if (!tc.isDisabled()) {
					log.warn "Disabling test case as includs authentication check: ${tc.name} "
					tc.setDisabled(true)
				}
			}
		}
	}
}

def superUser=context.expand('${#Project#superAdminUsername}')
def superPassword=context.expand('${#Project#superAdminPassword}')
// Select message filters for C2
Domibus.setMessageFilters("C2","Jms",context,log)
// Select message filters for C3
Domibus.setMessageFilters("C3","Jms",context,log)

log.info "====================================================="
log.info "Start waiting after setting Jms plugin for C2 and C3."
log.info "..."
sleep(90000)
log.info "End waiting after setting Jms plugin for C2 and C3."
log.info "====================================================="</con:setupScript><con:tearDownScript>def inputList = [ "DomJMS057", "DomJMS058", "DomJMS059"]

inputList.each { tcName ->
		def tcList = testSuite.testCaseList.findAll {it.name =~ /${tcName}/ }
		if (tcList.size() == 0) 	log.error "Incorrect name of test case for enabling: ${tcName}"
		else {
			tcList.each { tc ->
				if (tc.isDisabled()) {
					log.warn "Enable back test case as includs authentication check: ${tc.name} "
					tc.setDisabled(false)
				}
			}
		}
	}
</con:tearDownScript><con:reportParameters/></con:testSuite><con:testSuite id="5bf177a3-694b-457d-b488-66315a639714" name="JMS-oneway Push-Auto Not for Bamboo"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS003-Submit Message-Exceptional flow-No receipt" searchProperties="true" id="37d16dbb-586b-473e-9576-90f95a9dd15d">
            <con:settings/>












            <con:testStep type="groovy" name="Change blue Pmode to contains incorrect red endpoint" id="e8ee409f-166b-4362-a7ee-db30544e8ec3"><con:settings/><con:config><script>PModeUtils.uploadPmode("sender","special","/invalidEndpoint/domibus-pmode-blue-red_invalid.xml", context, log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="6c199260-07c5-4db9-8ef8-b556e09b77b9"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS003-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="a2a97523-57af-428e-ba68-68a268e82c0f"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("WAITING_FOR_RETRY",null,"-DomJMS003-")
test.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Revert - upload default blue Pmode" id="245f70c9-2663-4ae5-8bc5-32a27728588e" disabled="true"><con:settings/><con:config><script>PModeUtils.uploadPmode("sender","default","\\blue\\domibus-pmode-blue.xml",context,log)</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS003-")
test.finalize()
testRunner.testCase.testSteps['Revert - upload default blue Pmode'].run(testRunner, context)
Domibus.reportTestCaseCsv(testRunner, log)</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e4dc722a-da83-4d6d-9cf8-262dc58f0585</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d96c0d09-2b87-4cfa-a0dc-f96081c863ec</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS004-Submit message-Exceptional flow-retry max not reached" searchProperties="true" id="34d84553-3b69-4350-b882-f658f34bb9ae">
            <con:settings/>












            <con:testStep type="groovy" name="Change blue Pmode to contains incorrect red endpoint" id="990a5670-c355-41d6-a2d6-c663d2d6c776"><con:settings/><con:config><script>PModeUtils.uploadPmode("sender","special","/invalidEndpoint/domibus-pmode-blue-red_invalid.xml", context, log)
</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="797a2f12-5203-4b16-bf5e-dd2b32b70afe"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="43bc485f-2f0c-4dd5-bc06-e1d23c7245b1"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS004-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="dab2a930-5cd2-46dc-84c0-193d2460aa45"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("WAITING_FOR_RETRY",null,"-DomJMS004-")
test.verifyMessagePresence(1,0,"-DomJMS004-")
test.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Revert - upload default blue Pmode" id="b9418fc6-6074-4353-839a-2c89493b1893"><con:settings/><con:config><script>PModeUtils.uploadPmodeIfStepFailedOrNotRun(log, context, testRunner, "Revert - upload default blue Pmode", "Default blue Pmodes upload step for reuse")</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="2e3de2bf-0ae1-41ec-b361-deb82cd475c6"><con:settings/><con:config><delay>3000</delay></con:config></con:testStep><con:testStep type="groovy" name="Check message submitted" id="1a69ab9a-fc2d-4258-9142-cbcd0c2c4201"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS004-","Long")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS004-")
test.finalize()

testRunner.testCase.testSteps['Revert - upload default blue Pmode'].run(testRunner, context)
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>9c6f08d0-5ce3-4757-b59f-44bb1b1640b3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>0a2b3efa-6626-42cd-bf6a-1b83dd688944</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS052-Test Experience-Truststore Update" searchProperties="true" id="a43365d3-5ced-4786-a717-d9dd6042b26c">
            <con:settings/>












            <con:testStep type="groovy" name="Upload unsuitable truststore Blue" id="e4c0f7ff-ff3f-415d-8b2b-fadf7529030c"><con:settings/><con:config><script>// Upload unsuitable truststore to blue.
TruststoreUtils.uploadTruststore("sender","special","/DynamicDiscovery/C2/oasis/gateway_truststore.jks",context,log)


</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="a2d65ffb-9fdb-405d-8525-d3b7dab5709a"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 1" id="a23e0478-e68e-4f36-8311-a5529aeb515c"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS052-1-")
messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="b8bfd653-e3fa-427a-826f-facdfeff18e4"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test" id="ff7c06c1-9b61-44c2-bf42-8d2d215c1ed0"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("WAITING_FOR_RETRY",null,"-DomJMS052-1-")
test.verifyMessagePresence(1,0,"-DomJMS052-1-")
test.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D3" id="963365e3-361f-4d63-ab54-3fe71daef886"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Restore Truststore" id="49bbe55e-c3de-4f2b-bf82-bf10017907d2"><con:settings/><con:config><script>// Upload default truststore for blue.
TruststoreUtils.uploadTruststore("sender","default","\\blue\\gateway_truststore.jks",context,log)
</script></con:config></con:testStep><con:testStep type="delay" name="D4" id="90e17fde-0b22-4b43-be17-fe81104370ff"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="cf4aa1aa-86d1-4a62-8df6-37383d08ae7b"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS052-2-")
messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D5" id="9c329773-def0-41b9-b8a6-951cc0943891"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test good truststore" id="03ac61a9-91d3-448a-9526-58beb1ca9dc5"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS052-2-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS052-")
test.finalize()
testRunner.testCase.testSteps['Restore Truststore'].run(testRunner, context)
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>cd8b9098-8fbd-42a9-8eb7-67404b5f59dd</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>906220c2-8277-4fcb-a3bd-f15306888b25</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>53c0a958-b619-493b-b45b-7b9d7ecf4e43</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e138bc36-5999-4555-b848-c445b16888f9</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>bed6d5e9-a752-4924-85f2-7d968b646bac</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS054-Manual-EDELIVERY-1684-Message Id should always be present in the messages sent" searchProperties="true" id="28fb23f3-6d9c-4876-9e45-b6c7dce9590d">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="b16a6853-1fb2-4db3-9cc6-5aaf4570e0ff"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS054-")
messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="3261b47e-24a2-491d-8512-1f65085ede3c"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS054-"); // intentionally send second message with same ID the message should end in [internal] domibus.DLQ queue

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test msg present" id="abd9d3d2-786e-47b0-b310-1962970ef5e9"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS054-")
test.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="Wait for failure" id="8e757a04-9580-4357-860e-7c9ee5563a8d"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Check jms reply queue" id="27a74880-bd81-4832-bb21-9c7537052806"><con:settings/><con:config><script>Domibus.SearchMessageJmsQueue("C2", context, log,"-DomJMS054-","Message with id [-DomJMS054-] already exists","domibus.backend.jms.replyQueue")
</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS054-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>90414ed1-d501-45a8-86b6-466a1352735c</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>cd8b9098-8fbd-42a9-8eb7-67404b5f59dd</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>906220c2-8277-4fcb-a3bd-f15306888b25</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>53c0a958-b619-493b-b45b-7b9d7ecf4e43</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e138bc36-5999-4555-b848-c445b16888f9</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase id="3ac4b5b1-96fb-4b46-be20-e88131c571fb" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS061-EDELIVERY-4238-Push-Payload inside body" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Save Current CXF log level" id="83f6ac26-715d-4a0e-8793-e71fb5bc14bc"><con:settings/><con:config><script>def custPropName="org.apache.cxf";

// Get Domibus package log level
def propValue=Domibus.getLogLevel("C2",context,log,custPropName);
// Set test case custom property
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);



</script></con:config></con:testStep><con:testStep type="groovy" name="Set CXF log Level to info" id="6d15329d-fcb3-4258-803b-cd3cad077371"><con:settings/><con:config><script>Domibus.setLogLevel("C2",context,log,"org.apache.cxf","INFO");
</script></con:config></con:testStep><con:testStep type="groovy" name="Set logs starting line number C2 - Bodyload" id="1aadda10-1233-454a-978e-81a8d863d016"><con:settings/><con:config><script> Domibus.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)

</script></con:config></con:testStep><con:testStep type="groovy" name="Submit message Jms" id="41123cf2-3283-4d02-87e6-bc3dfc3bafc2"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

	messageMap.setStringProperty("messageType", "submitMessage")
	messageMap.setStringProperty("service", "bdx:noprocess")
     messageMap.setStringProperty("serviceType", "tc24")
	messageMap.setStringProperty("action", "TC24Leg1")
     messageMap.setStringProperty("conversationId", "123")
     messageMap.setStringProperty("fromPartyId", "domibus-blue")
     messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered");
     messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
     messageMap.setStringProperty("toPartyId", "domibus-red")
     messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered");
	messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
	messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1");
	messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
	messageMap.setStringProperty("protocol", "AS4")
	messageMap.setJMSCorrelationID("12345")
	messageMap.setStringProperty("messageId", "-DomJMS061-")

	//Set up the payload properties
     messageMap.setStringProperty("totalNumberOfPayloads", "1")
	messageMap.setStringProperty("payload_1_mimeType", "text/xml")
	messageMap.setStringProperty("payload_1_description", "message")
	messageMap.setStringProperty("p1InBody", "true");

	//send the payload in the JMS message as byte array
	//String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
	String pay1 = "&lt;test>test&lt;/test>";
	byte[] payload = pay1.getBytes()
	messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test Messaged exchange success" id="74ead7d0-7cf2-4aee-9fee-4fd2c34146b4"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS061-")
test.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Verify Logs - Bodyload" id="f823b94d-6690-43b2-9b37-537c22b61923"><con:settings/><con:config><script>
// Check the log file of C2
def logValueList =  ["Content-Type: multipart/related"];
Domibus.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner, false);</script></con:config></con:testStep><con:testStep type="groovy" name="Reset Current log level" id="bdc5fe27-d908-42fd-a50a-3144c8511ea8" disabled="true"><con:settings/><con:config><script>def custPropName="org.apache.cxf";

// C2
def propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
// Reset log level value
Domibus.setLogLevel("C2",context,log,custPropName,propValue);
sleep(2000);




</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context);
test.cleanDBMessageIDStartsWith("-DomJMS061-")
test.finalize();

testRunner.testCase.testSteps['Reset Current log level'].run(testRunner, context);
Domibus.reportTestCaseCsv(testRunner, log)</con:tearDownScript><con:properties><con:property><con:name>org.apache.cxf</con:name><con:value>WARN</con:value></con:property><con:property><con:name>skipNumberOfLines</con:name><con:value>1363</con:value></con:property></con:properties><con:reportParameters/><con:breakPoints><con:testStepId>32187c3e-10a4-4f74-bb76-0024b1cf6dc0</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase id="36008068-3089-437b-be98-0d3143c8ffe0" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS062-Payload size" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Update PMode Blue lt payload size" id="dd093b99-33db-4dba-9e33-2a70ac745779"><con:settings/><con:config><script>import java.nio.file.Paths

def currentValue=['2147483647'];
def newValue=['79'];
def filePath=Paths.get(context.expand('${#Project#defaultPModesPath}'),"/blue/domibus-pmode-blue.xml").toUri();
def newFileSuffix="_someSuffix.xml";

PModeUtils.updatePmodeParameter(log, context, testRunner,currentValue,newValue,filePath, newFileSuffix);
PModeUtils.uploadPmode("sender","default","\\blue\\domibus-pmode-blue.xml"+newFileSuffix,context,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filter to Jms for Blue and Red" id="64b4f02f-64bb-4961-a939-e7d738ff2469"><con:settings/><con:config><script>Domibus.setMessageFilters("sender","Jms",context,log)
Domibus.setMessageFilters("receiver","Jms",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Set logs starting line number C2" id="474eb96c-48c2-45ba-84e8-150f96ebd052"><con:settings/><con:config><script> Domibus.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)</script></con:config></con:testStep><con:testStep type="groovy" name="Submit message Jms 1" id="872c2b49-836c-4878-b011-e8114879f52f"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

	messageMap.setStringProperty("messageType", "submitMessage")
	messageMap.setStringProperty("service", "bdx:noprocess")
     messageMap.setStringProperty("serviceType", "tc24")
	messageMap.setStringProperty("action", "TC24Leg1")
     messageMap.setStringProperty("conversationId", "123")
     messageMap.setStringProperty("fromPartyId", "domibus-blue")
     messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered");
     messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
     messageMap.setStringProperty("toPartyId", "domibus-red")
     messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered");
	messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
	messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1");
	messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
	messageMap.setStringProperty("protocol", "AS4")
	messageMap.setJMSCorrelationID("12345")

	//Set up the payload properties
     messageMap.setStringProperty("totalNumberOfPayloads", "3")
	messageMap.setStringProperty("payload_1_mimeType", "text/xml")
	messageMap.setStringProperty("payload_1_description", "message")
	messageMap.setStringProperty("p1InBody", "true");
	messageMap.setStringProperty("messageId", "-Jms062-1-")

	//send the payload in the JMS message as byte array
	//String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
	String pay1 = "&lt;test>test&lt;/test>";
	byte[] payload = pay1.getBytes()
	messageMap.setBytes("payload_1", payload)

messageMap.setStringProperty("payload_2_mimeContentId", "cid:attachment")
messageMap.setStringProperty("payload_2_mimeType", "application/pdf")
messageMap.setStringProperty("payload_2_description", "message")
String pay2 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4="
byte[] payload2 = pay2.getBytes()
messageMap.setBytes("payload_2", payload2)

domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Check sender log file C2" id="a4085cfe-2032-4e52-9215-b7590be5b469"><con:settings/><con:config><script>def logValueList =  ["Payload size.*is greater than.*maximum value.*"];
Domibus.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner);</script></con:config></con:testStep><con:testStep type="groovy" name="Update PMode Blue gt payload size" id="3c61f625-056f-40d5-80ec-ee65a2a78dfb"><con:settings/><con:config><script>import java.nio.file.Paths

def currentValue=['2147483647'];
def newValue=['81'];
def filePath=Paths.get(context.expand('${#Project#defaultPModesPath}'),"/blue/domibus-pmode-blue.xml").toUri();
def newFileSuffix="_someSuffix.xml";

PModeUtils.updatePmodeParameter(log, context, testRunner,currentValue,newValue,filePath, newFileSuffix);
PModeUtils.uploadPmode("sender","default","\\blue\\domibus-pmode-blue.xml"+newFileSuffix,context,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Submit message Jms 2" id="67c2e75e-65a4-455b-9050-8950ab703b72"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

	messageMap.setStringProperty("messageType", "submitMessage")
	messageMap.setStringProperty("service", "bdx:noprocess")
     messageMap.setStringProperty("serviceType", "tc24")
	messageMap.setStringProperty("action", "TC24Leg1")
     messageMap.setStringProperty("conversationId", "123")
     messageMap.setStringProperty("fromPartyId", "domibus-blue")
     messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered");
     messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
     messageMap.setStringProperty("toPartyId", "domibus-red")
     messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered");
	messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
	messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1");
	messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
	messageMap.setStringProperty("protocol", "AS4")
	messageMap.setJMSCorrelationID("12345")

	//Set up the payload properties
     messageMap.setStringProperty("totalNumberOfPayloads", "3")
	messageMap.setStringProperty("payload_1_mimeType", "text/xml")
	messageMap.setStringProperty("payload_1_description", "message")
	messageMap.setStringProperty("p1InBody", "true");
	messageMap.setStringProperty("messageId", "-Jms062-2-")

	//send the payload in the JMS message as byte array
	//String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
	String pay1 = "&lt;test>test&lt;/test>";
	byte[] payload = pay1.getBytes()
	messageMap.setBytes("payload_1", payload)

messageMap.setStringProperty("payload_2_mimeContentId", "cid:attachment")
messageMap.setStringProperty("payload_2_mimeType", "application/pdf")
messageMap.setStringProperty("payload_2_description", "message")
String pay2 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4="
byte[] payload2 = pay2.getBytes()
messageMap.setBytes("payload_2", payload2)

domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test Success" id="faa46e06-9dbd-41f4-be24-5a93a320f986"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-Jms062-2-")
test.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Upload default PModes Blue-Red" id="99184407-6a5f-48e2-bf56-4f9a5d8ab409" disabled="true"><con:settings/><con:config><script>// Upload PModes: default Pmodes (blue for sender and red for receiver)
PModeUtils.uploadPmode("sender","default","\\blue\\domibus-pmode-blue.xml",context,log);
PModeUtils.uploadPmode("receiver","default","\\red\\domibus-pmode-red.xml",context,log);</script></con:config></con:testStep><con:tearDownScript>testRunner.testCase.testSteps['Upload default PModes Blue-Red'].run(testRunner, context);

Domibus.reportTestCaseCsv(testRunner, log)</con:tearDownScript><con:properties><con:property><con:name>skipNumberOfLines</con:name><con:value>40091</con:value></con:property></con:properties><con:reportParameters/><con:breakPoints><con:testStepId>32187c3e-10a4-4f74-bb76-0024b1cf6dc0</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS063-Submit message-Exceptional flow-Data-Message ID-Maximum length" searchProperties="true" id="1765e2c9-40de-4874-9d0e-aa5e28a22f5d">
            <con:settings/>












            <con:testStep type="groovy" name="Set logs starting line number" id="3b921566-b8df-4427-bbf5-1d9a58c75edb"><con:settings/><con:config><script> Domibus.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="31eb7d70-2486-4c28-906a-809f6ec6fe27"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="e87bc20c-c99e-434e-9d3d-77aca8ddbb24"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-Length-256-aabbcceeffaaaaaa012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-0123456789012345678901234567890123456789012-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="6885a854-dcc7-4d3d-af53-0e505647d8eb"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test" id="828926cd-f7c0-47ce-b47b-9b0c20f2e326"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-Length-256-aabbcceeffaaaaaa012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-0123456789012345678901234567890123456789012-");
test.finalize();</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="ed3cb73b-228f-4e2c-a67a-459c131e4781"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Check sender log file" id="4883488d-30ec-4352-a461-230fd0ae17aa"><con:settings/><con:config><script>def logValueList =  ["EbMS3Exception: Value of MessageId is too long"];
Domibus.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner);</script></con:config></con:testStep><con:tearDownScript>
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties><con:property><con:name>skipNumberOfLines</con:name><con:value>1016</con:value></con:property></con:properties>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS064-Submit message-Exceptional flow-Data-RefToMessageId-Maximum length" searchProperties="true" id="3c46e9ee-d2c7-4082-929b-2437dc2a0b27">
            <con:settings/>












            <con:testStep type="groovy" name="Set logs starting line number" id="5faf9010-3e31-42ed-a7b4-29468b8aa384"><con:settings/><con:config><script> Domibus.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="e7d3972a-2fba-4f60-a6ec-5e06a08b0f0a"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="855b9cfd-5ae4-4ccc-976d-7c0f8d44639e"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS064-");
messageMap.setStringProperty("refToMessageId", "-Length-256-aabbcceeffaaaaaa012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-0123456789012345678901234567890123456789012-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="8d2e7e28-02a2-4a79-870b-63a4ed17aa7c"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test" id="c0881239-fe6f-4ff5-a106-ca2f59cceb8b"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS064-");
test.finalize();</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="a11034a0-395c-4e47-8b5b-1080916514a7"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Check sender log file" id="cb2a597a-e44b-4f8f-b37b-feb1ccfc57bd"><con:settings/><con:config><script>def logValueList =  ["EbMS3Exception: RefToMessageId value is too long"];
Domibus.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner);</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS064-");
test.finalize();
Domibus.reportTestCaseCsv(testRunner, log);
</con:tearDownScript><con:properties><con:property><con:name>skipNumberOfLines</con:name><con:value>908</con:value></con:property></con:properties>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS065-Submit message-Exceptional flow-Data-AgreementRefId-Maximum Length" searchProperties="true" id="5f8e82eb-8a2e-4f99-9837-b3b9bd995cb0">
            <con:settings/>












            <con:testStep type="groovy" name="Set logs starting line number 1" id="0288aa8d-19a9-45f6-938d-a3ac2cc97b5b"><con:settings/><con:config><script> Domibus.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="38d986c7-e718-485e-ae84-d3f875b817c2"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 1" id="36330cf3-60c5-4321-9a2b-b699bb65df03"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS065-1-");
messageMap.setStringProperty("agreementRef", "-Length-256-aabbcceeffaaaaaa012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-0123456789012345678901234567890123456789012-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="912d527c-b58c-4922-a66d-7ff1483eefb1"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test 1" id="e846b863-4f09-4e64-a411-56a9ac4cca9b"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS065-1-");
test.finalize();</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="305e3c0f-330d-4360-a5e2-b74d419d4bd7"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Check sender log file 1" id="68e3b1fe-1044-4243-8256-cc7ca572f41d"><con:settings/><con:config><script>def logValueList =  [" AgreementRef Value is too long"];
Domibus.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner);</script></con:config></con:testStep><con:testStep type="delay" name="D3" id="3f6aa493-a7d9-45f6-8285-22d827ce7d13"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Set logs starting line number 2" id="03d3a666-c6c2-4e00-8947-723d6c800c0b"><con:settings/><con:config><script> Domibus.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)</script></con:config></con:testStep><con:testStep type="delay" name="D4" id="09bbf457-fa81-4a47-b9bf-d43fcc4c3e76"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="3ab5d902-c707-42e0-90c2-6f43842fcde2"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc4")
messageMap.setStringProperty("action", "TC4Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS065-2-");
messageMap.setStringProperty("agreementRef", "-Length-256-aabbcceeffaaaaaa012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-0123456789012345678901234567890123456789012-");


messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D5" id="42c2f708-9ddf-4f5b-94ee-4427ae65c815"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test 2" id="365e15b8-1b18-4317-9883-6b30dd2aa736"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS065-2-");
test.finalize();</script></con:config></con:testStep><con:testStep type="delay" name="D6" id="a4aeb795-5bf8-4386-9d3e-e512a8401c43"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Check sender log file 2" id="40e821fb-ae7c-4611-88e5-1cfa956f4ec9"><con:settings/><con:config><script>def logValueList =  ["AgreementRef Value is too long"];
Domibus.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner);</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS065-");
test.finalize();
Domibus.reportTestCaseCsv(testRunner, log);
</con:tearDownScript><con:properties><con:property><con:name>skipNumberOfLines</con:name><con:value>95935</con:value></con:property></con:properties>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS066-Submit message-Exceptional flow-Data-ConversationId-Maximum Length" searchProperties="true" id="1b6bcdb8-b957-403c-bc7e-27ae4c684b15">
            <con:settings/>












            <con:testStep type="groovy" name="Set logs starting line number" id="463a4d36-84bc-4566-8e6f-d4e2b731c7fe"><con:settings/><con:config><script> Domibus.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="743051e3-bc28-49b2-b2c8-ffcf1be1679e"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="2579285e-8e11-4ae3-a178-1e6c7f7368f3"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS066-");
messageMap.setStringProperty("conversationId", "-Length-256-aabbcceeffaaaaaa012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-0123456789012345678901234567890123456789012-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="24e0736c-36e4-4d06-ba01-6f94ced1729c"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test" id="87f12239-777a-4870-b3af-69021813166b"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS066-");
test.finalize();</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="c4f0bfd5-1743-477b-819f-e1812cf33313"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Check sender log file" id="0c829260-a7de-4822-890a-2ff5f1cdfff5"><con:settings/><con:config><script>def logValueList =  ["EbMS3Exception: ConversationId is too long"];
Domibus.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner);</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS066-");
test.finalize();
Domibus.reportTestCaseCsv(testRunner, log);
</con:tearDownScript><con:properties><con:property><con:name>skipNumberOfLines</con:name><con:value>1045</con:value></con:property></con:properties>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS067-Submit message-Exceptional flow-Data-Original Sender-Maximum length" searchProperties="true" id="20f06f01-ab81-4c19-b81a-87e1abcbe16c">
            <con:settings/>












            <con:testStep type="groovy" name="Set logs starting line number" id="85652712-d90a-4144-bae8-94e64d89f9a6"><con:settings/><con:config><script> Domibus.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="38b2a173-d03f-4948-9f1a-9920f2ef58be"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="07d6f0da-9145-46c9-ade0-1e44898981b7"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "length-1025-123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-012345678901234567890123456789012345678901234length-1025-123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-012345678901234567890123456789012345678901234length-1025-123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-012345678901234567890123456789012345678901234length-1025-123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-0123456789012345678901234567890123456789012341234567898765432123456789")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS067-");

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="ede5228c-738e-4364-b31a-079f91da0127"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test" id="e5844a7c-8c5c-4900-94fc-3f5f68619e86"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS067-");
test.finalize();</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="191df84f-d2b3-4c98-8b13-4eb9c7eeeca2"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Check sender log file" id="f6bfa2f6-4008-4d67-ad92-024c17f4c4d1"><con:settings/><con:config><script>def logValueList =  ["EbMS3Exception: originalSender property has a value which exceeds 1024 characters"];
Domibus.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner);</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS067-");
test.finalize();
Domibus.reportTestCaseCsv(testRunner, log);
</con:tearDownScript><con:properties><con:property><con:name>skipNumberOfLines</con:name><con:value>1859</con:value></con:property></con:properties>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS068-Submit message-Exceptional flow-Data-Final Receiver-Maximum length" searchProperties="true" id="bd85970c-a23e-41c8-9c0a-704937c2038a">
            <con:settings/>












            <con:testStep type="groovy" name="Set logs starting line number" id="900a6079-3711-4cd8-8a0d-ac8585750546"><con:settings/><con:config><script> Domibus.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="35c267be-2019-4b05-bdfd-35a3fa051d8b"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="75ba5e88-4305-4595-9750-ecae7e556b4f"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "length-1025-123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-012345678901234567890123456789012345678901234length-1025-123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-012345678901234567890123456789012345678901234length-1025-123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-012345678901234567890123456789012345678901234length-1025-123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-01234567890123456789012345678901234567890123456789-0123456789012345678901234567890123456789012341234567898765432123456789")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

// Optional
messageMap.setStringProperty("messageId", "-DomJMS068-");

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="d3d53ec1-f930-4c50-a741-7a5ae2c70c31"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Test" id="642a8e09-a011-49e5-8d29-c889c7026a1d"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(0,0,"-DomJMS068-");
test.finalize();</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="eae8f85c-1ce1-411a-bed3-ed289301a50b"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Check sender log file" id="49429465-2511-4d33-8c7d-c9d757d57e42"><con:settings/><con:config><script>def logValueList =  ["EbMS3Exception: finalRecipient property has a value which exceeds 1024 characters"];
Domibus.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner);</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS068-");
test.finalize();
Domibus.reportTestCaseCsv(testRunner, log);
</con:tearDownScript><con:properties><con:property><con:name>skipNumberOfLines</con:name><con:value>2666</con:value></con:property></con:properties>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS071-EDELIVERY-8933-Possibility to reference the payloads via a REST endpoint" searchProperties="true" id="7c24fe65-9e3c-4454-b29b-8a9d0c7f4152">
            <con:settings/>












            <con:testStep type="groovy" name="Save properties values" id="ade8fe82-6330-4536-b358-013c9fb004ca"><con:settings/><con:config><script>// C3
// jmsplugin.putAttachmentInQueue
def custPropName="jmsplugin.putAttachmentInQueue";
def propValue=Domibus.getPropertyAtRuntime("C3",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);

// jmsplugin.attachment.reference.type
custPropName="jmsplugin.attachment.reference.type";
propValue=Domibus.getPropertyAtRuntime("C3",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);

// domibus.attachment.storage.location
custPropName="domibus.attachment.storage.location";
propValue=Domibus.getPropertyAtRuntime("C3",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);

// jmsplugin.attachment.reference.context
custPropName="jmsplugin.attachment.reference.context";
propValue=Domibus.getPropertyAtRuntime("C3",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);

// jmsplugin.attachment.reference.url
custPropName="jmsplugin.attachment.reference.url";
propValue=Domibus.getPropertyAtRuntime("C3",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);

// Wait
sleep(3000)</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="0f9e975b-2360-4bc4-a321-267ca8a0d949"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Update props-Attach in Q-referencetype File-Storage DB-C3" id="a4238b98-a85a-4eb2-8892-ba06031eaf5b"><con:settings/><con:config><script>Domibus.changePropertyAtRuntime("C3", "jmsplugin.putAttachmentInQueue", "true", context, log);

Domibus.changePropertyAtRuntime("C3", "jmsplugin.attachment.reference.type", "FILE", context, log);

Domibus.changePropertyAtRuntime("C3", "domibus.attachment.storage.location", " ", context, log);

//Domibus.changePropertyAtRuntime("C3", "jmsplugin.attachment.reference.context", " ", context, log);

//Domibus.changePropertyAtRuntime("C3", "jmsplugin.attachment.reference.url", " ", context, log);

sleep(3000);</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message-1" id="b1e3f372-4fe6-4c36-9042-00b7747f3723"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc11")
messageMap.setStringProperty("action", "TC11Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushShortRetention")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS071-1-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test-1" id="16801a8e-b50b-4c76-9e5b-2b64b779aa33"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS071-1-")
test.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="ed350395-1165-416a-bc97-ce07b502ac66"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Update props-Attach in Q-referencetype URL-Storage DB-C3" id="95cc2d74-ab53-4ab0-bb5a-59acbf2701fd"><con:settings/><con:config><script>Domibus.changePropertyAtRuntime("C3", "jmsplugin.putAttachmentInQueue", "true", context, log);

Domibus.changePropertyAtRuntime("C3", "jmsplugin.attachment.reference.type", "URL", context, log);

sleep(3000);</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message-2" id="106db16d-66e0-4d20-a7ba-9c727f165135"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc11")
messageMap.setStringProperty("action", "TC11Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushShortRetention")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS071-2-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test-2" id="79303df5-b4df-4881-9da4-2af9d3872f2e"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS071-2-")
test.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="d6d5c21a-f3bf-460e-85d6-864e415899b9"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Update props-Attach not in Q-referencetype URL-Storage DB-C3" id="168aac69-a0ca-47b4-931c-d86e38a574f7"><con:settings/><con:config><script>Domibus.changePropertyAtRuntime("C3", "jmsplugin.putAttachmentInQueue", "false", context, log);

Domibus.changePropertyAtRuntime("C3", "jmsplugin.attachment.reference.type", "URL", context, log);

sleep(3000);</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message-3" id="d18f171f-af1b-466b-ad5e-4a0d9e2a0dd9"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc11")
messageMap.setStringProperty("action", "TC11Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushShortRetention")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS071-3-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test-3" id="9a735c11-5c4c-4223-8925-b97bd7653d01"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS071-3-")
test.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D3" id="9f8a20d5-f0a3-4977-b09e-133b20503a34"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Update props-Attach not in Q-referencetype FILE-Storage DB-C3" id="35ffb77c-530f-4ed8-a2f1-d8c9054af4c2"><con:settings/><con:config><script>Domibus.changePropertyAtRuntime("C3", "jmsplugin.putAttachmentInQueue", "false", context, log);

Domibus.changePropertyAtRuntime("C3", "jmsplugin.attachment.reference.type", "FILE", context, log);

sleep(3000);</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message-4" id="1d5ac507-b2ac-4046-8467-0034a1fb0941"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc11")
messageMap.setStringProperty("action", "TC11Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushShortRetention")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS071-4-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test-4" id="b8e4fd22-89ae-43d2-99f0-0c9849975a49"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS071-4-")
test.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D4" id="c8758ae9-1e08-4166-884d-863ad90a964e"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Update props-Attach not in Q-referencetype FILE-Storage FS-C3" id="06dd64d6-2193-42e0-86ea-fc444102e171"><con:settings/><con:config><script>def storagePath=context.expand('${#Project#pathRed}')+"payloads"

Domibus.changePropertyAtRuntime("C3", "domibus.attachment.storage.location", storagePath, context, log);

Domibus.changePropertyAtRuntime("C3", "jmsplugin.putAttachmentInQueue", "false", context, log);

Domibus.changePropertyAtRuntime("C3", "jmsplugin.attachment.reference.type", "FILE", context, log);

sleep(3000);</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message-5" id="07e91455-d872-4f7c-a25e-37892f3d23c6"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc11")
messageMap.setStringProperty("action", "TC11Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushShortRetention")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS071-5-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test-5" id="8a0b516a-ac3b-40bd-84cc-958b1b5d4113"><con:settings/><con:config><script>def entityID=null
def messageID="-DomJMS071-5-"
  
def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED",messageID)
entityID=test.retrieveMessageEntityID(messageID,"C3")
test.finalize()


def side="c3"
def searchKey=messageID
def endpointUrl=context.expand('${#Project#remoteUrl}')
def pattern="payload_1_fileURL#$endpointUrl/ext/messages/ids/$entityID/payloads/message"
def queueName="domibus.backend.jms.outQueue"
def outcome=false
def domainValue="Default"

Domibus.SearchMessageJmsQueue(side, context, log,searchKey,pattern,queueName, outcome,domainValue)
log.info "--------------------------------------------------------------------------"
log.info "--------------------------------------------------------------------------"
log.info "--------------------------------------------------------------------------"
log.info "--------------------------------------------------------------------------"
outcome=true
pattern="payload_1_fileName#.*payload"
Domibus.SearchMessageJmsQueue(side, context, log,searchKey,pattern,queueName, outcome,domainValue)
log.info "--------------------------------------------------------------------------"
log.info "--------------------------------------------------------------------------"
log.info "--------------------------------------------------------------------------"
log.info "--------------------------------------------------------------------------"
log.info "DONE !"</script></con:config></con:testStep><con:testStep type="delay" name="D5" id="d83bc0f5-89f4-4b82-9846-a09707bd806f"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Update props-Attach not in Q-Set URL context and reference-C3" id="bbab8759-0419-431f-9034-615651ef598f"><con:settings/><con:config><script>def storagePath=context.expand('${#Project#pathRed}')+"payloads"
Domibus.changePropertyAtRuntime("C3", "domibus.attachment.storage.location", storagePath, context, log);

Domibus.changePropertyAtRuntime("C3", "jmsplugin.putAttachmentInQueue", "false", context, log);

Domibus.changePropertyAtRuntime("C3", "jmsplugin.attachment.reference.type", "URL", context, log);

//Domibus.changePropertyAtRuntime("C3", "jmsplugin.attachment.reference.context", "http://localhost:8180/domibus", context, log);

//Domibus.changePropertyAtRuntime("C3", "jmsplugin.attachment.reference.url", "/ext/messages/ids/MESSAGE_ENTITY_ID/payloads/PAYLOAD_CID", context, log);

sleep(3000);</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message-9" id="5cd0c97e-f93e-4998-92e8-6f4a8f234551"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc11")
messageMap.setStringProperty("action", "TC11Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushShortRetention")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS071-9-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test-9" id="45c8692a-f09f-4061-af9e-6e46d4ab274a"><con:settings/><con:config><script>def entityID=null
def messageID="-DomJMS071-9-"
  
def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED",messageID)
entityID=test.retrieveMessageEntityID(messageID,"C3")
test.finalize()


def side="c3"
def searchKey=messageID
def endpointUrl=context.expand('${#Project#remoteUrl}')
def pattern="payload_1_fileURL#$endpointUrl/ext/messages/ids/$entityID/payloads/message"
def queueName="domibus.backend.jms.outQueue"
def outcome=true
def domainValue="Default"

Domibus.SearchMessageJmsQueue(side, context, log,searchKey,pattern,queueName, outcome,domainValue)</script></con:config></con:testStep><con:testStep type="delay" name="D6" id="cbb51375-1665-4e57-a3bb-69e155a9a68d"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="07ad2735-25d9-4d44-b46e-71bad30da229"><con:settings/><con:config><script>def pluginUser=null
def pluginPassword="DomibusEdel-12345"
def originalUser="urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4"
def userRole="ROLE_USER"
def domain="Default"
def site="C3"


// Create standard user 1 C3
pluginUser="userPlOUC4"+(new Date().format("ddHHmmss"))
testRunner.testCase.setPropertyValue( "usernameC4",pluginUser);
Domibus.addPluginUser(site,context,log,domain,userRole,pluginUser,pluginPassword,originalUser);

// Create standard user 2 C3
pluginUser="userPlOUC1"+(new Date().format("ddHHmmss"))
originalUser="urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1"
testRunner.testCase.setPropertyValue( "usernameC1",pluginUser);
Domibus.addPluginUser(site,context,log,domain,userRole,pluginUser,pluginPassword,originalUser);

// Create admin user C3
userRole="ROLE_ADMIN"
originalUser=null
pluginUser="userPlAdmin"+(new Date().format("ddHHmmss"))
testRunner.testCase.setPropertyValue( "adminUsername",pluginUser);
Domibus.addPluginUser(site,context,log,domain,userRole,pluginUser,pluginPassword,originalUser);

</script></con:config></con:testStep><con:testStep type="delay" name="D7" id="80289d14-c635-479c-b82a-dd851a15ddfd"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Download-Payload-EntityID-Success-UserC4" id="9dffa653-a5bf-4819-ab4a-fa981243bff4"><con:settings/><con:config><script>def side="c3"
def status="success"
def messageID="-DomJMS071-9-"
def messageCID="message"
def entityID=null
def pluginUser=testRunner.testCase.getPropertyValue("usernameC4");
def pluginPassword="DomibusEdel-12345"
def message="PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4="


def test = new Domibus(log,null,context)
entityID=test.retrieveMessageEntityID(messageID,"C3")
test.finalize()



ExtRestUtils.testDownloadPayloadEntityIDRequest(log,context,side, status, entityID, messageCID, pluginUser, pluginPassword, message)</script></con:config></con:testStep><con:testStep type="delay" name="D8" id="84f9abdc-b548-445a-b5c6-66f45de6ed9d"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Download-Payload-EntityID-Success-Admin" id="2bfe7f10-23ba-46d9-bf1d-05270d408312"><con:settings/><con:config><script>def side="c3"
def status="success"
def messageID="-DomJMS071-9-"
def messageCID="message"
def entityID=null
def pluginUser=testRunner.testCase.getPropertyValue("adminUsername");
def pluginPassword="DomibusEdel-12345"
def message=null


def test = new Domibus(log,null,context)
entityID=test.retrieveMessageEntityID(messageID)
test.finalize()



ExtRestUtils.testDownloadPayloadEntityIDRequest(log,context,side, status, entityID, messageCID, pluginUser, pluginPassword, message)</script></con:config></con:testStep><con:testStep type="delay" name="D9" id="1c733f10-065d-4078-b258-c4bfab09c665"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Download-Payload-EntityID-Failure-UserC1" id="9bc3da11-5ccd-4d1b-9b12-84ea78f9c6ad"><con:settings/><con:config><script>def side="c3"
def status="unauthorized"
def messageID="-DomJMS071-9-"
def messageCID="message"
def entityID=null
def pluginUser=testRunner.testCase.getPropertyValue("usernameC1");
def pluginPassword="DomibusEdel-12345"
def message=null


def test = new Domibus(log,null,context)
entityID=test.retrieveMessageEntityID(messageID)
test.finalize()



ExtRestUtils.testDownloadPayloadEntityIDRequest(log,context,side, status, entityID, messageCID, pluginUser, pluginPassword, message)</script></con:config></con:testStep><con:testStep type="delay" name="D10" id="dddbf792-9688-4b7c-bd51-d4bbfa5e968d"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Download-Payload-EntityID-Failure-Wrong password" id="94ffb1e3-ecb9-4b9c-b16d-98220ba548e5"><con:settings/><con:config><script>def side="c3"
def status="unauthorized"
def messageID="-DomJMS071-9-"
def messageCID="message"
def entityID=null
def pluginUser=testRunner.testCase.getPropertyValue("usernameC4");
def pluginPassword="DomibusEdel-12"
def message=null


def test = new Domibus(log,null,context)
entityID=test.retrieveMessageEntityID(messageID)
test.finalize()



ExtRestUtils.testDownloadPayloadEntityIDRequest(log,context,side, status, entityID, messageCID, pluginUser, pluginPassword, message)</script></con:config></con:testStep><con:testStep type="delay" name="D11" id="179d4fa3-904d-4ba4-aad4-8a76d58be101"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Download-Payload-EntityID-Failure-Entity ID not existing" id="17f704c2-71e4-4cac-b9d1-5dcea06c82ea"><con:settings/><con:config><script>def side="c3"
def status="badrequest"
def messageID="-DomJMS071-9-"
def messageCID="message"
def entityID="1234"
def pluginUser=testRunner.testCase.getPropertyValue("usernameC4");
def pluginPassword="DomibusEdel-12345"
def message="Could not find message with entity id"



ExtRestUtils.testDownloadPayloadEntityIDRequest(log,context,side, status, entityID, messageCID, pluginUser, pluginPassword, message)</script></con:config></con:testStep><con:testStep type="groovy" name="Reset properties values" id="a78a7933-3c87-42a1-83bb-b5cdb3fd5c49" disabled="true"><con:settings/><con:config><script>// C3
// jmsplugin.putAttachmentInQueue
def custPropName="jmsplugin.putAttachmentInQueue";
def defPropValue="true";
def propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C3",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);

// jmsplugin.attachment.reference.type
custPropName="jmsplugin.attachment.reference.type";
defPropValue=" ";
propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C3",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);

// jmsplugin.attachment.reference.type
custPropName="domibus.attachment.storage.location";
defPropValue=" ";
propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C3",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);

sleep(3000);

</script></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="f901e0a4-a38a-423f-8249-68a9574a98de" disabled="true"><con:settings/><con:config><script>// Delete plugin user in C2
def username=testRunner.testCase.getPropertyValue("usernameC4");
Domibus.removePluginUser("C3",context,log,"Default",username);

username=testRunner.testCase.getPropertyValue("usernameC1");
Domibus.removePluginUser("C3",context,log,"Default",username);

username=testRunner.testCase.getPropertyValue("userPlAdmin");
Domibus.removePluginUser("C3",context,log,"Default",username);

</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith("-DomJMS071-");
test.finalize();

testRunner.testCase.testSteps['Reset properties values'].run(testRunner, context);
testRunner.testCase.testSteps['Delete plugin users'].run(testRunner, context);

Domibus.reportTestCaseCsv(testRunner, log);
</con:tearDownScript><con:properties><con:property><con:name>usernameC4</con:name><con:value>userPlOUC423153343</con:value></con:property><con:property><con:name>usernameC1</con:name><con:value>userPlOUC123153344</con:value></con:property><con:property><con:name>adminUsername</con:name><con:value>userPlAdmin23153344</con:value></con:property><con:property><con:name>jmsplugin.putAttachmentInQueue</con:name><con:value>true</con:value></con:property><con:property><con:name>jmsplugin.attachment.reference.type</con:name><con:value>URL</con:value></con:property><con:property><con:name>domibus.attachment.storage.location</con:name><con:value>C:/domibus/1-mainBranch/receiver/domibus/payloads</con:value></con:property><con:property><con:name>jmsplugin.attachment.reference.context</con:name><con:value>http://localhost:8180/domibus</con:value></con:property><con:property><con:name>jmsplugin.attachment.reference.url</con:name><con:value>/ext/messages/ids/MESSAGE_ENTITY_ID/payloads/message</con:value></con:property></con:properties>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase id="fccf8577-af6f-4cb5-9e7c-325d0ac80f97" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS072-Submit Message-2 bodyloads" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Set logs starting line number" id="2c8ed994-611d-42f6-869c-c7c424ce9f81"><con:settings/><con:config><script> Domibus.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="e98fdbdb-7295-4e2e-bbbc-9f312ff3bcc9"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc20")
messageMap.setStringProperty("action", "TC20Leg1")
messageMap.setStringProperty("agreementRef", "DummyAgr");
messageMap.setStringProperty("agreementRefType", "DUM");
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushStandard")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS072-")
messageMap.setStringProperty("p1InBody", "true");
messageMap.setStringProperty("totalNumberOfPayloads", "2")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "&lt;test>test1&lt;/test>";
byte[] payload1 = pay1.getBytes()
messageMap.setBytes("payload_1", payload1)
messageMap.setStringProperty("payload_2_mimeContentId", "cid:attachment")
messageMap.setStringProperty("payload_2_mimeType", "text/xml")
messageMap.setStringProperty("payload_2_description", "message")
String pay2 = "&lt;test>test2&lt;/test>";
byte[] payload2 = pay2.getBytes()
messageMap.setBytes("payload_2", payload2)


domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="Delay" id="fcc2d1c3-1dd6-439c-8e87-ba1b8dfb64ef"><con:settings/><con:config><delay>10000</delay></con:config></con:testStep><con:testStep type="groovy" name="Check sender log file" id="1da40f3e-4785-405c-9812-ddd66daec639"><con:settings/><con:config><script>def logValueList =  ["multiple bodyload.*are not allowed"];
Domibus.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner);</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS050-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/><con:reportParameters/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS074-SmartRetry-Default-Mecanism" searchProperties="true" id="8a7f01a3-bcf3-44c9-83c9-81b5b22a358c">
            <con:settings/>












            <con:testStep type="groovy" name="Update-Pmode-C3-Remove-tc11Action" id="83cd5ef9-dfbb-4df3-a731-9fbb1d2ec95e"><con:settings/><con:config><script>def side="c3"
def nodename1="action"; def searchKey1="name"; def searchvalue1="tc11Action"; def attTochange1="value"; def newValue1="TC11Leg1random"

def parametersMap=[(nodename1):"$searchKey1#$searchvalue1#$attTochange1#$newValue1"]

PModeUtils.updatePmodeParametersRest(side,context,log,testRunner,parametersMap)</script></con:config></con:testStep><con:testStep type="groovy" name="Update-Pmode-C2-Update-Retry-2times-1min" id="ce4b83ed-152f-43bc-bec4-cd67bd1f6357"><con:settings/><con:config><script>def side="c2"
def nodename1="receptionAwareness"; def searchKey1="name"; def searchvalue1="receptionAwareness"; def attTochange1="retry"; def newValue1="2;2;CONSTANT"

def parametersMap=[(nodename1):"$searchKey1#$searchvalue1#$attTochange1#$newValue1"]

PModeUtils.updatePmodeParametersRest(side,context,log,testRunner,parametersMap)</script></con:config></con:testStep><con:testStep type="groovy" name="Update-Property-C2-domibus.msh.retry.cron" id="ca397836-4fed-498c-98b6-b7cdefbcb41a"><con:settings/><con:config><script>def custPropName="domibus.msh.retry.cron";
// Get Domibus property value
def propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
// Set test case custom property
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);

Domibus.changePropertyAtRuntime("C2", custPropName, "0/10 * * * * ?", context, log);
sleep(2000);</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="117b3b2c-66c8-48d6-b087-a8b7bf11d90b"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc11")
messageMap.setStringProperty("action", "TC11Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushShortRetention")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS074-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test Message Status" id="3575ffca-92c3-4b68-88a9-ec1aea82e9e7"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("WAITING_FOR_RETRY","","-DomJMS074-")
test.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="c1176055-ee0b-4cb5-a2e7-6528d93e2064"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="groovy" name="Set Starting line in Logfile 1" id="056ea6c7-b763-4d53-84e4-9621a353ff9a"><con:settings/><con:config><script>LogUtils.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)


</script></con:config></con:testStep><con:testStep type="groovy" name="Wait for retry event 1" id="caa6f0d3-4253-44e5-90c5-2f57fc053022"><con:settings/><con:config><script>def waitPropValue=context.expand('${#TestCase#waitPropValue}')

log.info "==== Waiting for the retry timeout 1 to expire"
sleep((waitPropValue as Integer)*1000);
log.info "==== Done"
</script></con:config></con:testStep><con:testStep type="groovy" name="Check sending message Log 1" id="9fe9fb02-f27b-43de-9f0c-00883158c545"><con:settings/><con:config><script>log.info "==== Checking the logs for the first re-send attempt"
def logValueList =  ["EbMS3 exception occurred when sending message with ID.*DomJMS074"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,true);

</script></con:config></con:testStep><con:testStep type="groovy" name="Set Starting line in Logfile 2" id="37a5d528-6ba6-42f4-8728-e58d4b4554e2"><con:settings/><con:config><script>LogUtils.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)


</script></con:config></con:testStep><con:testStep type="groovy" name="Wait for retry event 2" id="a7394b58-40eb-4bd7-89af-b4a746417fe9"><con:settings/><con:config><script>def waitPropValue=context.expand('${#TestCase#waitPropValue}')

log.info "==== Waiting for the retry timeout 2 to expire"
sleep((waitPropValue as Integer)*1000);
log.info "==== Done"
</script></con:config></con:testStep><con:testStep type="groovy" name="Check sending message Log 2" id="3a88c2d6-33a9-4b15-a26b-7be6556d17fe"><con:settings/><con:config><script>log.info "==== Checking the logs for the second re-send attempt"
def logValueList =  ["EbMS3 exception occurred when sending message with ID.*DomJMS074"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,true);

</script></con:config></con:testStep><con:testStep type="groovy" name="Check message status-Failure" id="7b4455c6-ab1d-46c1-bae1-ca34047b810c"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("SEND_FAILURE","","-DomJMS074-")
test.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Check send attempts-Value" id="c5e6ff4c-3f1b-4e23-8c97-56f883a6c16f"><con:settings/><con:config><script>def side="c2"
def messageId="-DomJMS074-"
def expectedValue=3

def test = new Domibus(log,null,context);
test.checkSendAttemptsValue(side,messageId,expectedValue)
test.finalize();


log.info "DONE"</script></con:config></con:testStep><con:testStep type="groovy" name="Reset Pmode Defaults" id="579e4ad9-b98d-4d3c-b700-664433be393e" disabled="true"><con:settings/><con:config><script>PModeUtils.resetPmodeDefaultRest(context,log,testRunner,)</script></con:config></con:testStep><con:testStep type="groovy" name="Reset C2 properties" id="ae856d28-4b2c-4bb8-aed6-ce500f95c306" disabled="true"><con:settings/><con:config><script>// C2
def custPropName="domibus.msh.retry.cron";
def defPropValue="0/30 * * * * ?";
def propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
// Reset property value
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);</script></con:config></con:testStep><con:setupScript>Domibus.checkIfAnySmokeTestsFailed(testRunner, testCase, log)</con:setupScript><con:tearDownScript>def test = new Domibus(log,null,context);
test.cleanDBMessageIDStartsWith('-DomJMS074-')
test.finalize();
testRunner.testCase.testSteps['Reset Pmode Defaults'].run(testRunner, context);
testRunner.testCase.testSteps['Reset C2 properties'].run(testRunner, context);

//Domibus.reportTestCaseCsv(testRunner, log)</con:tearDownScript><con:properties><con:property><con:name>c3_default_pmode</con:name><con:value/></con:property><con:property><con:name>c2_default_pmode</con:name><con:value/></con:property><con:property><con:name>domibus.msh.retry.cron</con:name><con:value>0/10 * * * * ?</con:value></con:property><con:property><con:name>waitPropValue</con:name><con:value>65</con:value></con:property><con:property><con:name>skipNumberOfLines</con:name><con:value>12991</con:value></con:property></con:properties>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS075-SmartRetry Disabled-Monitoring Enabled-C3 Unreachable" searchProperties="true" id="f48ba6d9-009c-4b5e-90b2-c9a88cf239ab">
            <con:settings/>












            <con:testStep type="groovy" name="Update-Pmode-C2-Retry Interval-Endpoint C3" id="cfbcc08a-416f-45c0-886d-85126ae82487"><con:settings/><con:config><script>def side="c2"
def nodename1="party"; def searchKey1="name"; def searchvalue1="red_gw"; def attTochange1="endpoint"; def newValue1="http://localhost:8888/domibus/services/msh"
def nodename2="receptionAwareness"; def searchKey2="name"; def searchvalue2="receptionAwareness"; def attTochange2="retry"; def newValue2="2;2;CONSTANT"

def parametersMap=[(nodename1):"$searchKey1#$searchvalue1#$attTochange1#$newValue1",(nodename2):"$searchKey2#$searchvalue2#$attTochange2#$newValue2"]

PModeUtils.updatePmodeParametersRest(side,context,log,testRunner,parametersMap)</script></con:config></con:testStep><con:testStep type="groovy" name="Update-Properties-C2" id="2f2ceeea-01ac-491f-ae01-3d8199673b09"><con:settings/><con:config><script>// Update retry cron to every 10 seconds
def custPropName="domibus.msh.retry.cron";
def propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, "0/10 * * * * ?", context, log);
sleep(2000);

// Enable Monitoring C3 domibus-red
custPropName="domibus.monitoring.connection.party.enabled";
propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, "domibus-red", context, log);
sleep(2000);

// Update cron job to monitor connection to every 10 seconds
custPropName="domibus.monitoring.connection.cron";
propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, "0/20 * * * * ?", context, log);
sleep(2000);


// Disable smart retry C3 domibus-red
custPropName="domibus.smart.retry.enabled";
propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, " ", context, log);
sleep(2000);</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="c14934a9-576d-4445-8f21-4fa18c958f6f"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc11")
messageMap.setStringProperty("action", "TC11Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushShortRetention")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS075-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test Message Status" id="dce17200-8345-41cf-9292-0c43cb574368"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("WAITING_FOR_RETRY","","-DomJMS075-")
test.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="b4bf68c4-f54a-446a-be71-c7a1b07cc44b"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="groovy" name="Set Starting line in Logfile 1" id="7a16a5f1-986d-4a13-9e6c-e45f15501df5"><con:settings/><con:config><script>LogUtils.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)


</script></con:config></con:testStep><con:testStep type="groovy" name="Wait for retry event 1" id="08dbd1e3-5f89-4d3f-82ce-e8cb2423a7b4"><con:settings/><con:config><script>def waitPropValue=context.expand('${#TestCase#waitPropValue}')

log.info "==== Waiting for the retry timeout 1 to expire"
sleep((waitPropValue as Integer)*1000);
log.info "==== Done"
</script></con:config></con:testStep><con:testStep type="groovy" name="Check sending message Log 1" id="41c4c44b-b561-4c6a-8577-199f6d63209c"><con:settings/><con:config><script>log.info "==== Checking the logs for the first re-send attempt"
def logValueList =  ["EbMS3 exception occurred when sending message with ID.*DomJMS075"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,true);

logValueList =  ["NullPointerException"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,false);</script></con:config></con:testStep><con:testStep type="groovy" name="Set Starting line in Logfile 2" id="475e3485-db75-404a-ba4e-a20bc6133ae0"><con:settings/><con:config><script>LogUtils.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)


</script></con:config></con:testStep><con:testStep type="groovy" name="Wait for retry event 2" id="1e3c3270-802a-4743-b0fa-2621f8f7b3c7"><con:settings/><con:config><script>def waitPropValue=context.expand('${#TestCase#waitPropValue}')

log.info "==== Waiting for the retry timeout 2 to expire"
sleep((waitPropValue as Integer)*1000);
log.info "==== Done"
</script></con:config></con:testStep><con:testStep type="groovy" name="Check sending message Log 2" id="bbeea58d-22e7-440b-96bd-c2054be10184"><con:settings/><con:config><script>log.info "==== Checking the logs for the second re-send attempt"
def logValueList =  ["EbMS3 exception occurred when sending message with ID.*DomJMS075"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,true);

logValueList =  ["NullPointerException"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,false);
</script></con:config></con:testStep><con:testStep type="groovy" name="Check message status-Failure" id="2d9f23a9-fe4c-46fa-b307-4acc844990a7"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("SEND_FAILURE","","-DomJMS075-")
test.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Check send attempts-Value" id="3125689a-7b6d-4cbc-a156-c6e9d5bfcaa9"><con:settings/><con:config><script>def side="c2"
def messageId="-DomJMS075-"
def expectedValue=3

def test = new Domibus(log,null,context);
test.checkSendAttemptsValue(side,messageId,expectedValue)
test.finalize();


log.info "DONE"</script></con:config></con:testStep><con:testStep type="groovy" name="Reset Pmode Defaults" id="3537a1e6-6828-490b-843f-4da062b52bf4" disabled="true"><con:settings/><con:config><script>PModeUtils.resetPmodeDefaultRest(context,log,testRunner,)</script></con:config></con:testStep><con:testStep type="groovy" name="Reset C2 properties" id="3fa64733-e845-4fa1-ade9-3d0717d2326a" disabled="true"><con:settings/><con:config><script>// C2
def custPropName="domibus.msh.retry.cron";
def defPropValue="0/30 * * * * ?";
def propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);


custPropName="domibus.monitoring.connection.party.enabled";
defPropValue=" ";
propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);


custPropName="domibus.monitoring.connection.cron";
defPropValue="0 0 0/2 ? * * *";
propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);


custPropName="domibus.smart.retry.enabled";
defPropValue=" ";
propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);</script></con:config></con:testStep><con:setupScript>Domibus.checkIfAnySmokeTestsFailed(testRunner, testCase, log)</con:setupScript><con:tearDownScript>def test = new Domibus(log,null,context);
test.cleanDBMessageIDStartsWith('-DomJMS075-')
test.finalize();
testRunner.testCase.testSteps['Reset Pmode Defaults'].run(testRunner, context);
testRunner.testCase.testSteps['Reset C2 properties'].run(testRunner, context);

Domibus.reportTestCaseCsv(testRunner, log)</con:tearDownScript><con:properties><con:property><con:name>waitPropValue</con:name><con:value>65</con:value></con:property><con:property><con:name>c2_default_pmode</con:name><con:value/></con:property><con:property><con:name>domibus.msh.retry.cron</con:name><con:value>0/10 * * * * ?</con:value></con:property><con:property><con:name>domibus.monitoring.connection.party.enabled</con:name><con:value>domibus-red</con:value></con:property><con:property><con:name>domibus.monitoring.connection.cron</con:name><con:value>0/20 * * * * ?</con:value></con:property><con:property><con:name>skipNumberOfLines</con:name><con:value>16329</con:value></con:property><con:property><con:name>domibus.smart.retry.enabled</con:name><con:value/></con:property></con:properties>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS076-SmartRetry Enabled-Monitoring Disabled-C3 Unreachable-No history" searchProperties="true" id="e0c45eba-122a-4837-90bd-979c8c982df8">
            <con:settings/>












            <con:testStep type="groovy" name="Update-Pmode-C2-Retry Interval-Endpoint C3" id="0c296ea7-47fd-4c19-aa72-0655b926e648"><con:settings/><con:config><script>def side="c2"
def nodename1="party"; def searchKey1="name"; def searchvalue1="red_gw"; def attTochange1="endpoint"; def newValue1="http://localhost:8888/domibus/services/msh"
def nodename2="receptionAwareness"; def searchKey2="name"; def searchvalue2="receptionAwareness"; def attTochange2="retry"; def newValue2="2;2;CONSTANT"

def parametersMap=[(nodename1):"$searchKey1#$searchvalue1#$attTochange1#$newValue1",(nodename2):"$searchKey2#$searchvalue2#$attTochange2#$newValue2"]

PModeUtils.updatePmodeParametersRest(side,context,log,testRunner,parametersMap)</script></con:config></con:testStep><con:testStep type="groovy" name="Update-Properties-C2" id="f1c087c9-a372-4d11-aac0-4bd1168e4469"><con:settings/><con:config><script>// Update retry cron to every 10 seconds
def custPropName="domibus.msh.retry.cron";
def propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, "0/10 * * * * ?", context, log);
sleep(2000);

// Disable Monitoring C3 domibus-red
custPropName="domibus.monitoring.connection.party.enabled";
propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, " ", context, log);
sleep(2000);

// Update cron job to monitor connection to every 10 seconds
custPropName="domibus.monitoring.connection.cron";
propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, "0/20 * * * * ?", context, log);
sleep(2000);


// Enable smart retry C3 domibus-red
custPropName="domibus.smart.retry.enabled";
propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, "domibus-red", context, log);
sleep(2000);</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Monitoring History" id="5153e6a6-f9ad-49b2-885c-1a0c33d5fece"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDatabaseTestMessagesAll()
test.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="72a2ff5b-f78d-4c59-a7c7-cf3b6d24c68c"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc11")
messageMap.setStringProperty("action", "TC11Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushShortRetention")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS076-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test Message Status" id="0e59a4d4-8fa4-4896-87c4-07d741edd467"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("WAITING_FOR_RETRY","","-DomJMS076-")
test.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="38ab6942-6207-4072-aac8-5a4a1bd1dc19"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="groovy" name="Set Starting line in Logfile 1" id="1cd5c4e1-6ce2-4852-80f9-05520139aee8"><con:settings/><con:config><script>LogUtils.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)


</script></con:config></con:testStep><con:testStep type="groovy" name="Wait for retry event 1" id="b12e8228-79e5-4d0d-8a50-968281c2075b"><con:settings/><con:config><script>def waitPropValue=context.expand('${#TestCase#waitPropValue}')

log.info "==== Waiting for the retry timeout 1 to expire"
sleep((waitPropValue as Integer)*1000);
log.info "==== Done"
</script></con:config></con:testStep><con:testStep type="groovy" name="Check sending message Log 1" id="fd5526f9-3ed2-489d-874c-cc8743afefe9"><con:settings/><con:config><script>log.info "==== Checking the logs for the first re-send attempt"
def logValueList =  ["EbMS3 exception occurred when sending message with ID.*DomJMS076"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,true);

logValueList =  ["NullPointerException"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,false);</script></con:config></con:testStep><con:testStep type="groovy" name="Set Starting line in Logfile 2" id="5c7c4ec1-a7b2-46b9-ad26-cbe966098424"><con:settings/><con:config><script>LogUtils.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)


</script></con:config></con:testStep><con:testStep type="groovy" name="Wait for retry event 2" id="3bc096de-c6bf-45ef-b6ae-b0f789dabdc1"><con:settings/><con:config><script>def waitPropValue=context.expand('${#TestCase#waitPropValue}')

log.info "==== Waiting for the retry timeout 2 to expire"
sleep((waitPropValue as Integer)*1000);
log.info "==== Done"
</script></con:config></con:testStep><con:testStep type="groovy" name="Check sending message Log 2" id="e698d5c5-167a-4a62-96a6-412a3a3de614"><con:settings/><con:config><script>log.info "==== Checking the logs for the second re-send attempt"
def logValueList =  ["EbMS3 exception occurred when sending message with ID.*DomJMS076"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,true);

logValueList =  ["NullPointerException"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,false);
</script></con:config></con:testStep><con:testStep type="groovy" name="Check message status-Failure" id="d78e4a4b-72ad-48f1-9d49-17c895fd24c7"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("SEND_FAILURE","","-DomJMS076-")
test.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Check send attempts-Value" id="c57707f4-9636-4f4f-a684-196a2a8b9cce"><con:settings/><con:config><script>def side="c2"
def messageId="-DomJMS076-"
def expectedValue=3

def test = new Domibus(log,null,context);
test.checkSendAttemptsValue(side,messageId,expectedValue)
test.finalize();


log.info "DONE"</script></con:config></con:testStep><con:testStep type="groovy" name="Reset Pmode Defaults" id="0d3447de-b3f7-491f-8d76-e25a278bc489" disabled="true"><con:settings/><con:config><script>PModeUtils.resetPmodeDefaultRest(context,log,testRunner,)</script></con:config></con:testStep><con:testStep type="groovy" name="Reset C2 properties" id="31c769f5-ae2a-4836-b6e8-905094613260" disabled="true"><con:settings/><con:config><script>// C2
def custPropName="domibus.msh.retry.cron";
def defPropValue="0/30 * * * * ?";
def propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);


custPropName="domibus.monitoring.connection.party.enabled";
defPropValue=" ";
propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);


custPropName="domibus.monitoring.connection.cron";
defPropValue="0 0 0/2 ? * * *";
propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);


custPropName="domibus.smart.retry.enabled";
defPropValue=" ";
propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);</script></con:config></con:testStep><con:setupScript>Domibus.checkIfAnySmokeTestsFailed(testRunner, testCase, log)</con:setupScript><con:tearDownScript>def test = new Domibus(log,null,context);
test.cleanDBMessageIDStartsWith(context.expand('-DomJMS076-')
test.finalize();
testRunner.testCase.testSteps['Reset Pmode Defaults'].run(testRunner, context);
testRunner.testCase.testSteps['Reset C2 properties'].run(testRunner, context);

Domibus.reportTestCaseCsv(testRunner, log)</con:tearDownScript><con:properties><con:property><con:name>waitPropValue</con:name><con:value>65</con:value></con:property><con:property><con:name>c2_default_pmode</con:name><con:value><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<db:configuration xmlns:db="http://domibus.eu/configuration" party="blue_gw">
	<mpcs>
		<mpc name="defaultMpc" qualifiedName="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC" enabled="true" default="true" retention_downloaded="600" retention_undownloaded="600"/>
		<mpc name="mpcPushStandard" qualifiedName="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushStandard" enabled="true" default="true" retention_downloaded="15" retention_undownloaded="600"/>
		<mpc name="mpcPushRetDownNull" qualifiedName="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPCWS" enabled="true" default="true" retention_downloaded="0" retention_undownloaded="3600"/>
		<mpc name="mpcPushShortRetention" qualifiedName="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushShortRetention" enabled="true" default="true" retention_downloaded="6" retention_undownloaded="10"/>
		<mpc name="mpcPull" qualifiedName="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPull" enabled="true" default="true" retention_downloaded="10" retention_undownloaded="600"/>
		<mpc name="mpcPullRetDownNull" qualifiedName="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPullRetDownNull" enabled="true" default="true" retention_downloaded="0" retention_undownloaded="600"/>
		<mpc name="mpcPullSignOnly" qualifiedName="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPullSignOnly" enabled="true" default="true" retention_downloaded="600" retention_undownloaded="600"/>
		<mpc name="mpcPullDoNothing" qualifiedName="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPullDoNothing" enabled="true" default="true" retention_downloaded="5" retention_undownloaded="600"/>
		<mpc name="mpcPullSelfSend" qualifiedName="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPullSelfSend" enabled="true" default="true" retention_downloaded="10" retention_undownloaded="600"/>
		<mpc name="mpcPullShortRetention" qualifiedName="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPullShortRetention" enabled="true" default="true" retention_downloaded="1" retention_undownloaded="2"/>
		<mpc name="mpcPullAgrNoPayProfile" qualifiedName="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPullAgrNoPayProfile" enabled="true" default="true" retention_downloaded="15" retention_undownloaded="600"/>
		<mpc name="mpcPullForPush" qualifiedName="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPullForPush" enabled="true" default="true" retention_downloaded="15" retention_undownloaded="600"/>
	</mpcs>
	<businessProcesses>
		<roles>
			<role name="defaultInitiatorRole" value="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator"/>
			<role name="defaultResponderRole" value="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder"/>
			<role name="defaultInitiatorRoleEmpty" value=" "/>
			<role name="defaultResponderRoleEmpty" value=" "/>
			<role name="peppolSenderRole" value="urn:fdc:peppol.eu:2017:roles:ap:sender"/>
			<role name="peppolReceiverRole" value="urn:fdc:peppol.eu:2017:roles:ap:receiver"/>
		</roles>
		<parties>
			<partyIdTypes>
				<partyIdType name="partyTypeUrn" value="urn:oasis:names:tc:ebcore:partyid-type:unregistered"/>
			</partyIdTypes>
			<party name="red_gw" endpoint="http://localhost:8888/domibus/services/msh" allowChunking="false">
				<identifier partyId="domibus-red" partyIdType="partyTypeUrn"/>
			</party>
			<party name="blue_gw" endpoint="http://localhost:8080/domibus/services/msh" allowChunking="false">
				<identifier partyId="domibus-blue" partyIdType="partyTypeUrn"/>
			</party>
			<party name="white_gw" endpoint="http://localhost:8080/domibus/services/msh" allowChunking="false">
				<identifier partyId="domibus-white" partyIdType="partyTypeUrn"/>
			</party>
			<party name="black_gw" endpoint="http://localhost:8888/domibus/services/msh" allowChunking="false">
				<identifier partyId="domibus-black" partyIdType="partyTypeUrn"/>
			</party>
			<party name="green_gw" endpoint="http://localhost:8280/domibus/services/msh" allowChunking="false">
				<identifier partyId="domibus-green" partyIdType="partyTypeUrn"/>
			</party>
			<party name="yellow_gw" endpoint="http://localhost:8989/domibus/services/msh" allowChunking="false">
				<identifier partyId="domibus-yellow" partyIdType="partyTypeUrn"/>
			</party>
		</parties>
		<meps>
			<mep name="oneway" value="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/oneWay"/>
			<mep name="twoway" value="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/twoWay"/>
			<binding name="push" value="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/push"/>
			<binding name="pull" value="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/pull"/>
			<binding name="pushAndPush" value="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/pushAndPush"/>
		</meps>
		<properties>
			<property name="originalSenderProperty" key="originalSender" datatype="string" required="true"/>
			<property name="finalRecipientProperty" key="finalRecipient" datatype="string" required="true"/>
			<property name="propWithoutTypeProperty" key="propWithoutType" datatype="string" required="false"/>
			<property name="propWithTypeProperty" key="propWithType" datatype="string" required="false"/>
			<propertySet name="ecodexPropertySet">
				<propertyRef property="finalRecipientProperty"/>
				<propertyRef property="originalSenderProperty"/>
				<propertyRef property="propWithoutTypeProperty"/>
				<propertyRef property="propWithTypeProperty"/>
			</propertySet>
			<propertySet name="twoCornersPropertySet">
				<propertyRef property="propWithoutTypeProperty"/>
				<propertyRef property="propWithTypeProperty"/>
			</propertySet>
		</properties>
		<payloadProfiles>
			<payload name="businessContentPayload" cid="cid:message" required="true" mimeType="text/xml" inBody="false"/>
			<payload name="businessContentAttachment" cid="cid:attachment" required="false" mimeType="application/pdf" inBody="false"/>
			<payload name="textbusinessContentAttachment" cid="cid:txtattachment" required="false" mimeType="text/plain" inBody="false"/>
			<payload name="octetStreambusinessContentAttachment" cid="cid:osattachment" required="false" mimeType="application/octet-stream" inBody="false"/>
			<payload name="businessContentPayloadInBody" cid="" required="true" mimeType="text/xml" inBody="true"/>
			<payload name="businessContentPayloadInBodyTwo" cid="" required="true" mimeType="application/xml" inBody="true"/>
			<payloadProfile name="MessageProfile" maxSize="2147483647">
				<attachment name="businessContentPayload"/>
				<attachment name="businessContentAttachment"/>
				<attachment name="textbusinessContentAttachment"/>
				<attachment name="octetStreambusinessContentAttachment"/>
			</payloadProfile>
			<payloadProfile name="MessageProfilePayloadInBody" maxSize="2147483647">
				<attachment name="businessContentPayloadInBody"/>
				<attachment name="businessContentAttachment"/>
			</payloadProfile>
			<payloadProfile name="MessageProfilePayloadInBodyTwo" maxSize="2147483647">
				<attachment name="businessContentPayloadInBodyTwo"/>
				<attachment name="businessContentAttachment"/>
			</payloadProfile>
			<payloadProfile name="MessageProfilePayloadOptionalAttachment" maxSize="2147483647">
				<attachment name="businessContentAttachment"/>
			</payloadProfile>
		</payloadProfiles>
		<securities>
			<security name="eDeliveryAS4Policy" policy="eDeliveryAS4Policy.xml" signatureMethod="RSA_SHA256"/>
			<security name="noSigNoEnc" policy="doNothingPolicy.xml" signatureMethod="RSA_SHA256"/>
			<security name="signOnly" policy="signOnly.xml" signatureMethod="RSA_SHA256"/>
			<security name="eDeliveryAS4Policy_BST" policy="eDeliveryAS4Policy_BST.xml" signatureMethod="RSA_SHA256"/>
			<security name="eDeliveryAS4Policy_IS" policy="eDeliveryAS4Policy_IS.xml" signatureMethod="RSA_SHA256"/>
			<security name="eDeliveryAS4PolicyEncryptBody" policy="eDeliveryAS4PolicyEncryptBody.xml" signatureMethod="RSA_SHA256"/>
			<security name="eDeliveryAS4PolicyNoBodyEncrypt" policy="eDeliveryAS4PolicyNoBodyEncrypt.xml" signatureMethod="RSA_SHA256"/>
			<!--<security name="eDeliveryAS4PolicyRSA" policy="eDeliveryAS4Policy.xml" profile="RSA"/>-->
			<!--<security name="eDeliveryAS4PolicyECC" policy="eDeliveryAS4Policy.xml" profile="ECC"/>-->
		</securities>
		<errorHandlings>
			<errorHandling name="demoErrorHandling" errorAsResponse="true" businessErrorNotifyProducer="false" businessErrorNotifyConsumer="false" deliveryFailureNotifyProducer="false"/>
			<errorHandling name="secondErrorHandlingAllTrue" errorAsResponse="true" businessErrorNotifyProducer="true" businessErrorNotifyConsumer="true" deliveryFailureNotifyProducer="true"/>
		</errorHandlings>
		<agreements>
			<agreement name="agreementEmpty" value="" type=""/>
			<agreement name="agreementDummy" value="DummyAgr" type="DUM"/>
			<agreement name="agreement1" value="A1" type=""/>
			<agreement name="agreement2" value="A2" type=""/>
			<agreement name="agreement3" value="A3" type=""/>
			<agreement name="agreementForDomJMS020" value="agreementForDomJMS020Value" type=""/>
			<agreement name="agreementForDomJMS023" value="agreementForDomJMS023Value" type="random"/>
		</agreements>
		<services>
			<service name="testService1" value="bdx:noprocess" type="tc1"/>
			<service name="testService2" value="bdx:noprocess" type="tc2"/>
			<service name="testService3" value="bdx:noprocess" type="tc3"/>
			<service name="testService4" value="bdx:noprocess" type="tc4"/>
			<service name="testService7" value="bdx:noprocess" type="tc7"/>
			<service name="testService07" value="bdx:noprocess" type="tc07"/>
			<service name="testService8" value="bdx:noprocess" type="tc8"/>
			<service name="testService10" value="bdx:noprocess" type="tc10"/>
			<service name="testService11" value="bdx:noprocess" type="tc11"/>
			<service name="testService13" value="bdx:noprocess" type="tc13"/>
			<service name="testService15" value="bdx:noprocess" type="tc15"/>
			<service name="testService16" value="bdx:noprocess" type="tc16"/>
			<service name="testService17" value="bdx:noprocess" type="tc17"/>
			<service name="testService18" value="bdx:noprocess" type="tc18"/>
			<service name="testService19" value="bdx:noprocess" type="tc19"/>
			<service name="testService20" value="bdx:noprocess" type="tc20"/>
			<service name="testService21" value="bdx:noprocess" type="tc21"/>
			<service name="testService22" value="bdx:noprocess" type="tc22"/>
			<service name="testService23" value="bdx:noprocess" type="tc23"/>
			<service name="testService24" value="bdx:noprocess" type="tc24"/>
			<service name="testService25" value="bdx:noprocess" type="tc25"/>
			<service name="testService26" value="bdx:noprocess" type="tc26"/>
			<service name="connectivityservice" value="http://ec.europa.eu/e-delivery/services/connectivity-service" type="edelivery"/>
			<service name="InboxBundleTransmissionService" value="InboxBundleTransmissionService" type="eDeliverySecond"/>
			<service name="testService27" value="bdx:noprocess" type="tc27"/>
			<service name="testService28" value="bdx:noprocess" type="tc28"/>
			<service name="testService31" value="bdx:noprocess" type="tc31"/>
			<service name="testService32" value="bdx:noprocess" type="tc32"/>
			<service name="testService36" value="bdx:noprocess" type="tc36"/>
			<service name="testService38" value="bdx:noprocess" type="tc38"/>
			<service name="testService39" value="bdx:noprocess" type="tc39"/>
			<service name="testService" value="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/service"/>
			<service name="testServiceUntyped" value="bdx:noprocessuntyped"/>
		</services>
		<actions>
			<action name="tc1Action" value="TC1Leg1"/>
			<action name="tc2Action" value="TC2Leg1"/>
			<action name="tc3Action" value="TC3Leg1"/>
			<action name="tc4Action" value="TC4Leg1"/>
			<action name="tc7Action" value="TC7Leg1"/>
			<action name="tc07Action" value="TC07Leg1"/>
			<action name="tc8Action" value="TC8Leg1"/>
			<action name="tc10Action" value="TC10Leg1"/>
			<action name="tc11Action" value="TC11Leg1"/>
			<action name="tc13Action" value="TC13Leg1"/>
			<action name="tc15Action" value="TC15Leg1"/>
			<action name="tc16Action" value="TC16Leg1"/>
			<action name="tc17Action" value="TC17Leg1"/>
			<action name="tc18Action" value="TC18Leg1"/>
			<action name="tc19Action" value="TC19Leg1"/>
			<action name="tc20Action" value="TC20Leg1"/>
			<action name="tc21Action" value="TC21Leg1"/>
			<action name="tc22Action" value="TC22Leg1"/>
			<action name="tc23Action" value="TC23Leg1"/>
			<action name="tc24Action" value="TC24Leg1"/>
			<action name="tc25Action" value="TC25Leg1"/>
			<action name="tc26Action" value="TC26Leg1"/>
			<action name="submitMessage" value="submitMessage"/>
			<action name="ackInboxBundleNotification" value="AckInboxBundleNotification"/>
			<action name="tc27Action" value="TC27Leg1"/>
			<action name="tc28Action" value="TC28Leg1"/>
			<action name="tc31Action" value="TC31Leg1"/>
			<action name="tc33Action" value="TC33Leg1"/>
			<action name="tc36Action" value="TC36Leg1"/>
			<action name="tc38Action" value="TC38Leg1"/>
			<action name="tc39Action" value="TC39Leg1"/>
			<action name="testAction" value="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/test"/>
		</actions>
		<as4>
			<receptionAwareness name="receptionAwareness" retry="2;2;CONSTANT" duplicateDetection="true"/>
			<receptionAwareness name="receptionOnlyOneAttempt" retry="0;0;CONSTANT" duplicateDetection="true"/>
			<reliability name="AS4Reliability" nonRepudiation="true" replyPattern="response"/>
			<reliability name="noReliability" nonRepudiation="false" replyPattern="response"/>
		</as4>
		<splittingConfigurations>
			<splitting name="default" fragmentSize="20" compression="true" joinInterval="1440"/>
		</splittingConfigurations>
		<legConfigurations>
			<legConfiguration name="pushTestcase1tc1Action" service="testService1" action="tc1Action" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase2tc1Action" service="testService2" action="tc2Action" defaultMpc="defaultMpc" reliability="noReliability" security="noSigNoEnc" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="false"/>
			<legConfiguration name="pushTestcase3tc1Action" service="testService3" action="tc3Action" defaultMpc="defaultMpc" reliability="AS4Reliability" security="signOnly" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase4tc1Action" service="testService4" action="tc4Action" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase7tc7Action" service="testService7" action="tc7Action" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase07tc07Action" service="testService07" action="tc07Action" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4Policy_BST" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase8tc8Action" service="testService8" action="tc8Action" defaultMpc="mpcPushShortRetention" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase10tc10Action" service="testService10" action="tc10Action" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase11tc11Action" service="testService11" action="tc11Action" defaultMpc="mpcPushShortRetention" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushConnectivityTest" service="connectivityservice" action="submitMessage" defaultMpc="defaultMpc" reliability="noReliability" security="noSigNoEnc" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="false"/>
			<legConfiguration name="pullTestcase13tc13Action" service="testService13" action="tc13Action" defaultMpc="mpcPull" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pullTestcase15tc15Action" service="testService15" action="tc15Action" defaultMpc="mpcPullRetDownNull" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pullTestcase16tc16Action" service="testService16" action="tc16Action" defaultMpc="mpcPullSignOnly" reliability="AS4Reliability" security="signOnly" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pullTestcase17tc17Action" service="testService17" action="tc17Action" defaultMpc="mpcPullDoNothing" reliability="noReliability" security="noSigNoEnc" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="false"/>
			<legConfiguration name="pullTestcase18tc18Action" service="testService18" action="tc18Action" defaultMpc="mpcPullSelfSend" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase19tc19Action" service="testService19" action="tc19Action" defaultMpc="mpcPushStandard" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="false"/>
			<legConfiguration name="pushTestcase20tc20Action" service="testService20" action="tc20Action" defaultMpc="mpcPushStandard" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" errorHandling="demoErrorHandling" compressPayloads="false"/>
			<legConfiguration name="pushTestcase21tc21Action" service="testService21" action="tc21Action" defaultMpc="mpcPushStandard" reliability="noReliability" security="noSigNoEnc" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" errorHandling="demoErrorHandling" compressPayloads="false"/>
			<legConfiguration name="pullTestcase22tc22Action" service="testService22" action="tc22Action" defaultMpc="mpcPullAgrNoPayProfile" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" errorHandling="demoErrorHandling" compressPayloads="false"/>
			<legConfiguration name="pushTestcase23tc23Action" service="testService23" action="tc23Action" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4Policy_IS" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase24tc24Action" service="testService24" action="tc24Action" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4PolicyEncryptBody" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfilePayloadInBody" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase25tc25Action" service="testService25" action="tc25Action" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4PolicyEncryptBody" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfilePayloadInBodyTwo" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase26tc26Action" service="testService26" action="tc26Action" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4PolicyNoBodyEncrypt" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfilePayloadInBody" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="backendToNodeAckBundleTxResponse" service="InboxBundleTransmissionService" action="ackInboxBundleNotification" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" errorHandling="secondErrorHandlingAllTrue" compressPayloads="true"/>
			<legConfiguration name="pushTestcase27tc27Action" service="testService27" action="tc27Action" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfilePayloadOptionalAttachment" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="testServiceCase" service="testService" action="testAction" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pullTestcase28tc28Action" service="testService28" action="tc28Action" defaultMpc="mpcPullShortRetention" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase31tc31Action" service="testService31" action="tc31Action" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase33tc33Action" service="testService32" action="tc33Action" splitting="default" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase34tc34Action" service="testServiceUntyped" action="tc10Action" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase35tc35Action" service="testServiceUntyped" action="tc33Action" defaultMpc="defaultMpc" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="twoCornersPropertySet" payloadProfile="MessageProfile" errorHandling="demoErrorHandling" compressPayloads="true"/>
			<legConfiguration name="pushTestcase36tc36Action" service="testService36" action="tc36Action" defaultMpc="mpcPushRetDownNull" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="secondErrorHandlingAllTrue" compressPayloads="true"/>
			<legConfiguration name="pushTestcase38tc38Action" service="testService38" action="tc38Action" defaultMpc="mpcPushRetDownNull" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionOnlyOneAttempt" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="secondErrorHandlingAllTrue" compressPayloads="true"/>
			<legConfiguration name="pullTestcase39tc39Action" service="testService39" action="tc39Action" defaultMpc="mpcPullForPush" reliability="AS4Reliability" security="eDeliveryAS4Policy" receptionAwareness="receptionAwareness" propertySet="ecodexPropertySet" payloadProfile="MessageProfile" errorHandling="secondErrorHandlingAllTrue" compressPayloads="true"/>
		</legConfigurations>
		<process name="tc1Process" agreement="agreementEmpty" mep="oneway" binding="push" initiatorRole="defaultInitiatorRole" responderRole="defaultResponderRole">
			<initiatorParties>
				<initiatorParty name="blue_gw"/>
				<initiatorParty name="red_gw"/>
				<initiatorParty name="black_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="white_gw"/>
				<responderParty name="blue_gw"/>
				<responderParty name="red_gw"/>
				<responderParty name="yellow_gw"/>
			</responderParties>
			<legs>
				<leg name="pushTestcase1tc1Action"/>
				<leg name="pushTestcase2tc1Action"/>
				<leg name="pushTestcase3tc1Action"/>
				<leg name="pushTestcase7tc7Action"/>
				<leg name="pushTestcase07tc07Action"/>
			</legs>
		</process>
		<process name="tc4Process" agreement="agreementDummy" mep="oneway" binding="push" initiatorRole="defaultInitiatorRole" responderRole="defaultResponderRole">
			<initiatorParties>
				<initiatorParty name="blue_gw"/>
				<initiatorParty name="red_gw"/>
				<initiatorParty name="black_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="white_gw"/>
				<responderParty name="blue_gw"/>
				<responderParty name="red_gw"/>
			</responderParties>
			<legs>
				<leg name="pushTestcase4tc1Action"/>
			</legs>
		</process>
		<process name="tc8Process" agreement="agreementForDomJMS020" mep="oneway" binding="push" initiatorRole="defaultInitiatorRole" responderRole="defaultResponderRole">
			<initiatorParties>
				<initiatorParty name="blue_gw"/>
				<initiatorParty name="red_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="blue_gw"/>
				<responderParty name="red_gw"/>
			</responderParties>
			<legs>
				<leg name="pushTestcase8tc8Action"/>
			</legs>
		</process>
		<process name="tc10Process" agreement="agreementEmpty" mep="oneway" binding="push" initiatorRole="defaultInitiatorRole" responderRole="defaultResponderRole">
			<initiatorParties>
				<initiatorParty name="blue_gw"/>
				<initiatorParty name="red_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="blue_gw"/>
				<responderParty name="red_gw"/>
			</responderParties>
			<legs>
				<leg name="pushTestcase10tc10Action"/>
				<leg name="pushTestcase11tc11Action"/>
				<leg name="pushTestcase19tc19Action"/>
				<leg name="pushTestcase23tc23Action"/>
				<leg name="pushTestcase24tc24Action"/>
				<leg name="pushTestcase25tc25Action"/>
				<leg name="pushTestcase26tc26Action"/>
				<leg name="pushTestcase31tc31Action"/>
				<leg name="pushTestcase33tc33Action"/>
				<leg name="pushTestcase34tc34Action"/>
				<leg name="pushTestcase35tc35Action"/>
				<leg name="pushTestcase36tc36Action"/>
				<leg name="pushTestcase38tc38Action"/>
				<leg name="testServiceCase"/>
				<leg name="pushConnectivityTest"/>
				<leg name="backendToNodeAckBundleTxResponse"/>
			</legs>
		</process>
		<process name="tc13Process" agreement="" mep="oneway" binding="pull" initiatorRole="defaultInitiatorRole" responderRole="defaultResponderRole">
			<initiatorParties>
				<initiatorParty name="red_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="blue_gw"/>
			</responderParties>
			<legs>
				<leg name="pullTestcase13tc13Action"/>
			</legs>
		</process>
		<process name="tc15Process" agreement="" mep="oneway" binding="pull" initiatorRole="defaultInitiatorRole" responderRole="defaultResponderRole">
			<initiatorParties>
				<initiatorParty name="red_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="blue_gw"/>
			</responderParties>
			<legs>
				<leg name="pullTestcase15tc15Action"/>
			</legs>
		</process>
		<process name="tc16Process" agreement="" mep="oneway" binding="pull" initiatorRole="defaultInitiatorRole" responderRole="defaultResponderRole">
			<initiatorParties>
				<initiatorParty name="red_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="blue_gw"/>
			</responderParties>
			<legs>
				<leg name="pullTestcase16tc16Action"/>
			</legs>
		</process>
		<process name="tc17Process" agreement="" mep="oneway" binding="pull" initiatorRole="defaultInitiatorRole" responderRole="defaultResponderRole">
			<initiatorParties>
				<initiatorParty name="red_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="blue_gw"/>
			</responderParties>
			<legs>
				<leg name="pullTestcase17tc17Action"/>
			</legs>
		</process>
		<process name="tc18Process" agreement="" mep="oneway" binding="pull" initiatorRole="defaultInitiatorRole" responderRole="defaultResponderRole">
			<initiatorParties>
				<initiatorParty name="blue_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="blue_gw"/>
			</responderParties>
			<legs>
				<leg name="pullTestcase18tc18Action"/>
			</legs>
		</process>
		<process name="tc20Process" agreement="agreementDummy" mep="oneway" binding="push" initiatorRole="defaultInitiatorRole" responderRole="defaultResponderRole">
			<initiatorParties>
				<initiatorParty name="blue_gw"/>
				<initiatorParty name="red_gw"/>
				<initiatorParty name="black_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="blue_gw"/>
				<responderParty name="red_gw"/>
				<responderParty name="white_gw"/>
			</responderParties>
			<legs>
				<leg name="pushTestcase20tc20Action"/>
			</legs>
		</process>
		<process name="tc21Process" agreement="agreementEmpty" mep="oneway" binding="push" initiatorRole="defaultInitiatorRole" responderRole="defaultResponderRole">
			<initiatorParties>
				<initiatorParty name="blue_gw"/>
				<initiatorParty name="red_gw"/>
				<initiatorParty name="white_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="blue_gw"/>
				<responderParty name="red_gw"/>
				<responderParty name="white_gw"/>
			</responderParties>
			<legs>
				<leg name="pushTestcase21tc21Action"/>
			</legs>
		</process>
		<process name="tc22Process" agreement="agreementDummy" mep="oneway" binding="pull" initiatorRole="defaultInitiatorRole" responderRole="defaultResponderRole">
			<initiatorParties>
				<initiatorParty name="red_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="blue_gw"/>
			</responderParties>
			<legs>
				<leg name="pullTestcase22tc22Action"/>
			</legs>
		</process>
		<process name="tc27Process" agreement="agreementEmpty" mep="oneway" binding="push" initiatorRole="peppolSenderRole" responderRole="peppolReceiverRole">
			<initiatorParties>
				<initiatorParty name="blue_gw"/>
				<initiatorParty name="red_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="blue_gw"/>
				<responderParty name="red_gw"/>
			</responderParties>
			<legs>
				<leg name="pushTestcase27tc27Action"/>
			</legs>
		</process>
		<process name="tc28Process" agreement="" mep="oneway" binding="pull" initiatorRole="defaultInitiatorRole" responderRole="defaultResponderRole">
			<initiatorParties>
				<initiatorParty name="red_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="blue_gw"/>
			</responderParties>
			<legs>
				<leg name="pullTestcase28tc28Action"/>
			</legs>
		</process>
		<process name="tc39Process" agreement="" mep="oneway" binding="pull" initiatorRole="defaultInitiatorRole" responderRole="defaultResponderRole">
			<initiatorParties>
				<initiatorParty name="blue_gw"/>
			</initiatorParties>
			<responderParties>
				<responderParty name="red_gw"/>
			</responderParties>
			<legs>
				<leg name="pullTestcase39tc39Action"/>
			</legs>
		</process>
	</businessProcesses>
</db:configuration>

]]></con:value></con:property><con:property><con:name>domibus.msh.retry.cron</con:name><con:value>0/10 * * * * ?</con:value></con:property><con:property><con:name>domibus.monitoring.connection.party.enabled</con:name><con:value>domibus-red</con:value></con:property><con:property><con:name>domibus.monitoring.connection.cron</con:name><con:value>0/20 * * * * ?</con:value></con:property><con:property><con:name>skipNumberOfLines</con:name><con:value>24448</con:value></con:property><con:property><con:name>domibus.smart.retry.enabled</con:name><con:value/></con:property></con:properties>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS077-SmartRetry Enabled-Monitoring Enabled-C3 Unreachable" searchProperties="true" id="e2d79d33-612a-4317-961c-030e2c8292a2">
            <con:settings/>












            <con:testStep type="groovy" name="Update-Pmode-C2-Retry Interval-Endpoint C3" id="bb649315-8fde-4ca5-b9f0-2542b3dbe341"><con:settings/><con:config><script>def side="c2"
def nodename1="party"; def searchKey1="name"; def searchvalue1="red_gw"; def attTochange1="endpoint"; def newValue1="http://localhost:8888/domibus/services/msh"
def nodename2="receptionAwareness"; def searchKey2="name"; def searchvalue2="receptionAwareness"; def attTochange2="retry"; def newValue2="2;2;CONSTANT"

def parametersMap=[(nodename1):"$searchKey1#$searchvalue1#$attTochange1#$newValue1",(nodename2):"$searchKey2#$searchvalue2#$attTochange2#$newValue2"]

PModeUtils.updatePmodeParametersRest(side,context,log,testRunner,parametersMap)</script></con:config></con:testStep><con:testStep type="groovy" name="Update-Properties-C2" id="a985900b-7d20-4847-b672-2afc9999d317"><con:settings/><con:config><script>// Update retry cron to every 10 seconds
def custPropName="domibus.msh.retry.cron";
def propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, "0/10 * * * * ?", context, log);
sleep(2000);

// Enable Monitoring C3 domibus-red
custPropName="domibus.monitoring.connection.party.enabled";
propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, "domibus-red", context, log);
sleep(2000);

// Update cron job to monitor connection to every 10 seconds
custPropName="domibus.monitoring.connection.cron";
propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, "0/20 * * * * ?", context, log);
sleep(2000);


// Enable smart retry C3 domibus-red
custPropName="domibus.smart.retry.enabled";
propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, "domibus-red", context, log);
sleep(2000);</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="0b30d048-e609-4256-b9e5-7bdbfce5a63d"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc11")
messageMap.setStringProperty("action", "TC11Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushShortRetention")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS077-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test Message Status" id="dbc45b7e-2cc1-4f46-a50d-3bc1167f42c1"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("WAITING_FOR_RETRY","","-DomJMS077-")
test.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="0702e4e0-a28b-4cc0-a389-15800a0915ad"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="groovy" name="Set Starting line in Logfile 1" id="b41f86f1-ccb3-4176-9343-5ccf8be22a34"><con:settings/><con:config><script>LogUtils.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)


</script></con:config></con:testStep><con:testStep type="groovy" name="Wait for retry event 1" id="edb3e556-f32c-46ab-9f8e-82d1f4405758"><con:settings/><con:config><script>def waitPropValue=context.expand('${#TestCase#waitPropValue}')

log.info "==== Waiting for the retry timeout 1 to expire"
sleep((waitPropValue as Integer)*1000);
log.info "==== Done"
</script></con:config></con:testStep><con:testStep type="groovy" name="Check sending message Log 1" id="a2a34df1-8c43-42c6-8312-a2363191cc3f"><con:settings/><con:config><script>log.info "==== Checking the logs for the first re-send attempt"
def logValueList =  ["EbMS3 exception occurred when sending message with ID.*DomJMS077"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,false);

logValueList =  ["NullPointerException"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,false);</script></con:config></con:testStep><con:testStep type="groovy" name="Set Starting line in Logfile 2" id="35261ffe-4827-478a-9cac-2cec0817e927"><con:settings/><con:config><script>LogUtils.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)


</script></con:config></con:testStep><con:testStep type="groovy" name="Wait for retry event 2" id="fb5d66d4-5a4e-43be-b87e-00d1889f222f"><con:settings/><con:config><script>def waitPropValue=context.expand('${#TestCase#waitPropValue}')

log.info "==== Waiting for the retry timeout 2 to expire"
sleep((waitPropValue as Integer)*1000);
log.info "==== Done"
</script></con:config></con:testStep><con:testStep type="groovy" name="Check sending message Log 2" id="75077266-d54d-4f49-a806-fb3a633c8663"><con:settings/><con:config><script>log.info "==== Checking the logs for the second re-send attempt"
def logValueList =  ["EbMS3 exception occurred when sending message with ID.*DomJMS077"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,false);

logValueList =  ["NullPointerException"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,false);
</script></con:config></con:testStep><con:testStep type="groovy" name="Check message status-Failure" id="09588a51-6ba2-4911-a142-772de5f109ab"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("SEND_FAILURE","","-DomJMS077-")
test.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Check send attempts-Value" id="d11fe1ba-bde9-4d11-b5b4-37f81f04484d"><con:settings/><con:config><script>def side="c2"
def messageId="-DomJMS077-"
def expectedValue=3

def test = new Domibus(log,null,context);
test.checkSendAttemptsValue(side,messageId,expectedValue)
test.finalize();


log.info "DONE"</script></con:config></con:testStep><con:testStep type="groovy" name="Reset Pmode Defaults" id="4008e6d1-9e90-41dc-8691-ef67d627ab4f" disabled="true"><con:settings/><con:config><script>PModeUtils.resetPmodeDefaultRest(context,log,testRunner,)</script></con:config></con:testStep><con:testStep type="groovy" name="Reset C2 properties" id="93a02fed-7007-43cf-989a-65560c8f245a" disabled="true"><con:settings/><con:config><script>// C2
def custPropName="domibus.msh.retry.cron";
def defPropValue="0/30 * * * * ?";
def propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);


custPropName="domibus.monitoring.connection.party.enabled";
defPropValue=" ";
propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);


custPropName="domibus.monitoring.connection.cron";
defPropValue="0 0 0/2 ? * * *";
propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);


custPropName="domibus.smart.retry.enabled";
defPropValue=" ";
propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);</script></con:config></con:testStep><con:setupScript>Domibus.checkIfAnySmokeTestsFailed(testRunner, testCase, log)</con:setupScript><con:tearDownScript>def test = new Domibus(log,null,context);
test.cleanDBMessageIDStartsWith('-DomJMS077-')
test.finalize();
testRunner.testCase.testSteps['Reset Pmode Defaults'].run(testRunner, context);
testRunner.testCase.testSteps['Reset C2 properties'].run(testRunner, context);

Domibus.reportTestCaseCsv(testRunner, log)</con:tearDownScript><con:properties><con:property><con:name>waitPropValue</con:name><con:value>65</con:value></con:property><con:property><con:name>c2_default_pmode</con:name><con:value/></con:property><con:property><con:name>domibus.msh.retry.cron</con:name><con:value>0/10 * * * * ?</con:value></con:property><con:property><con:name>domibus.monitoring.connection.party.enabled</con:name><con:value>domibus-red</con:value></con:property><con:property><con:name>domibus.monitoring.connection.cron</con:name><con:value>0/20 * * * * ?</con:value></con:property><con:property><con:name>skipNumberOfLines</con:name><con:value>20136</con:value></con:property><con:property><con:name>domibus.smart.retry.enabled</con:name><con:value/></con:property></con:properties>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS078-SmartRetry Enabled-Monitoring Enabled-C3 Reachable" searchProperties="true" id="31830e1e-56eb-4d8b-b9a1-b1822409252a">
            <con:settings/>












            <con:testStep type="groovy" name="Update-Pmode-C2-Retry Interval-Remove tc11Action" id="47e542e4-2c2f-4d0e-93c8-61df31426a0f"><con:settings/><con:config><script>def side="c2"
def nodename1="receptionAwareness"; def searchKey1="name"; def searchvalue1="receptionAwareness"; def attTochange1="retry"; def newValue1="2;2;CONSTANT"
def parametersMap=[(nodename1):"$searchKey1#$searchvalue1#$attTochange1#$newValue1"]
PModeUtils.updatePmodeParametersRest(side,context,log,testRunner,parametersMap)

side="c3"
nodename1="action"; searchKey1="name"; searchvalue1="tc11Action"; attTochange1="value"; newValue1="TC11Leg1random"
parametersMap=[(nodename1):"$searchKey1#$searchvalue1#$attTochange1#$newValue1"]
PModeUtils.updatePmodeParametersRest(side,context,log,testRunner,parametersMap)</script></con:config></con:testStep><con:testStep type="groovy" name="Update-Properties-C2" id="fd10e327-be9a-4741-9cba-1f494c489668"><con:settings/><con:config><script>// Update retry cron to every 10 seconds
def custPropName="domibus.msh.retry.cron";
def propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, "0/10 * * * * ?", context, log);
sleep(2000);

// Enable Monitoring C3 domibus-red
custPropName="domibus.monitoring.connection.party.enabled";
propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, "domibus-red", context, log);
sleep(2000);

// Update cron job to monitor connection to every 10 seconds
custPropName="domibus.monitoring.connection.cron";
propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, "0/20 * * * * ?", context, log);
sleep(2000);


// Enable smart retry C3 domibus-red
custPropName="domibus.smart.retry.enabled";
propValue=Domibus.getPropertyAtRuntime("C2",custPropName,context,log);
Domibus.setTestCaseCustProp(custPropName,propValue,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2", custPropName, "domibus-red", context, log);
sleep(2000);</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="9d977595-8df1-42bf-8233-d87d465b13c5"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc11")
messageMap.setStringProperty("action", "TC11Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/mpcPushShortRetention")
messageMap.setStringProperty("protocol", "AS4")

domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)

messageMap.setStringProperty("messageId", "-DomJMS078-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test Message Status" id="b727b2b8-0633-4727-9aae-774b4a31ce54"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("WAITING_FOR_RETRY","","-DomJMS078-")
test.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D0" id="c828d587-ab76-4d17-a79d-c9b5fd086d49"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="groovy" name="Set Starting line in Logfile 1" id="00aa990b-fc85-4eb7-91fb-5a42ff2fe811"><con:settings/><con:config><script>LogUtils.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)


</script></con:config></con:testStep><con:testStep type="groovy" name="Wait for retry event 1" id="0ecc618e-e7c4-43cf-8a4f-5c20cc57ba89"><con:settings/><con:config><script>def waitPropValue=context.expand('${#TestCase#waitPropValue}')

log.info "==== Waiting for the retry timeout 1 to expire"
sleep((waitPropValue as Integer)*1000);
log.info "==== Done"
</script></con:config></con:testStep><con:testStep type="groovy" name="Check sending message Log 1" id="e3a4a7ba-3f16-43df-8d49-854aaa30c187"><con:settings/><con:config><script>log.info "==== Checking the logs for the first re-send attempt"
def logValueList =  ["EbMS3 exception occurred when sending message with ID.*DomJMS078"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,true);

logValueList =  ["NullPointerException"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,false);</script></con:config></con:testStep><con:testStep type="groovy" name="Set Starting line in Logfile 2" id="9eca35a7-05bc-4bbf-9896-3e61158271b3"><con:settings/><con:config><script>LogUtils.checkNumberOfLinesToSkipInLogFile("C2","domibus.log", log, context, testRunner)


</script></con:config></con:testStep><con:testStep type="groovy" name="Wait for retry event 2" id="7d199542-e65d-4c24-b710-e21842d3ace4"><con:settings/><con:config><script>def waitPropValue=context.expand('${#TestCase#waitPropValue}')

log.info "==== Waiting for the retry timeout 2 to expire"
sleep((waitPropValue as Integer)*1000);
log.info "==== Done"
</script></con:config></con:testStep><con:testStep type="groovy" name="Check sending message Log 2" id="2d540407-1af8-4a4b-bb7b-ffb6669ecdc3"><con:settings/><con:config><script>log.info "==== Checking the logs for the second re-send attempt"
def logValueList =  ["EbMS3 exception occurred when sending message with ID.*DomJMS078"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,true);

logValueList =  ["NullPointerException"];
LogUtils.checkLogFile("C2","domibus.log", logValueList, log, context, testRunner,false);
</script></con:config></con:testStep><con:testStep type="groovy" name="Check message status-Failure" id="b3322399-a596-4d18-9a42-8d509ee7fcd8"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("SEND_FAILURE","","-DomJMS078-")
test.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Check send attempts-Value" id="ba775fc9-d539-48e3-8101-75d659bde61a"><con:settings/><con:config><script>def side="c2"
def messageId="-DomJMS078-"
def expectedValue=3

def test = new Domibus(log,null,context);
test.checkSendAttemptsValue(side,messageId,expectedValue)
test.finalize();


log.info "DONE"</script></con:config></con:testStep><con:testStep type="groovy" name="Reset Pmode Defaults" id="05279334-cb9b-47d0-8983-b918430ff5cd" disabled="true"><con:settings/><con:config><script>PModeUtils.resetPmodeDefaultRest(context,log,testRunner,)</script></con:config></con:testStep><con:testStep type="groovy" name="Reset C2 properties" id="2addf8d7-c619-4fb7-9c04-3254cbe85b43" disabled="true"><con:settings/><con:config><script>// C2
def custPropName="domibus.msh.retry.cron";
def defPropValue="0/30 * * * * ?";
def propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);


custPropName="domibus.monitoring.connection.party.enabled";
defPropValue=" ";
propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);


custPropName="domibus.monitoring.connection.cron";
defPropValue="0 0 0/2 ? * * *";
propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);


custPropName="domibus.smart.retry.enabled";
defPropValue=" ";
propValue=Domibus.getTestCaseCustProp(custPropName,log,context,testRunner);
Domibus.changePropertyAtRuntime("C2",custPropName,Domibus.ifEmptyReturnDef(propValue,defPropValue),context,log);
sleep(2000);</script></con:config></con:testStep><con:setupScript>Domibus.checkIfAnySmokeTestsFailed(testRunner, testCase, log)</con:setupScript><con:tearDownScript>def test = new Domibus(log,null,context);
test.cleanDBMessageIDStartsWith('-DomJMS078-')
test.finalize();
testRunner.testCase.testSteps['Reset Pmode Defaults'].run(testRunner, context);
testRunner.testCase.testSteps['Reset C2 properties'].run(testRunner, context);

Domibus.reportTestCaseCsv(testRunner, log)</con:tearDownScript><con:properties><con:property><con:name>waitPropValue</con:name><con:value>65</con:value></con:property><con:property><con:name>c2_default_pmode</con:name><con:value/></con:property><con:property><con:name>domibus.msh.retry.cron</con:name><con:value>0/10 * * * * ?</con:value></con:property><con:property><con:name>domibus.monitoring.connection.party.enabled</con:name><con:value>domibus-red</con:value></con:property><con:property><con:name>domibus.monitoring.connection.cron</con:name><con:value>0/20 * * * * ?</con:value></con:property><con:property><con:name>skipNumberOfLines</con:name><con:value>23173</con:value></con:property><con:property><con:name>domibus.smart.retry.enabled</con:name><con:value/></con:property><con:property><con:name>c3_default_pmode</con:name><con:value/></con:property></con:properties>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="a375a32c-de66-47a0-ba0d-765bc2b78b38" name="JMS-oneway Push-Manual test cases"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS055-Manual-EDELIVERY-1706-JMS Monitoring: empty messages are not displayed" searchProperties="true" id="e5031b02-252a-4bda-a8d3-6139270525fd">
            <con:settings/>












            <con:testStep type="groovy" name="Submit Message 1" id="c9b49cff-0303-419f-a93a-4f31442a3861"><con:settings/><con:config><script>import org.apache.activemq.ActiveMQConnectionFactory;
import javax.jms.*;
import javax.naming.NamingException;

ActiveMQConnectionFactory connectionFactory = new ActiveMQConnectionFactory("tcp://localhost:61616")
Connection connection = null;
MessageProducer producer = null;
connection = connectionFactory.createConnection("domibus", "changeit"); //username and password of the default JMS broker
Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE)
Destination destination = session.createQueue("domibus.DLQ")
producer = session.createProducer(destination)
producer.setDeliveryMode(DeliveryMode.NON_PERSISTENT)

Message request = session.createTextMessage(null)

log.info "Sending Text message with empty (null) text message"
producer.send(request)
log.info "Text message sent"

connection.close()</script></con:config></con:testStep><con:testStep type="groovy" name="Check if messageID property can be found in JMS queues" id="975287b4-6c8a-4e30-bef7-4e13f8bfb324"><con:settings/><con:config><script>def result=javax.swing.JOptionPane.showConfirmDialog( null,"""\
In previous step intentionally empty text message was send to Dead Letter Queue.
Check on Domibus - JMS Monitoring page that message is present in:
[internal] domibus.DLQ JMS queue of Sender.
""");

if(result == javax.swing.JOptionPane.YES_OPTION)
{
	log.info "continuing the test";
}
else if(result == javax.swing.JOptionPane.NO_OPTION)
{
	log.info "script aborted";
	testRunner.fail("Test aborted by user")
}</script></con:config></con:testStep><con:tearDownScript>Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>90414ed1-d501-45a8-86b6-466a1352735c</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>cd8b9098-8fbd-42a9-8eb7-67404b5f59dd</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>906220c2-8277-4fcb-a3bd-f15306888b25</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>53c0a958-b619-493b-b45b-7b9d7ecf4e43</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e138bc36-5999-4555-b848-c445b16888f9</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="1e9e408e-be46-479a-83aa-d8c07e0a80dd" name="EDELIVERY-1340-Maximum number of sending attempts" disabled="true"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS005-Submit message-Exceptional flow-retry max reached" searchProperties="true" id="c1a12aba-d88a-43ed-9c3b-e2dcd7b75221" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Stop Receiver MSH" id="c2c033d6-c56a-4e70-8dc2-85910b94fa27"><con:settings/><con:config><script>Domibus.stopMSH("receiver",context, log);</script></con:config></con:testStep><con:testStep type="delay" name="D1" id="af1c8abf-19a2-42f7-811e-4c5390057bdf"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="02027f3d-c570-42a5-a683-a9137054dda7"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPCJMS")
messageMap.setStringProperty("protocol", "AS4")
domUtils.addPluginCredentialsIfNeeded(context, log, messageMap)
messageMap.setStringProperty("messageId", "-DomJMS005-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="8df6843a-7bc4-4f15-bebd-fc02c1783185"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("WAITING_FOR_RETRY",null,"-DomJMS005-")
test.verifyMessagePresence(1,0,"-DomJMS005-")
test.finalize()</script></con:config></con:testStep><con:testStep type="delay" name="D2" id="aa73096e-0b1d-4451-9932-d47cc6294209"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Check message submitted" id="5fe65c2d-545f-4a69-bb41-cc726042ad15"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("SEND_FAILURE",null,"-DomJMS005-","Long")
test.verifyMessagePresence(1,0,"-DomJMS005-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>Domibus.startMSH("receiver", context, log)

Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>c189cf14-cd7d-41a8-81fe-3e1d4e5c28fa</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>bc00ae7a-2d2a-4e11-90d4-ae07623d92ea</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="9c5c128b-7a86-4a1d-ac3d-e8653520ddf8" name="EDELIVERY-1386 - FallBack issue" disabled="true"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS011-Submit Message-action-FallBack" searchProperties="true" id="ad1abfa4-3e36-400d-96a8-3c46af0beb08" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Update Default properties file" id="bb1299cb-5b95-4355-8122-cc7374b3e611"><con:settings/><con:config><script>def result=javax.swing.JOptionPane.showConfirmDialog( null,"Add line:\nAction = \"TC1Leg1\"");
if(result == javax.swing.JOptionPane.YES_OPTION)
{
	log.info "continuing the test";
}
else if(result == javax.swing.JOptionPane.NO_OPTION)
{
	log.info "script aborted";
	testRunner.fail("Test aborted by user")
}</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="d5ede536-6f40-40b8-8761-9c641a58f2ab"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
//messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPCJMS")
messageMap.setStringProperty("protocol", "AS4")
messageMap.setStringProperty("messageId", "-DomJMS011-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="bbec6380-2f98-4b92-9322-68574fab1c8b"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(1,1,"-DomJMS011-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS011-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS013-Submit Message-Service-FallBack" searchProperties="true" id="50e68cf4-fb6a-4aaf-b456-5bb2c3156ea3" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Update Default properties file" id="823bb11f-0d7b-4613-939c-846c82b93e04"><con:settings/><con:config><script>def result=javax.swing.JOptionPane.showConfirmDialog( null,"Add line:\n Service = \"bdx:noprocess\"");
if(result == javax.swing.JOptionPane.YES_OPTION)
{
	log.info "continuing the test";
}
else if(result == javax.swing.JOptionPane.NO_OPTION)
{
	log.info "script aborted";
	testRunner.fail("Test aborted by user")
}</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="9684714d-a120-47b9-891a-d5920c577007"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
//messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPCJMS")
messageMap.setStringProperty("protocol", "AS4")
messageMap.setStringProperty("messageId", "-DomJMS013-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="a16876dc-b140-49af-9c59-d9eb1086611c"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(1,1,"-DomJMS013-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS013-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS016-Submit Message-serviceType-FallBack-service typed" searchProperties="true" id="bcc10cfb-7768-4197-ba4a-3b159ec7a46e" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Update Default properties file" id="3f062391-d1bf-467f-870f-9e441556bf51"><con:settings/><con:config><script>def result=javax.swing.JOptionPane.showConfirmDialog( null,"Add line:\n serviceType = \"tc1\"");
if(result == javax.swing.JOptionPane.YES_OPTION)
{
	log.info "continuing the test";
}
else if(result == javax.swing.JOptionPane.NO_OPTION)
{
	log.info "script aborted";
	testRunner.fail("Test aborted by user")
}</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="08383fb9-7ab1-4c91-b1fe-1f6a163cf932"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
//messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPCJMS")
messageMap.setStringProperty("protocol", "AS4")
messageMap.setStringProperty("messageId", "-DomJMS016-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="7611528d-5a58-4ba2-95c9-580b45eabe7a"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(1,1,"-DomJMS016-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS016-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS021-Submit Message-agreementRef-FallBack" searchProperties="true" id="4140c67e-c7d8-4359-a783-4c7b0375f190" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Update Default properties file" id="7a7a2611-e08c-4175-9db3-8d218f51d937"><con:settings/><con:config><script>def result=javax.swing.JOptionPane.showConfirmDialog( null,"Add line:\nAgreementRef = \"backUpAgreementRef\"");
if(result == javax.swing.JOptionPane.YES_OPTION)
{
	log.info "continuing the test";
}
else if(result == javax.swing.JOptionPane.NO_OPTION)
{
	log.info "script aborted";
	testRunner.fail("Test aborted by user")
}</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="31693f86-ef2d-4265-9364-e130a115d5c8"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPCJMS")
messageMap.setStringProperty("protocol", "AS4")
messageMap.setStringProperty("messageId", "-DomJMS021-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="32520f35-8bd1-4c66-a722-bd19f26e5fe4"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.waitForStatus("ACKNOWLEDGED","DOWNLOADED","-DomJMS021-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS021-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS026-Submit Message-fromRole-FallBack" searchProperties="true" id="f9a2857f-3b32-4152-af6a-1c9d9530a77a" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Update Default properties file" id="fbd980b5-1d59-415a-9dee-b143a2285fe5"><con:settings/><con:config><script>def result=javax.swing.JOptionPane.showConfirmDialog( null,"Add line:\nfromRole = \"http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator\"");
if(result == javax.swing.JOptionPane.YES_OPTION)
{
	log.info "continuing the test";
}
else if(result == javax.swing.JOptionPane.NO_OPTION)
{
	log.info "script aborted";
	testRunner.fail("Test aborted by user")
}</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="2b833887-18ff-42a0-8916-b29a774c4463"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
//messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPCJMS")
messageMap.setStringProperty("protocol", "AS4")
messageMap.setStringProperty("messageId", "-DomJMS026-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="f88cfd1b-5a4d-4d6e-8cc5-f2214af439ae"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(1,1,"-DomJMS026-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS026-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS030-Submit Message-toRole-FallBack" searchProperties="true" id="c665c6b5-0ad6-42e5-92d0-97ac58d14b6e" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Update Default properties file" id="d485c1d5-840a-4f48-9249-06740816dbc8"><con:settings/><con:config><script>def result=javax.swing.JOptionPane.showConfirmDialog( null,"Add line:\ntoRole = \"http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder\"");
if(result == javax.swing.JOptionPane.YES_OPTION)
{
	log.info "continuing the test";
}
else if(result == javax.swing.JOptionPane.NO_OPTION)
{
	log.info "script aborted";
	testRunner.fail("Test aborted by user")
}</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="5241503d-9447-4033-89a8-c0ccdb2214a6"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
//messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPCJMS")
messageMap.setStringProperty("protocol", "AS4")
messageMap.setStringProperty("messageId", "-DomJMS030-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="0e88be3f-c412-4c1c-ae5e-af1997211c79"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(1,1,"-DomJMS030-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS030-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>39528860-d05b-4e06-963c-ab716f1edcbc</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS033-Submit Message-fromPartyId-fallBack" searchProperties="true" id="18e916c0-2b6e-4fd0-a47e-9c6b75b71ea2" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Update Default properties file" id="a7e69f5d-80d5-4ce3-99a7-79752aadf8a6"><con:settings/><con:config><script>def result=javax.swing.JOptionPane.showConfirmDialog( null,"Add line:\nfromPartyID = \"domibus-blue\"");
if(result == javax.swing.JOptionPane.YES_OPTION)
{
	log.info "continuing the test";
}
else if(result == javax.swing.JOptionPane.NO_OPTION)
{
	log.info "script aborted";
	testRunner.fail("Test aborted by user")
}</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="4304cb28-9411-4274-98bf-2b7a1d8c5423"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
//messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPCJMS")
messageMap.setStringProperty("protocol", "AS4")
messageMap.setStringProperty("messageId", "-DomJMS033-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="2eaa5c22-c30c-4f84-aa84-9235c93476d4"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(1,1,"-DomJMS033-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS033-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS035-Submit Message-fromPartyType-fallBack" searchProperties="true" id="64e4086a-64ac-4387-a83b-756f6fb2e516" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Update Default properties file" id="7e03fb62-cf66-476a-95b1-356aa01e4f6b"><con:settings/><con:config><script>def result=javax.swing.JOptionPane.showConfirmDialog( null,"Add line:\nfromPartyType = \"urn:oasis:names:tc:ebcore:partyid-type:unregistered\"");
if(result == javax.swing.JOptionPane.YES_OPTION)
{
	log.info "continuing the test";
}
else if(result == javax.swing.JOptionPane.NO_OPTION)
{
	log.info "script aborted";
	testRunner.fail("Test aborted by user")
}</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="37a4d2d4-85ed-4c4b-8777-ee78877ec25a"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
//messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPCJMS")
messageMap.setStringProperty("protocol", "AS4")
messageMap.setStringProperty("messageId", "-DomJMS035-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="29886356-c012-4215-88d6-e744415c56ae"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(1,1,"-DomJMS035-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS035-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>2c35fd83-f603-4585-94ed-29800a1e4fc4</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS037-Submit Message-toPartyId-fallBack" searchProperties="true" id="df0cdded-e885-4443-bfc4-7ca6784792fa" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Update Default properties file" id="7b27883a-c7bb-40f9-9622-95342edf13ee"><con:settings/><con:config><script>def result=javax.swing.JOptionPane.showConfirmDialog( null,"Add line:\ntoPartyID = \"domibus-red\"");
if(result == javax.swing.JOptionPane.YES_OPTION)
{
	log.info "continuing the test";
}
else if(result == javax.swing.JOptionPane.NO_OPTION)
{
	log.info "script aborted";
	testRunner.fail("Test aborted by user")
}</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="37eae58a-910e-42dc-8398-4d9e891e4678"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
//messageMap.setStringProperty("toPartyId", "domibus-red")
messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPCJMS")
messageMap.setStringProperty("protocol", "AS4")
messageMap.setStringProperty("messageId", "-DomJMS037-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="c4c6f0e1-8433-4dfe-93a1-6d5f8251556d"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(1,1,"-DomJMS037-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS037-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomJMS039-Submit Message-toPartyType-fallBack" searchProperties="true" id="76c132d2-c1a9-412a-9aa1-672da4a93bbb" disabled="true">
            <con:settings/>












            <con:testStep type="groovy" name="Update Default properties file" id="1beef9ee-efef-4a6c-a7c4-d926fa76da2d"><con:settings/><con:config><script>def result=javax.swing.JOptionPane.showConfirmDialog( null,"Add line:\ntoPartyType = \"urn:oasis:names:tc:ebcore:partyid-type:unregistered\"");
if(result == javax.swing.JOptionPane.YES_OPTION)
{
	log.info "continuing the test";
}
else if(result == javax.swing.JOptionPane.NO_OPTION)
{
	log.info "script aborted";
	testRunner.fail("Test aborted by user")
}</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="956aa314-f763-4c4e-a8fe-a56248369605"><con:settings/><con:config><script>import javax.jms.*
import eu.domibus.test.jms.DomibusJMSPlugin

def MapMessage messageMap = null
def domUtils = new eu.domibus.test.jms.DomibusJMSPlugin(log, context)
messageMap  = domUtils.jmsConnectionHandlerInitializeC2()

messageMap.setStringProperty("messageType", "submitMessage")
messageMap.setStringProperty("service", "bdx:noprocess")
messageMap.setStringProperty("serviceType", "tc10")
messageMap.setStringProperty("action", "TC10Leg1")
messageMap.setStringProperty("fromPartyId", "domibus-blue")
messageMap.setStringProperty("fromPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("toPartyId", "domibus-red")
//messageMap.setStringProperty("toPartyType", "urn:oasis:names:tc:ebcore:partyid-type:unregistered")
messageMap.setStringProperty("fromRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator")
messageMap.setStringProperty("toRole", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder")
messageMap.setStringProperty("originalSender", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
messageMap.setStringProperty("finalRecipient", "urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
messageMap.setStringProperty("mpc", "http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPCJMS")
messageMap.setStringProperty("protocol", "AS4")
messageMap.setStringProperty("messageId", "-DomJMS039-")

messageMap.setStringProperty("totalNumberOfPayloads", "1")
messageMap.setStringProperty("payload_1_mimeContentId", "cid:message")
messageMap.setStringProperty("payload_1_mimeType", "text/xml")
messageMap.setStringProperty("payload_1_description", "message")
String pay1 = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=";
byte[] payload = pay1.getBytes()
messageMap.setBytes("payload_1", payload)
domUtils.sendMessageAndClean(messageMap)
domUtils.finalize()</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="2170fd66-892a-4ca1-b062-076b82998dc3"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.verifyMessagePresence(1,1,"-DomJMS039-")
test.finalize()</script></con:config></con:testStep><con:tearDownScript>def test = new Domibus(log,null,context)
test.cleanDBMessageID("-DomJMS039-")
test.finalize()
Domibus.reportTestCaseCsv(testRunner, log)
</con:tearDownScript><con:properties/>
        <con:reportParameters/><con:breakPoints><con:testStepId>2eb6a89f-41c9-40f9-9d70-074e25d6ff5a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d1a0cbdd-efe1-412d-aac5-b62315a3ac06</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f84a4b44-9f2f-41e5-aeb5-ad4b50027daf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="212794ed-7238-43a9-bbe4-75c252b1943e" name="Multitenancy - playground" disabled="true"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="8fd78511-c17b-47a3-bcb9-9051b558e4ce" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX19-noMultitenancy-Backward Compatibility-Security disabled-jms" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configration" id="e03f49ef-d45c-464b-8827-9627e04c4904"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Multitenancy is not configured (No general schema specified).
- Set properties (multitenancyModeC2,multitenancyModeC3) to (0,0).
- Plugin security is disabled.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="a2b05f6a-2e97-4700-a7f9-731c32ab1a5a" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "0")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0")
log.info "multitenancyModeC2 custom property set to 0.";
log.info "multitenancyModeC3 custom property set to 0.";</script></con:config></con:testStep><con:testStep type="groovy" name="Disable plugin security" id="18d689ff-ac07-49bd-96ba-8cc881522b3e" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Disable plugin security for C2 and C3.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="9e32b0ac-768a-4276-94d7-9ff8bf40be15" disabled="true"><con:settings/><con:config><script>// Upload PModes: default Pmodes (blue for sender and red for receiver)
log.info "================================================";
log.info "================ Upload PModes for C2 ================";
log.info "================================================";
PModeUtils.uploadPmode("sender","default","\\blue\\domibus-pmode-blue.xml",context,log)
log.info "================================================";
log.info "================ Upload PModes for C3 ================";
log.info "================================================";
PModeUtils.uploadPmode("receiver","default","\\red\\domibus-pmode-red.xml",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststore" id="81f128c8-cb64-4c8f-8eec-8b6fcda576f7" disabled="true"><con:settings/><con:config><script>// Upload truststore for C2
TruststoreUtils.uploadTruststore("sender","default","\\blue\\gateway_truststore.jks",context,log)
// Upload truststore for C3
TruststoreUtils.uploadTruststore("receiver","default","\\red\\gateway_truststore.jks",context,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to FS" id="bb074728-1ac0-445a-8242-0b09e3a935b7" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","Jms",context,log)
// Select message filters for C3
Domibus.setMessageFilters("C3","Jms",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="be338c3d-be72-46bb-9c66-f9c376128c79"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\MAIN\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\MAIN\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\MAIN\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="c74639a8-5c7d-42a4-825e-0dfafb5d556b"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Check that the message is acknowledged.
""", log, testRunner) </script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="cf53314e-0ec0-4ac3-a0e0-22ef1ac9b1dc" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX32-noMultitenancy-Backward Compatibility-Security enabled-fs" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configration" id="ad70110f-8cea-4ee0-b898-babd32b339cd"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Multitenancy is not configured (No general schema specified).
- Set properties (multitenancyModeC2,multitenancyModeC3) to (0,0).
- Plugin security is enabled.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="dd5f0f2e-3bd1-4704-ae31-6f323f5ecc13" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "0")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0")
log.info "multitenancyModeC2 custom property set to 0.";
log.info "multitenancyModeC3 custom property set to 0.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="f751e020-7d26-44f1-b888-d591339df489" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for C2 and C3.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="f668eea1-798c-4aaf-8ad6-7a49f1ac5b49" disabled="true"><con:settings/><con:config><script>// Upload PModes: default Pmodes (blue for sender and red for receiver)
log.info "================================================";
log.info "================ Upload PModes for C2 ================";
log.info "================================================";
PModeUtils.uploadPmode("sender","default","\\blue\\domibus-pmode-blue.xml",context,log)
log.info "================================================";
log.info "================ Upload PModes for C3 ================";
log.info "================================================";
PModeUtils.uploadPmode("receiver","default","\\red\\domibus-pmode-red.xml",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststore" id="ed19ec3f-9441-4150-a97f-edabe8626965" disabled="true"><con:settings/><con:config><script>// Upload truststore for C2
TruststoreUtils.uploadTruststore("sender","default","\\blue\\gateway_truststore.jks",context,log)
// Upload truststore for C3
TruststoreUtils.uploadTruststore("receiver","default","\\red\\gateway_truststore.jks",context,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to FS" id="1cf79b6f-f099-4973-b231-72e5b69e6c53" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendFSPlugin",context,log)
// Select message filters for C3
Domibus.setMessageFilters("C3","backendFSPlugin",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="d26f6a04-0e36-44f9-bf5d-84a593be859e"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\MAIN\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\MAIN\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\MAIN\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="28be59fa-5266-4f65-8cfe-23be34424751"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Check that the message is acknowledged.
""", log, testRunner) </script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="475cda04-7790-4488-ac68-20e25214a005" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX33-Multitenancy-Backward Compatibility-Default domain-fs" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configration" id="8f3c48d1-2290-41d4-b31e-6f365ee2f68f"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- general schema is created.
- Multitenancy is configured for C2.
- Set properties (multitenancyModeC2,multitenancyModeC3) to (0,0).
- Plugin security is enabled.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="5b18ccb2-a8bc-469b-915d-f1ae15068891" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "0")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0")
log.info "multitenancyModeC2 custom property set to 0.";
log.info "multitenancyModeC3 custom property set to 0.";</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="ed96ccc7-3e9b-4064-b21d-7abb995f12a8" disabled="true"><con:settings/><con:config><script>// Upload PModes: default Pmodes (blue for sender and red for receiver)
log.info "================================================";
log.info "================ Upload PModes for C2 ================";
log.info "================================================";
PModeUtils.uploadPmode("sender","default","\\blue\\domibus-pmode-blue.xml",context,log,"Default","successfully",null,"super","DomibusEdel-12345")
log.info "================================================";
log.info "================ Upload PModes for C3 ================";
log.info "================================================";
PModeUtils.uploadPmode("receiver","default","\\red\\domibus-pmode-red.xml",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststore" id="d73fea49-5cd8-4608-ad3b-2b40291f9c7e" disabled="true"><con:settings/><con:config><script>// Upload truststore for C2
TruststoreUtils.uploadTruststore("sender","default","\\blue\\gateway_truststore.jks",context,log, "Default", "successfully","test123", "super","DomibusEdel-12345")
// Upload truststore for C3
TruststoreUtils.uploadTruststore("receiver","default","\\red\\gateway_truststore.jks",context,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to FS" id="282044c8-a235-4f24-b986-67e94d79696b" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"Default", null, "super", "123456")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendFSPlugin",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="1e89c71e-c630-4856-a51e-6468ba9b4855"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\MAIN\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\MAIN\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\MAIN\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="69b5822e-a984-4271-9fc1-a4ce93044007"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Check that the message is acknowledged.
""", log, testRunner) </script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="7028849b-5899-415e-8b9e-6c281c2f6a7d" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX34-Multitenancy-Tenant selection-Outgoing message-Default properties-fs" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="6fc440a3-5ea5-44ce-abe5-32c578b51211"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Plugin security is enabled for C2.
- domain "domibus_C2Dom1" is configured for C2.
- No specific properties present for the domain domibus_C2Dom1 (except for mandatory Keystore/Truststore properties).
- Multitenany is not configured for C3.
- Set properties (multitenancyModeC2,multitenancyModeC3) to (1,0).
- Create plugin authentication user on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1".
- Create plugin authentication user on C3: "userC4" linked to "finalRecipient".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="54567036-f3d0-45a0-bae3-5eb287350bf5" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "1")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0")
log.info "multitenancyModeC2 custom property set to 1.";
log.info "multitenancyModeC3 custom property set to 0.";</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="21acadfe-fbae-4772-b016-dbc79c289272" disabled="true"><con:settings/><con:config><script>// Create userC1 in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
// Create userC4 in C3
Domibus.addPluginUser("red",context,log,"Default","ROLE_USER","userC4","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="9b8c0431-d9f1-430a-b838-3293de917148" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="10262c95-8877-41b9-85b4-7599a940a765" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filter FS" id="be9a25df-94f3-40f2-b179-4f852973116d" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom1")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendFSPlugin",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="5e2fa59c-6907-435c-b22f-52ffd125a0f3"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="852c4b8b-a336-43d4-8251-8c0b089b4fd5"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Check that the message is submitted.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="7994aa99-d53c-45d0-9f55-bece748b1a52" disabled="true"><con:settings/><con:config><script>// Remove userC1 in C2
Domibus.removePluginUser("blue",context,log,"domibus_C2Dom1","userC1C2Dom1")
// Remove userC4 in C3
Domibus.removePluginUser("blue",context,log,"Default","userC4");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="25f53527-7d4d-42d0-9bbd-a6245b7102c5" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomXX5-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="153a7e24-85b7-421c-a640-41451d8bdb93" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX35-Multitenancy-Tenant selection-Outgoing message-Select correct-fs" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="175970d3-a42c-443b-9486-4e68fbb07784"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Plugin security is enabled for C2.
- domain "domibus_C2Dom1" is configured for C2.
- Multitenany is not configured for C3.
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,0).
- Create plugin authentication user on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1".
- Create plugin authentication user on C3: "userC4" linked to "finalRecipient".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="50494d8c-d2c7-4196-b2c9-86d7246efd64" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 0.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="c757decc-5e05-4c8f-8004-46f50836da75" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for C2.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="a068c054-30e5-47b1-9a45-39c996d62ff2" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"Default","ROLE_USER","userC1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1","super","123456")
// Create users in C3
Domibus.addPluginUser("red",context,log,"Default","ROLE_USER","userC4","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="d17941c7-83e2-4282-95d0-b00ad8f15cb3" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="fb378766-1b11-4c22-aa94-254e7f9c2c54" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filter FS" id="113c5d3f-0f9d-41ac-9c1e-70747d192dcc" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom2")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendFSPlugin",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="3e361d10-ddb3-4fd5-9983-8d6b99d74fea"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="b23bf971-2ff4-40fd-9b8e-ee51e1ed3b17"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Check that the message is acknowledged.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="738eaf92-799b-4a26-a5c9-fae721b59680" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomXX5-'))
test.finalize()
</script></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="3e2eae07-d183-4437-8801-117453e2f06b" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2")
// Remove userC4 in C3
Domibus.removePluginUser("blue",context,log,"Default","userC4");</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="02f78ae9-aab0-44b5-8323-6306820d507b" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX36-Multitenancy-Tenant selection-Outgoing message-Select wrong-fs" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="7f20a47f-b253-4dde-9a7b-297c6e8267d8"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Plugin security is enabled for C2.
- domain "domibus_C2Dom1" is configured for C2.
- Multitenany is not configured for C3.
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,0).
- Create plugin authentication user on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1".
- Create plugin authentication user on C3: "userC4" linked to "finalRecipient".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="a9908602-fffd-40dd-b1dc-d4582876e62c" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 0.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="8abca31b-977a-497a-ac1c-9b7de39980d9" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for C2.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="877511c9-d7fc-4a07-8130-3854aa96ef80" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
// Create users in C3
Domibus.addPluginUser("red",context,log,"Default","ROLE_USER","userC4","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="b59e8c39-635e-49cd-9af3-00064dd638b7" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="790f0e25-f5dc-4974-a0e4-2d7bf06b6a17" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filter FS" id="2bd3d61a-5586-4e97-bcde-fe3878ccff3b" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom2")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendFSPlugin",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="02dc4e14-13ca-4612-a39f-ec7f13f57122"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom2\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom2\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom2\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="c2bc71bf-74cd-411c-9308-c7b87ef665a8"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Check that the message is not submitted.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="6524f607-a0ca-466d-b309-5187a9aeb780" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomXX5-'))
test.finalize()
</script></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="bad51869-094c-4f39-ac0c-8b996c1b2c17" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2")
// Remove userC4 in C3
Domibus.removePluginUser("blue",context,log,"Default","userC4");</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="fa75e6cd-c64f-4b7d-b823-e99b91954dd7" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX37-Multitenancy-Tenant selection-Outgoing message-Domain name length-Min-fs" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="5b910f9e-96af-4622-a5c0-2a36a553713b"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Plugin security is enabled for C2.
- domain with name "a" is configured for C2.
- Multitenany is not configured for C3.
- Set properties (multitenancyModeC2,multitenancyModeC3) to (3,0).
- Create plugin authentication user on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1".
- Create plugin authentication user on C2: "userC1C2Dom3" linked to "originalSender" and domain "a".
- Create plugin authentication user on C3: "userC4" linked to "finalRecipient".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="75f8e987-e66d-4b02-bbe1-b35b09e349dc" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "3")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0")
log.info "multitenancyModeC2 custom property set to 3.";
log.info "multitenancyModeC3 custom property set to 0.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="2df822f0-f696-460f-b48b-73b158411391" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for C2.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="c05d044b-9905-422c-8d24-822a0cf1950c" disabled="true"><con:settings/><con:config><script>// Create userC1 in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"a","ROLE_USER","userC1C2Dom3","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")

// Create userC4 in C3
Domibus.addPluginUser("red",context,log,"Default","ROLE_USER","userC4","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="6daee2b7-fc8c-4896-aad9-b32766e84da6" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"a")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="100c26d1-a1c2-4274-ab39-28c39a3bc8e9" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"a")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filter FS" id="b993ed5a-f35d-4da4-aa94-2e5de389ad03" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"a")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendWebservice",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="ad1c22b6-e436-44d0-a776-88e92e58aade"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\a\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\a\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\a\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="a5710820-f0e6-4598-b93a-2226c189dd3c"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Check that the message is acknowledged.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="acd95004-a446-4c59-9948-dfce1bce9c3f" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("blue",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("blue",context,log,"a","userC1C2Dom3")
// Remove users in C3
Domibus.removePluginUser("blue",context,log,"Default","userC4");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="f1bf2b39-9d90-4a2e-895e-31b68969d37f" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX37-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="f2f86fa1-a5f6-41ac-aa51-8158fa5a416a" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX38-Multitenancy-Tenant selection-Outgoing message-Domain name length-Max limit-fs" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="77fb31ea-b50f-4434-bf3f-ebcd056307f2"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Plugin security is enabled for C2.
- domain with name.length=50 is configured for C2 (domain_equal_max).
- Multitenany is not configured for C3.
- Set properties (multitenancyModeC2,multitenancyModeC3) to (3,0).
- Create plugin authentication user on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1".
- Create plugin authentication user on C2: "userC1C2Dom3" linked to "originalSender" and domain "domain_equal_max".
- Create plugin authentication user on C3: "userC4" linked to "finalRecipient".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="9924115e-ed38-4a3f-b90e-ecf8a48885f8" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for C2.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="d50b5704-5491-4b4d-bdbd-b195836e1d34" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "3")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0")
log.info "multitenancyModeC2 custom property set to 3.";
log.info "multitenancyModeC3 custom property set to 0.";</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="c2e0c535-6869-4959-804c-f369e388a3dc" disabled="true"><con:settings/><con:config><script>// Create userC1 in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"length_equal_50_aaaabbbbbbbbbbbbbbbbbbbbcccccccccc","ROLE_USER","userC1C2Dom3","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")

// Create userC4 in C3
Domibus.addPluginUser("red",context,log,"Default","ROLE_USER","userC4","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="b484e25e-ba83-435c-b147-fb8eaf7d0901" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"length_equal_50_aaaabbbbbbbbbbbbbbbbbbbbcccccccccc")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="d1d54f9b-958a-4487-bccd-eefaba30de3d" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"length_equal_50_aaaabbbbbbbbbbbbbbbbbbbbcccccccccc")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filter FS" id="0ad7c861-025f-4afb-a6f3-588262b9edc1" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"length_equal_50_aaaabbbbbbbbbbbbbbbbbbbbcccccccccc")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendFSPlugin",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="74b2771e-a8f0-4cdf-bedf-e7135db23ad7"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\length_equal_50_aaaabbbbbbbbbbbbbbbbbbbbcccccccccc\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\length_equal_50_aaaabbbbbbbbbbbbbbbbbbbbcccccccccc\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\length_equal_50_aaaabbbbbbbbbbbbbbbbbbbbcccccccccc\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="f6fb1475-0963-49e0-bd6c-141ee3bfd663"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Check that the message is acknowledged.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="8da933e8-d086-4e7d-b374-2222e1297d29" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("blue",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("blue",context,log,"length_equal_50_aaaabbbbbbbbbbbbbbbbbbbbcccccccccc","userC1C2Dom3")
// Remove users in C3
Domibus.removePluginUser("blue",context,log,"Default","userC4");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="511821fc-285a-475e-a35b-e3b3b94f6a46" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX38-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="d1562ac4-451a-4996-8415-c67cf3c86fd0" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX41-Multitenancy-Tenant selection-Outgoing message-Basic flow-fs" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="4f4d92a8-ed39-4faa-a06c-27606e9e86b6"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Configure Multitenancy for C2 and C3 (enable plugin security, create domain properties file, create domain schema ...)
- Domains "domibus_C2Dom1" and "domibus_C2Dom2" are configured for C2.
- Domains "domibus_C3Dom1" and "domibus_C3Dom2" are configured for C3.
- Create plugin users on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1", "userC1C2Dom2" linked to "originalSender" and domain "domibus_C2Dom2".
- Create plugin users on C3: "userC4C3Dom1" linked to "originalSender" and domain "domibus_C3Dom1", "userC4C3Dom2" linked to "originalSender" and domain "domibus_C3Dom2".
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,2).
- Certificate configured on domain "domibus_C2Dom1" is only present in the truststore of domain "domibus_C3Dom2".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="865fccef-3d0f-4598-9aa8-c204f2bfd51c" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "2")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 2.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="8cb691aa-7d31-42ec-b09b-cb8cded71d50" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for both C2 and C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="6ec8bcb0-462a-495c-ae16-2ca02e5b6148" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
// Create users in C3
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom1","ROLE_USER","userC4C3Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom2","ROLE_USER","userC4C3Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="3d17ab48-08c7-485a-bd07-e3b639a5e7c1" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log,"domibus_C3Dom1")
PModeUtils.uploadPmode("C3","default","\\red\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-red.xml",context,log,"domibus_C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="279017c1-b085-49f1-b456-f5c33cefdc0e" disabled="true"><con:settings/><con:config><script>// Upload truststores

// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","special","\\Threegateways\\blue\\gateway_truststore.jks",context,log,"domibus_C3Dom1")
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to FS" id="de0e1784-ab2a-4a61-9b5d-425ef1b676fb" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom2")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendFSPlugin",context,log,"domibus_C3Dom1")
Domibus.setMessageFilters("C3","backendFSPlugin",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="a0340fbf-57e7-40a8-9662-4f2c69ba0237"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="5c501d4e-0a3a-4fb0-b707-8b66666bc44d"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Check that the message is acknowledged.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="ede30ef1-38af-4abe-b06f-e9d4e848e754" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2")
// Remove users in C3
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom1")
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="b6b8bccc-fc31-45a4-8cf5-bd2411877e01" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX41-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="71bf86fe-2835-464f-b9b0-5025b589a6a0" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX42-Multitenancy-Tenant selection-Incoming message-Domain found-ws" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="425c06dc-cea3-44d9-b10f-786b5e39d7fb"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Configure Multitenancy for C2 and C3 (enable plugin security, create domain properties file, create domain schema ...)
- Domains "domibus_C2Dom1" and "domibus_C2Dom2" are configured for C2.
- Domains "domibus_C3Dom1" and "domibus_C3Dom2" are configured for C3.
- Create plugin users on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1", "userC1C2Dom2" linked to "originalSender" and domain "domibus_C2Dom2".
- Create plugin users on C3: "userC4C3Dom1" linked to "originalSender" and domain "domibus_C3Dom1", "userC4C3Dom2" linked to "originalSender" and domain "domibus_C3Dom2".
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,2).
- Certificate configured on domain "domibus_C2Dom1" is only present in the truststore of domain "domibus_C3Dom2".
- Upload PModes in C2 and C3. Append strings: “?domain=domibus_C2Dom1” to the endpoint of C2 and “?domain=domibus_C3Dom2” to the endpoint of C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="4edd4473-6a79-4095-ab8e-69cb8824303d" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "2")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 2.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="6bbb4d02-50ba-4192-89e5-c41281d8da0c" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for both C2 and C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="1d3a178f-94af-47fc-a6b3-02b2b28eca91" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
// Create users in C3
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom1","ROLE_USER","userC4C3Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom2","ROLE_USER","userC4C3Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="11c54cb5-c874-4187-a6f4-736d186e38b0" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log,"domibus_C3Dom1")
PModeUtils.uploadPmode("C3","default","\\red\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-red.xml",context,log,"domibus_C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="c665d28f-d61e-4380-b237-46092ed93022" disabled="true"><con:settings/><con:config><script>// Upload truststores

// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","special","\\Threegateways\\blue\\gateway_truststore.jks",context,log,"domibus_C3Dom1")
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to WS" id="750fa41f-1b7d-4dad-a4b0-fc6173f8e489" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
//Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom1")
//Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom2")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendWebservice",context,log,"domibus_C3Dom1")
Domibus.setMessageFilters("C3","backendWebservice",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="request" id="657f1752-a85f-43ee-a4fe-ce6d52c56967" name="Submit Message"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>submitMessage</con:operation><con:request name="Submit Message" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="e022ccff-cc86-4b74-9723-3e474bc04cd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:_1="http://org.ecodex.backend/1_1/" xmlns:xm="http://www.w3.org/2005/05/xmlmime">
   <soap:Header>
      <ns:Messaging>
         <ns:UserMessage>
            <ns:MessageInfo>
               <ns:MessageId>-DomX42-</ns:MessageId>
            </ns:MessageInfo>
            <ns:PartyInfo>
               <ns:From>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-blue</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator</ns:Role>
               </ns:From>
               <ns:To>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-red</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder</ns:Role>
               </ns:To>
            </ns:PartyInfo>
            <ns:CollaborationInfo>
               <ns:Service type="tc1">bdx:noprocess</ns:Service>
               <ns:Action>TC1Leg1</ns:Action>
            </ns:CollaborationInfo>
            <ns:MessageProperties>
               <ns:Property name="originalSender">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1</ns:Property>
               <ns:Property name="finalRecipient">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4</ns:Property>
            </ns:MessageProperties>
            <ns:PayloadInfo>
               <ns:PartInfo href="cid:message">
                  <ns:PartProperties>
                     <ns:Property name="MimeType">text/xml</ns:Property>
                  </ns:PartProperties>
               </ns:PartInfo>
            </ns:PayloadInfo>
         </ns:UserMessage>
      </ns:Messaging>
   </soap:Header>
   <soap:Body>
      <_1:submitRequest>
         <payload payloadId="cid:message">
            <value>PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=</value>
         </payload>
      </_1:submitRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="55691702-a96e-4270-b659-69659336509f" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="0437d1bc-ceaa-4c63-8cdd-a8d9332f02db" name="Not SOAP Fault"/><con:assertion type="GroovyScriptAssertion" id="8bfe8083-e19c-452d-8980-86635b045d8b" name="Script Assertion"><con:configuration><scriptText>def test = new Domibus(log,messageExchange,context)
test.waitForStatus("ACKNOWLEDGED", "RECEIVED", null, null, null, "C2Dom1", "C3Dom2")
test.finalize()</scriptText></con:configuration></con:assertion><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/submitMessage"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="347e0d43-0420-4859-a6ab-cdab085ba37d" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2")
// Remove users in C3
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom1")
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="a76a02a6-e248-4632-b316-40e932ddee01" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX42-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="4b60e717-fdf8-4a97-8169-7134ca093d7e" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX43-Multitenancy-Tenant selection-Incoming message-Domain not found-ws" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="262cc19b-48c8-433b-8ead-4c1981758b98"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Configure Multitenancy for C2 and C3 (enable plugin security, create domain properties file, create domain schema ...)
- Domains "domibus_C2Dom1" and "domibus_C2Dom2" are configured for C2.
- Domains "domibus_C3Dom1" and "domibus_C3Dom2" are configured for C3.
- Create plugin users on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1", "userC1C2Dom2" linked to "originalSender" and domain "domibus_C2Dom2".
- Create plugin users on C3: "userC4C3Dom1" linked to "originalSender" and domain "domibus_C3Dom1", "userC4C3Dom2" linked to "originalSender" and domain "domibus_C3Dom2".
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,2).
- Certificate configured on domain "domibus_C2Dom1" is only present in the truststore of domain "domibus_C3Dom2".
- Upload PModes in C2 and C3. For PModes uploaded to C2, append strings: “?domain=domibus_C2Dom1” to the endpoint of C2 and “?domain=domibus_C3Random” to the endpoint of C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="6e78473e-b0ca-41ed-ba2e-38c0a1615358" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "2")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 2.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="59292f0d-05ce-4b29-abb9-e61ab89f88c8" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for both C2 and C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="fecfb57d-943e-43b4-b662-6f78dde4037e" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
// Create users in C3
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom1","ROLE_USER","userC4C3Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom2","ROLE_USER","userC4C3Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="5638f2b0-e766-4d56-9f5a-6a7d3e7e2675" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\randomC3Domain\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log,"domibus_C3Dom1")
PModeUtils.uploadPmode("C3","default","\\red\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-red.xml",context,log,"domibus_C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="7bb02e6a-7d30-4e80-bb3e-241889411dfb" disabled="true"><con:settings/><con:config><script>// Upload truststores

// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","special","\\Threegateways\\blue\\gateway_truststore.jks",context,log,"domibus_C3Dom1")
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to WS" id="d22f651c-bb61-41a8-9395-524a8678b07a" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom2")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendWebservice",context,log,"domibus_C3Dom1")
Domibus.setMessageFilters("C3","backendWebservice",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="request" id="c91239cc-5427-4407-841e-c2551edb997f" name="Submit Message"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>submitMessage</con:operation><con:request name="Submit Message" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="e022ccff-cc86-4b74-9723-3e474bc04cd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:_1="http://org.ecodex.backend/1_1/" xmlns:xm="http://www.w3.org/2005/05/xmlmime">
   <soap:Header>
      <ns:Messaging>
         <ns:UserMessage>
            <ns:MessageInfo>
               <ns:MessageId>-DomX43-</ns:MessageId>
            </ns:MessageInfo>
            <ns:PartyInfo>
               <ns:From>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-blue</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator</ns:Role>
               </ns:From>
               <ns:To>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-red</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder</ns:Role>
               </ns:To>
            </ns:PartyInfo>
            <ns:CollaborationInfo>
               <ns:Service type="tc1">bdx:noprocess</ns:Service>
               <ns:Action>TC1Leg1</ns:Action>
            </ns:CollaborationInfo>
            <ns:MessageProperties>
               <ns:Property name="originalSender">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1</ns:Property>
               <ns:Property name="finalRecipient">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4</ns:Property>
            </ns:MessageProperties>
            <ns:PayloadInfo>
               <ns:PartInfo href="cid:message">
                  <ns:PartProperties>
                     <ns:Property name="MimeType">text/xml</ns:Property>
                  </ns:PartProperties>
               </ns:PartInfo>
            </ns:PayloadInfo>
         </ns:UserMessage>
      </ns:Messaging>
   </soap:Header>
   <soap:Body>
      <_1:submitRequest>
         <payload payloadId="cid:message">
            <value>PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=</value>
         </payload>
      </_1:submitRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="55691702-a96e-4270-b659-69659336509f" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="0437d1bc-ceaa-4c63-8cdd-a8d9332f02db" name="Not SOAP Fault"/><con:assertion type="GroovyScriptAssertion" id="8bfe8083-e19c-452d-8980-86635b045d8b" name="Script Assertion"><con:configuration><scriptText>def test = new Domibus(log,messageExchange,context)
test.waitForStatus("WAITING_FOR_RETRY", "", null, null, null, "C2Dom1", "C3Dom2")
test.finalize()</scriptText></con:configuration></con:assertion><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/submitMessage"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="31e8c851-cb2f-4c11-abc9-964edd0980cd" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2")
// Remove users in C3
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom1")
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="e4da1bbd-a22e-4497-94f3-46fda6cae208" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX43-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="b0df6a88-b852-420f-bd91-05f916fdd0e6" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX44-Multitenancy-Tenant selection-Incoming message-Domain wrong-ws" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="c32f7251-4fc2-415a-9e6c-b414f744d9d2"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Configure Multitenancy for C2 and C3 (enable plugin security, create domain properties file, create domain schema ...)
- Domains "domibus_C2Dom1" and "domibus_C2Dom2" are configured for C2.
- Domains "domibus_C3Dom1" and "domibus_C3Dom2" are configured for C3.
- Create plugin users on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1", "userC1C2Dom2" linked to "originalSender" and domain "domibus_C2Dom2".
- Create plugin users on C3: "userC4C3Dom1" linked to "originalSender" and domain "domibus_C3Dom1", "userC4C3Dom2" linked to "originalSender" and domain "domibus_C3Dom2".
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,2).
- Certificate configured on domain "domibus_C2Dom1" is only present in the truststore of domain "domibus_C3Dom2".
- Upload PModes in C2 and C3. Append strings: “?domain=domibus_C2Dom1” to the endpoint of C2 and “?domain=domibus_C3Dom1” to the endpoint of C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="6b842cb4-44f5-4e6f-b9e6-9afd44d84259" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "2")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 2.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="a61c6cd3-d9d7-42bc-a1c2-d8cf6e5dcca8" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for both C2 and C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="2b5915a5-3a58-43b5-bfe2-4c4367c1e8d9" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
// Create users in C3
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom1","ROLE_USER","userC4C3Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom2","ROLE_USER","userC4C3Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="7e26092c-fb33-4d91-8594-d3af46ef8cc9" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC3Dom1\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log,"domibus_C3Dom1")
PModeUtils.uploadPmode("C3","default","\\red\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-red.xml",context,log,"domibus_C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="e73d4c19-61af-4726-9379-9c38a810caae" disabled="true"><con:settings/><con:config><script>// Upload truststores

// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","special","\\Threegateways\\blue\\gateway_truststore.jks",context,log,"domibus_C3Dom1")
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to WS" id="db21608b-bf9d-482a-89ec-6652bed85cc4" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom2")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendWebservice",context,log,"domibus_C3Dom1")
Domibus.setMessageFilters("C3","backendWebservice",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="request" id="09ffc5b7-864d-4e55-8225-0e68f31fcc00" name="Submit Message"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>submitMessage</con:operation><con:request name="Submit Message" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="e022ccff-cc86-4b74-9723-3e474bc04cd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:_1="http://org.ecodex.backend/1_1/" xmlns:xm="http://www.w3.org/2005/05/xmlmime">
   <soap:Header>
      <ns:Messaging>
         <ns:UserMessage>
            <ns:MessageInfo>
               <ns:MessageId>-DomX44-</ns:MessageId>
            </ns:MessageInfo>
            <ns:PartyInfo>
               <ns:From>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-blue</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator</ns:Role>
               </ns:From>
               <ns:To>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-red</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder</ns:Role>
               </ns:To>
            </ns:PartyInfo>
            <ns:CollaborationInfo>
               <ns:Service type="tc1">bdx:noprocess</ns:Service>
               <ns:Action>TC1Leg1</ns:Action>
            </ns:CollaborationInfo>
            <ns:MessageProperties>
               <ns:Property name="originalSender">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1</ns:Property>
               <ns:Property name="finalRecipient">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4</ns:Property>
            </ns:MessageProperties>
            <ns:PayloadInfo>
               <ns:PartInfo href="cid:message">
                  <ns:PartProperties>
                     <ns:Property name="MimeType">text/xml</ns:Property>
                  </ns:PartProperties>
               </ns:PartInfo>
            </ns:PayloadInfo>
         </ns:UserMessage>
      </ns:Messaging>
   </soap:Header>
   <soap:Body>
      <_1:submitRequest>
         <payload payloadId="cid:message">
            <value>PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=</value>
         </payload>
      </_1:submitRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="55691702-a96e-4270-b659-69659336509f" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="0437d1bc-ceaa-4c63-8cdd-a8d9332f02db" name="Not SOAP Fault"/><con:assertion type="GroovyScriptAssertion" id="8bfe8083-e19c-452d-8980-86635b045d8b" name="Script Assertion"><con:configuration><scriptText>def test = new Domibus(log,messageExchange,context)
test.waitForStatus("WAITING_FOR_RETRY", "", null, null, null, "C2Dom1", "C3Dom2")
test.finalize()</scriptText></con:configuration></con:assertion><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/submitMessage"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="0aec7ecd-9240-40ed-aaa7-e228b30bd9d0" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2")
// Remove users in C3
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom1")
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="d88d5255-46b7-47e9-8ee4-5957b448a9cc" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX44-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="bce67c51-28fd-4d8f-9b14-fc34d8be9e94" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX48-Multitenancy-Tenant selection-Incoming message-Domain found-fs" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="7d52b2a9-270d-4f68-822b-09ed370fa5e4"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Configure Multitenancy for C2 and C3 (enable plugin security, create domain properties file, create domain schema ...)
- Domains "domibus_C2Dom1" and "domibus_C2Dom2" are configured for C2.
- Domains "domibus_C3Dom1" and "domibus_C3Dom2" are configured for C3.
- Create plugin users on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1", "userC1C2Dom2" linked to "originalSender" and domain "domibus_C2Dom2".
- Create plugin users on C3: "userC4C3Dom1" linked to "originalSender" and domain "domibus_C3Dom1", "userC4C3Dom2" linked to "originalSender" and domain "domibus_C3Dom2".
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,2).
- Certificate configured on domain "domibus_C2Dom1" is only present in the truststore of domain "domibus_C3Dom2".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="dcef78c1-2433-47d8-803c-4dbc33a9a25f" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "2")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 2.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="56b40169-49aa-4b0d-9d1a-4ddf09a63a4a" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for both C2 and C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="c53b626c-e2db-45e6-b76b-d2fa9e000f56" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
// Create users in C3
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom1","ROLE_USER","userC4C3Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom2","ROLE_USER","userC4C3Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="b6caed6b-678b-409d-b4a9-9c5a6116efc6" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log,"domibus_C3Dom1")
PModeUtils.uploadPmode("C3","default","\\red\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-red.xml",context,log,"domibus_C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="45df6d56-48c7-41f1-9e55-4451a183d559" disabled="true"><con:settings/><con:config><script>// Upload truststores

// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","special","\\Threegateways\\blue\\gateway_truststore.jks",context,log,"domibus_C3Dom1")
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to FS" id="25c71d9b-d480-4c21-a6b0-8c5f092896b7" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom2")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendFSPlugin",context,log,"domibus_C3Dom1")
Domibus.setMessageFilters("C3","backendFSPlugin",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="da2f73bb-a763-4ff1-8a13-aae2e4e3ccec"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="b800f122-9e6a-4dd7-a9f6-332c2fe73cb8"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Check that the message is acknowledged.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="f65408e4-8d1f-41fa-b82a-d9a0f04c70af" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2")
// Remove users in C3
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom1")
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="2bae96f9-08d0-46b4-b2eb-36408ab357ad" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX48-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="d6b89219-4bc5-477a-85f8-bb70dd58e572" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX49-Multitenancy-Tenant selection-Incoming message-Domain not found-fs" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="bffda557-1fe5-49b9-a39b-666110717203"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Configure Multitenancy for C2 and C3 (enable plugin security, create domain properties file, create domain schema ...)
- Domains "domibus_C2Dom1" and "domibus_C2Dom2" are configured for C2.
- Domains "domibus_C3Dom1" and "domibus_C3Dom2" are configured for C3.
- Create plugin users on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1", "userC1C2Dom2" linked to "originalSender" and domain "domibus_C2Dom2".
- Create plugin users on C3: "userC4C3Dom1" linked to "originalSender" and domain "domibus_C3Dom1", "userC4C3Dom2" linked to "originalSender" and domain "domibus_C3Dom2".
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,2).
- Certificate configured on domain "domibus_C2Dom1" is only present in the truststore of domain "domibus_C3Dom2".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="15ac3836-87f2-4bd3-ae0f-abe27ada2c7b" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "2")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 2.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="0425626b-aefe-42bd-951e-3c594b8e4b7d" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for both C2 and C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="694b80ec-31d4-462c-bd64-926bb86063aa" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
// Create users in C3
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom1","ROLE_USER","userC4C3Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom2","ROLE_USER","userC4C3Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="4f11a5e8-1f59-45c1-a3b5-e891f63a96a5" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\randomC3Domain\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log,"domibus_C3Dom1")
PModeUtils.uploadPmode("C3","default","\\red\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-red.xml",context,log,"domibus_C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="a039c84f-270e-4d45-b1ba-215ca0a8f16a" disabled="true"><con:settings/><con:config><script>// Upload truststores

// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","special","\\Threegateways\\blue\\gateway_truststore.jks",context,log,"domibus_C3Dom1")
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to FS" id="0a0fca07-489c-41b8-a268-82808bec5760" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom2")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendFSPlugin",context,log,"domibus_C3Dom1")
Domibus.setMessageFilters("C3","backendFSPlugin",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="65428a56-c29d-4809-acb7-5715f76238fe"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="09569a6a-19ad-444c-9904-6966f3fe3d78"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Check that the message is not acknowledged.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="3cbad18d-62e0-42ca-b90e-d476bed0d68f" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2")
// Remove users in C3
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom1")
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="bd983ac7-4f29-4fa2-b03c-8b5e0ea17944" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX48-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="bd8b4f90-3d97-445a-87ce-c3c6b921c2a0" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX50-Multitenancy-Tenant selection-Incoming message-Domain wrong-fs" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="df0c60c5-26a2-4227-8d3d-613210209dd2"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Configure Multitenancy for C2 and C3 (enable plugin security, create domain properties file, create domain schema ...)
- Domains "domibus_C2Dom1" and "domibus_C2Dom2" are configured for C2.
- Domains "domibus_C3Dom1" and "domibus_C3Dom2" are configured for C3.
- Create plugin users on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1", "userC1C2Dom2" linked to "originalSender" and domain "domibus_C2Dom2".
- Create plugin users on C3: "userC4C3Dom1" linked to "originalSender" and domain "domibus_C3Dom1", "userC4C3Dom2" linked to "originalSender" and domain "domibus_C3Dom2".
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,2).
- Certificate configured on domain "domibus_C2Dom1" is only present in the truststore of domain "domibus_C3Dom2".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="a50120d5-aeff-4a79-99a2-a42529ca22ef" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "2")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 2.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="e30a1ad5-c39a-4cb6-8978-85de7a8a2ae5" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for both C2 and C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="c4ef770f-b4de-4b8f-820b-3f233c3524c2" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
// Create users in C3
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom1","ROLE_USER","userC4C3Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom2","ROLE_USER","userC4C3Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="33fc2d80-f06b-4903-bf87-813919670e43" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC3Dom1\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log,"domibus_C3Dom1")
PModeUtils.uploadPmode("C3","default","\\red\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-red.xml",context,log,"domibus_C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="e53d1bc3-cec4-4380-b589-28278807f827" disabled="true"><con:settings/><con:config><script>// Upload truststores

// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","special","\\Threegateways\\blue\\gateway_truststore.jks",context,log,"domibus_C3Dom1")
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to FS" id="733b3db4-f304-46db-bdac-0522c32a7be2" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom2")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendFSPlugin",context,log,"domibus_C3Dom1")
Domibus.setMessageFilters("C3","backendFSPlugin",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="124903de-8849-4b83-9d90-ea427e9d6f14"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="d6878d46-cfa9-489d-b200-2ac3184790df"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Check that the message is not acknowledged.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="b2cf7306-b43a-43d6-94e4-41f2863d98d5" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2")
// Remove users in C3
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom1")
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="c34076b8-3d87-4cf0-b051-dd07da24f199" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX48-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="ae1fbaaf-c6cc-4156-a852-bbca32c66cbd" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX51-Multitenancy-Tenant selection-Incoming message-Domains-folder-Creation-fs" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="7ed40a98-00b7-4a2f-bb96-2a8fc5b6e029"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Configure Multitenancy for C2 and C3 (enable plugin security, create domain properties file, create domain schema ...)
- Domains "domibus_C2Dom1" and "domibus_C2Dom2" are configured for C2.
- Domains "domibus_C3Dom1" and "domibus_C3Dom2" are configured for C3.
- Create plugin users on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1", "userC1C2Dom2" linked to "originalSender" and domain "domibus_C2Dom2".
- Create plugin users on C3: "userC4C3Dom1" linked to "originalSender" and domain "domibus_C3Dom1", "userC4C3Dom2" linked to "originalSender" and domain "domibus_C3Dom2".
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,2).
- Certificate configured on domain "domibus_C2Dom1" is present in the truststore of domain "domibus_C3Dom1" and "domibus_C3Dom2".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="0091d69e-119d-477b-b7bb-18f67075b9ed" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "2")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 2.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="1c7cca53-21c6-4f36-8d79-7924c433f3f6" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for both C2 and C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="a5494e48-9956-4cec-a93d-96bcb0ca8d83" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
// Create users in C3
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom1","ROLE_USER","userC4C3Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom2","ROLE_USER","userC4C3Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes 1" id="06db0a75-4a61-47bb-a34b-fd5b876c039c" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
//PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
//PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log,"domibus_C3Dom1")
PModeUtils.uploadPmode("C3","default","\\red\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-red.xml",context,log,"domibus_C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores 1" id="92f3ed90-2f0f-467b-8c9e-b0ed2680df2a" disabled="true"><con:settings/><con:config><script>// Upload truststores

// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","special","\\Threegateways\\blue\\gateway_truststore.jks",context,log,"domibus_C3Dom1")
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to FS" id="d55e2f61-86a4-46aa-923a-16978dbdaf3e" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom2")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendFSPlugin",context,log,"domibus_C3Dom1")
Domibus.setMessageFilters("C3","backendFSPlugin",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 1" id="2556f0d5-1c5e-4452-bfb7-9984bbb0800b"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes 2" id="24becece-6c63-44ef-b95c-e53f651d8007" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC3Dom1\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus_C2Dom1ToC3Dom1\\domibus-pmode-red.xml",context,log,"domibus_C3Dom1")
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log,"domibus_C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores 2" id="7c40c69d-11bb-4ead-8f36-8ba5e8a94a69" disabled="true"><con:settings/><con:config><script>// Upload truststores

// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log,"domibus_C3Dom1")
TruststoreUtils.uploadTruststore("C3","special","\\Threegateways\\blue\\gateway_truststore.jks",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message 2" id="c057c45e-e8ab-4ac4-b91f-0b23c5a05b04"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\standard\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="127951b6-4a58-44eb-b19c-29dabe5e16cb"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Check that a folder is created in C3 for each message inside each targeted domain folder
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="1daefffe-8da2-4977-8329-6b33c657f12a" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2")
// Remove users in C3
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom1")
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="7f6529d9-d151-421d-84d8-ba0acbceaed9" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX41-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="197b2827-65e2-4031-bcd8-5c5875cafabb" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX54-Multitenancy-Security-Outgoing message-wrong user password-ws" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="8281a5be-d165-4a6f-b862-77c02b7b782d"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Configure Multitenancy for C2 and C3 (enable plugin security, create domain properties file, create domain schema ...)
- Domains "domibus_C2Dom1" and "domibus_C2Dom2" are configured for C2.
- Domains "domibus_C3Dom1" and "domibus_C3Dom2" are configured for C3.
- Create plugin users on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1", "userC1C2Dom2" linked to "originalSender" and domain "domibus_C2Dom2".
- Create plugin users on C3: "userC4C3Dom1" linked to "originalSender" and domain "domibus_C3Dom1", "userC4C3Dom2" linked to "originalSender" and domain "domibus_C3Dom2".
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,2).
- Certificate configured on domain "domibus_C2Dom1" is only present in the truststore of domain "domibus_C3Dom2".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="abad7f24-f9fe-4852-9bd9-adf6e92063cf" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "2")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 2.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="8113adb6-cb09-4183-8ebd-9449a0455e27" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for both C2 and C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="785cf4af-21db-49f3-88c6-b4b3c8472c79" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
// Create users in C3
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom1","ROLE_USER","userC4C3Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom2","ROLE_USER","userC4C3Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="b6fc7dfa-7fdd-41e7-a9d4-e43f09abbdd5" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log,"domibus_C3Dom1")
PModeUtils.uploadPmode("C3","default","\\red\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-red.xml",context,log,"domibus_C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="8d22c296-a657-4bdf-a860-06592ef7a1c7" disabled="true"><con:settings/><con:config><script>// Upload truststores

// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","special","\\Threegateways\\blue\\gateway_truststore.jks",context,log,"domibus_C3Dom1")
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to WS" id="ef10cf65-1f08-4748-880a-d3d071180d40" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom2")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendWebservice",context,log,"domibus_C3Dom1")
Domibus.setMessageFilters("C3","backendWebservice",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="request" id="b54763cb-41d0-4174-9103-de1183056b9c" name="Submit Message 1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>submitMessage</con:operation><con:request name="Submit Message 1" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="e022ccff-cc86-4b74-9723-3e474bc04cd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:_1="http://org.ecodex.backend/1_1/" xmlns:xm="http://www.w3.org/2005/05/xmlmime">
   <soap:Header>
      <ns:Messaging>
         <ns:UserMessage>
            <ns:MessageInfo>
               <ns:MessageId>-DomX54-1-</ns:MessageId>
            </ns:MessageInfo>
            <ns:PartyInfo>
               <ns:From>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-blue</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator</ns:Role>
               </ns:From>
               <ns:To>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-red</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder</ns:Role>
               </ns:To>
            </ns:PartyInfo>
            <ns:CollaborationInfo>
               <ns:Service type="tc1">bdx:noprocess</ns:Service>
               <ns:Action>TC1Leg1</ns:Action>
            </ns:CollaborationInfo>
            <ns:MessageProperties>
               <ns:Property name="originalSender">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1</ns:Property>
               <ns:Property name="finalRecipient">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4</ns:Property>
            </ns:MessageProperties>
            <ns:PayloadInfo>
               <ns:PartInfo href="cid:message">
                  <ns:PartProperties>
                     <ns:Property name="MimeType">text/xml</ns:Property>
                  </ns:PartProperties>
               </ns:PartInfo>
            </ns:PayloadInfo>
         </ns:UserMessage>
      </ns:Messaging>
   </soap:Header>
   <soap:Body>
      <_1:submitRequest>
         <payload payloadId="cid:message">
            <value>PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=</value>
         </payload>
      </_1:submitRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="55691702-a96e-4270-b659-69659336509f" name="SOAP Response"/><con:assertion type="Not SOAP Fault Assertion" id="06d13f0f-a30b-4107-baab-cc4fead484bf" name="SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>wrong</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/submitMessage"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="eca08c42-2851-4872-b434-28987b576563" name="Submit Message 2"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>submitMessage</con:operation><con:request name="Submit Message 2" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="e022ccff-cc86-4b74-9723-3e474bc04cd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:_1="http://org.ecodex.backend/1_1/" xmlns:xm="http://www.w3.org/2005/05/xmlmime">
   <soap:Header>
      <ns:Messaging>
         <ns:UserMessage>
            <ns:MessageInfo>
               <ns:MessageId>-DomX54-2-</ns:MessageId>
            </ns:MessageInfo>
            <ns:PartyInfo>
               <ns:From>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-blue</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator</ns:Role>
               </ns:From>
               <ns:To>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-red</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder</ns:Role>
               </ns:To>
            </ns:PartyInfo>
            <ns:CollaborationInfo>
               <ns:Service type="tc1">bdx:noprocess</ns:Service>
               <ns:Action>TC1Leg1</ns:Action>
            </ns:CollaborationInfo>
            <ns:MessageProperties>
               <ns:Property name="originalSender">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1</ns:Property>
               <ns:Property name="finalRecipient">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4</ns:Property>
            </ns:MessageProperties>
            <ns:PayloadInfo>
               <ns:PartInfo href="cid:message">
                  <ns:PartProperties>
                     <ns:Property name="MimeType">text/xml</ns:Property>
                  </ns:PartProperties>
               </ns:PartInfo>
            </ns:PayloadInfo>
         </ns:UserMessage>
      </ns:Messaging>
   </soap:Header>
   <soap:Body>
      <_1:submitRequest>
         <payload payloadId="cid:message">
            <value>PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=</value>
         </payload>
      </_1:submitRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="55691702-a96e-4270-b659-69659336509f" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="4867ee3d-c218-4366-849a-378a3bc12835" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/submitMessage"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="f3389ec9-1e32-4f61-808b-c3ca35da99ad" name="getStatus C2 Dom1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getStatus</con:operation><con:request name="getStatus C2 Dom1" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="5bfa294e-cfc1-45e2-8020-c01c115a9252"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:statusRequest>\r
         <messageID>-DomX54-2-</messageID>\r
      </_1:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6802c3da-8316-4b9e-a0b0-5e5cd5e87571" name="SOAP Response"/><con:assertion type="Not SOAP Fault Assertion" id="2fe9b01c-1469-4375-bb24-d64cf813a08a" name="SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>wrong</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getStatus"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="List Pending Messages C3 Dom1" id="2632e9d6-b802-4bac-9cf6-a183972df481">
                <con:settings/>
                <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                    <con:interface>BackendService_1_1SoapBinding</con:interface>
                    <con:operation>listPendingMessages</con:operation>
                    <con:request name="List Pending Messages C3 Dom1" id="3bd62923-7ca0-487d-94d2-76fdfd82bf15">
                        <con:settings>
                            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
                        </con:settings>
                        <con:encoding>UTF-8</con:encoding>
                        <con:endpoint>${#Project#remoteUrl}/services/backend</con:endpoint>
                        <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">
   <soap:Header/>
   <soap:Body>
      <_1:listPendingMessagesRequest></_1:listPendingMessagesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
                        <con:assertion type="SOAP Response" id="15aaf1d5-2a16-4a4c-9f88-823775512faf"/>
                        <con:assertion type="Not SOAP Fault Assertion" id="52db5494-848c-4f5d-8a5b-ddfece7a5df4" name="SOAP Fault"/><con:credentials>
                            <con:username>userC4C3Dom1</con:username><con:password>wrong</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType>
                        </con:credentials>
                        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
                        <con:jmsPropertyConfig/>
                        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
                        <con:wsrmConfig version="1.2"/>
                    </con:request>
                </con:config>
            </con:testStep><con:testStep type="request" id="11232970-d52b-40b8-b104-7f9d3b4db460" name="retrieveMessage"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>retrieveMessage</con:operation><con:request name="retrieveMessage" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="85e5ccac-5aea-4b2f-94d8-ab1a46142d4e"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#remoteUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:retrieveMessageRequest>\r
         <messageID>-DomX54-2-</messageID>\r
      </_1:retrieveMessageRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" name="SOAP Response" id="210630ad-1205-4eb3-86c3-2efc781a8cb6"/><con:assertion type="Not SOAP Fault Assertion" id="9d31ce46-fe7c-4eaa-8af5-2ad6ae3a4348" name="SOAP Fault"/><con:credentials><con:username>userC4C3Dom2</con:username><con:password>wrong</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/retrieveMessage"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="a668224d-3a85-4ac4-af22-8e320b2a8605" name="getMessageErrors C2 Dom1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getMessageErrors</con:operation><con:request name="getMessageErrors C2 Dom1" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="4aece6dd-167a-49cc-979b-a8d1ecebad84"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:getErrorsRequest>\r
         <messageID>-DomX54-2-</messageID>\r
      </_1:getErrorsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6c04b101-695b-445e-9406-a7fcb5b07ab6" name="SOAP Response"/><con:assertion type="Not SOAP Fault Assertion" id="38b479f4-c44a-4bf9-a489-20593b70ce4a" name="SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>wrong</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getMessageErrors"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="bded869b-8ce7-4883-acd4-10b30a8f938a" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2")
// Remove users in C3
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom1")
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="caed9b04-608c-48e4-8b98-9154efcc01d7" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX54-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="c52984eb-8c6d-4666-985f-d3d459c7e1ea" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX55-Multitenancy-Self sending-Different Domain-ws" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="a13f0456-83ab-47cb-88d3-592115174e0b"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Configure Multitenancy for C2 (enable plugin security, create domain properties file, create domain schema ...)
- Domains "domibus_C2Dom1" and "domibus_C2Dom2" are configured for C2.
- Create plugin users on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1", "userC1C2Dom2" linked to "originalSender" and domain "domibus_C2Dom2".
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,0).
- Certificate configured on domain "domibus_C2Dom1" is only present in the truststore of domain "domibus_C3Dom2".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="9a5e8d90-50cf-4438-9cc3-ea1ee355154c" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 0.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="72dcd7f5-2e1f-4e44-a027-f06fae42712f" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for both C2 and C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="a15ab67b-01b5-4dba-89df-1cf8c1f3e7e6" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to WS" id="00c26b18-9c2a-4e20-948a-24c081535b29" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="4b76239e-1e67-45bc-ba48-dc516fc4b360" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 Domain1 ================";
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC2Dom2\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
log.info "================ Upload pmodes C2 Domain2 ================";
PModeUtils.uploadPmode("C2","default","\\red\\domibus_C2Dom1ToC2Dom2\\domibus-pmode-red.xml",context,log,"domibus_C2Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="6682df59-56f6-4d06-8f91-298505a3b3a1" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload truststores C2 Domain1 ================";
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
log.info "================ Upload truststores C2 Domain2 ================";
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")


</script></con:config></con:testStep><con:testStep type="request" id="3c1a1829-7dfa-4490-913b-5e7b69a2680d" name="Submit Message"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>submitMessage</con:operation><con:request name="Submit Message" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="e022ccff-cc86-4b74-9723-3e474bc04cd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:_1="http://org.ecodex.backend/1_1/" xmlns:xm="http://www.w3.org/2005/05/xmlmime">
   <soap:Header>
      <ns:Messaging>
         <ns:UserMessage>
            <ns:MessageInfo>
               <ns:MessageId>-DomX55-</ns:MessageId>
            </ns:MessageInfo>
            <ns:PartyInfo>
               <ns:From>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-blue</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator</ns:Role>
               </ns:From>
               <ns:To>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-red</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder</ns:Role>
               </ns:To>
            </ns:PartyInfo>
            <ns:CollaborationInfo>
               <ns:Service type="tc1">bdx:noprocess</ns:Service>
               <ns:Action>TC1Leg1</ns:Action>
            </ns:CollaborationInfo>
            <ns:MessageProperties>
               <ns:Property name="originalSender">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1</ns:Property>
               <ns:Property name="finalRecipient">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4</ns:Property>
            </ns:MessageProperties>
            <ns:PayloadInfo>
               <ns:PartInfo href="cid:message">
                  <ns:PartProperties>
                     <ns:Property name="MimeType">text/xml</ns:Property>
                  </ns:PartProperties>
               </ns:PartInfo>
            </ns:PayloadInfo>
         </ns:UserMessage>
      </ns:Messaging>
   </soap:Header>
   <soap:Body>
      <_1:submitRequest>
         <payload payloadId="cid:message">
            <value>PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=</value>
         </payload>
      </_1:submitRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="55691702-a96e-4270-b659-69659336509f" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="0437d1bc-ceaa-4c63-8cdd-a8d9332f02db" name="Not SOAP Fault"/><con:assertion type="GroovyScriptAssertion" id="8bfe8083-e19c-452d-8980-86635b045d8b" name="Script Assertion"><con:configuration><scriptText>def test = new Domibus(log,messageExchange,context)
test.waitForStatus("ACKNOWLEDGED", "RECEIVED", null, null, null, "C2Dom1", "C2Dom2")
test.finalize()</scriptText></con:configuration></con:assertion><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/submitMessage"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="222389a2-0bdd-4b06-936b-d7e43bd7b910" name="getStatus C2 Dom1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getStatus</con:operation><con:request name="getStatus C2 Dom1" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="5bfa294e-cfc1-45e2-8020-c01c115a9252"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:statusRequest>\r
         <messageID>-DomX55-</messageID>\r
      </_1:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6802c3da-8316-4b9e-a0b0-5e5cd5e87571" name="SOAP Response"/><con:assertion type="Simple Contains" id="51f27293-b330-4af8-a8ea-64bd3ba84d71" name="Contains"><con:configuration><token>ACKNOWLEDGED</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="1007dc97-97a7-441c-8de3-0dae5d222059" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getStatus"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="43df71f7-0365-4667-8930-54ebe3502637" name="getStatus C2 Dom2"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getStatus</con:operation><con:request name="getStatus C2 Dom2" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="5bfa294e-cfc1-45e2-8020-c01c115a9252"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:statusRequest>\r
         <messageID>-DomX55-</messageID>\r
      </_1:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6802c3da-8316-4b9e-a0b0-5e5cd5e87571" name="SOAP Response"/><con:assertion type="Simple Contains" id="51f27293-b330-4af8-a8ea-64bd3ba84d71" name="Contains"><con:configuration><token>RECEIVED</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="24e132f2-5877-43d5-84fe-efa1b07d8ab1" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom2</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getStatus"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="List Pending Messages C2 Dom2" id="606ed57e-e523-4c79-ab1a-784fffc1d6ea">
                <con:settings/>
                <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                    <con:interface>BackendService_1_1SoapBinding</con:interface>
                    <con:operation>listPendingMessages</con:operation>
                    <con:request name="List Pending Messages C2 Dom2" id="3bd62923-7ca0-487d-94d2-76fdfd82bf15">
                        <con:settings>
                            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
                        </con:settings>
                        <con:encoding>UTF-8</con:encoding>
                        <con:endpoint>${#Project#localUrl}/services/backend</con:endpoint>
                        <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">
   <soap:Header/>
   <soap:Body>
      <_1:listPendingMessagesRequest></_1:listPendingMessagesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
                        <con:assertion type="SOAP Response" id="15aaf1d5-2a16-4a4c-9f88-823775512faf"/>
                        <con:assertion type="Simple Contains" id="7c94bb26-69f3-4771-92ca-96b365c71ec7" name="Contains"><con:configuration><token>-DomX55-</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="3fb533ae-fe7e-46fc-bda4-56ebbea13b1e" name="Not SOAP Fault"/><con:credentials>
                            <con:username>userC1C2Dom2</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType>
                        </con:credentials>
                        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
                        <con:jmsPropertyConfig/>
                        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
                        <con:wsrmConfig version="1.2"/>
                    </con:request>
                </con:config>
            </con:testStep><con:testStep type="request" name="List Pending Messages C2 Dom1" id="335fcb59-cf73-44bd-b142-faabe0817172">
                <con:settings/>
                <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                    <con:interface>BackendService_1_1SoapBinding</con:interface>
                    <con:operation>listPendingMessages</con:operation>
                    <con:request name="List Pending Messages C2 Dom1" id="3bd62923-7ca0-487d-94d2-76fdfd82bf15">
                        <con:settings>
                            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
                        </con:settings>
                        <con:encoding>UTF-8</con:encoding>
                        <con:endpoint>${#Project#localUrl}/services/backend</con:endpoint>
                        <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">
   <soap:Header/>
   <soap:Body>
      <_1:listPendingMessagesRequest></_1:listPendingMessagesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
                        <con:assertion type="SOAP Response" id="15aaf1d5-2a16-4a4c-9f88-823775512faf"/>
                        <con:assertion type="SOAP Fault Assertion" id="3fb533ae-fe7e-46fc-bda4-56ebbea13b1e" name="Not SOAP Fault"/><con:assertion type="Simple NotContains" id="b2792745-dd75-447c-b41f-c77ca3969365" name="Not Contains"><con:configuration><token>-DomX55-</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials>
                            <con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType>
                        </con:credentials>
                        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
                        <con:jmsPropertyConfig/>
                        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
                        <con:wsrmConfig version="1.2"/>
                    </con:request>
                </con:config>
            </con:testStep><con:testStep type="request" id="46b2423c-c1fe-4fb8-9628-dc4dda6ac973" name="retrieveMessage"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>retrieveMessage</con:operation><con:request name="retrieveMessage" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="85e5ccac-5aea-4b2f-94d8-ab1a46142d4e"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:retrieveMessageRequest>\r
         <messageID>-DomX55-</messageID>\r
      </_1:retrieveMessageRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" name="SOAP Response" id="210630ad-1205-4eb3-86c3-2efc781a8cb6"/><con:assertion type="SOAP Fault Assertion" id="78b4bb05-5a4f-41c3-a809-9fb968a74bf3" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom2</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/retrieveMessage"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="List Pending Messages C2 Dom2 After Download" id="43c6eff1-6fe3-4c8b-a0cf-9d1063398116">
                <con:settings/>
                <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                    <con:interface>BackendService_1_1SoapBinding</con:interface>
                    <con:operation>listPendingMessages</con:operation>
                    <con:request name="List Pending Messages C2 Dom2 After Download" id="3bd62923-7ca0-487d-94d2-76fdfd82bf15">
                        <con:settings>
                            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
                        </con:settings>
                        <con:encoding>UTF-8</con:encoding>
                        <con:endpoint>${#Project#localUrl}/services/backend</con:endpoint>
                        <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">
   <soap:Header/>
   <soap:Body>
      <_1:listPendingMessagesRequest></_1:listPendingMessagesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
                        <con:assertion type="SOAP Response" id="15aaf1d5-2a16-4a4c-9f88-823775512faf"/>
                        <con:assertion type="SOAP Fault Assertion" id="af93e5ba-4c76-4cab-8452-0abff8db5e41" name="Not SOAP Fault"/><con:assertion type="Simple NotContains" id="eca7570d-af76-4f17-b6e4-160b32acae68" name="Not Contains"><con:configuration><token>-DomX55-</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials>
                            <con:username>userC1C2Dom2</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType>
                        </con:credentials>
                        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
                        <con:jmsPropertyConfig/>
                        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
                        <con:wsrmConfig version="1.2"/>
                    </con:request>
                </con:config>
            </con:testStep><con:testStep type="request" id="c7e0e6a4-11b4-4a79-b190-682cc27d2104" name="getStatus C2 Dom1 After Download"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getStatus</con:operation><con:request name="getStatus C2 Dom1 After Download" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="5bfa294e-cfc1-45e2-8020-c01c115a9252"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:statusRequest>\r
         <messageID>-DomX55-</messageID>\r
      </_1:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6802c3da-8316-4b9e-a0b0-5e5cd5e87571" name="SOAP Response"/><con:assertion type="Simple Contains" id="51f27293-b330-4af8-a8ea-64bd3ba84d71" name="Contains"><con:configuration><token>ACKNOWLEDGED</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="7ed36985-296c-49c2-9b28-07c7be4f6d47" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getStatus"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="20a8fd7a-edf9-4390-af02-b7e239fe6272" name="getStatus C2 Dom2 After Download"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getStatus</con:operation><con:request name="getStatus C2 Dom2 After Download" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="5bfa294e-cfc1-45e2-8020-c01c115a9252"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:statusRequest>\r
         <messageID>-DomX55-</messageID>\r
      </_1:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6802c3da-8316-4b9e-a0b0-5e5cd5e87571" name="SOAP Response"/><con:assertion type="Simple Contains" id="51f27293-b330-4af8-a8ea-64bd3ba84d71" name="Contains"><con:configuration><token>(?s).*[DOWNLOADED|DELETED].*</token><ignoreCase>false</ignoreCase><useRegEx>true</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="986226cb-ec2b-45bd-984c-e3761704d50b" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom2</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getStatus"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="dd38e45a-499a-493f-bc8e-4cd71a94766d" name="getMessageErrors C2 Dom1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getMessageErrors</con:operation><con:request name="getMessageErrors C2 Dom1" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="4aece6dd-167a-49cc-979b-a8d1ecebad84"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:getErrorsRequest>\r
         <messageID>-DomX55-</messageID>\r
      </_1:getErrorsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6c04b101-695b-445e-9406-a7fcb5b07ab6" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="e097eba2-b44b-400b-9d9d-f9f5a1be9707" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getMessageErrors"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="e14958d3-0681-4665-aa6d-3f55dd88e397" name="getMessageErrors C2 Dom2"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getMessageErrors</con:operation><con:request name="getMessageErrors C2 Dom2" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="4aece6dd-167a-49cc-979b-a8d1ecebad84"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:getErrorsRequest>\r
         <messageID>-DomX55-</messageID>\r
      </_1:getErrorsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6c04b101-695b-445e-9406-a7fcb5b07ab6" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="5418f8a3-85a5-48d1-8511-8838acabbb52" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom2</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getMessageErrors"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="50aac4ec-a7b9-4811-b35d-eba67a1ad551" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="29b1c97e-17c9-473e-801c-ebd0b1d6f76e" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX55-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="74ffbf12-c21e-402a-ac11-6615c0a4247c" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX56-Multitenancy-Self sending-Same Domain-ws" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="0f324799-ca6b-4814-943d-946ef275ceaf"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Configure Multitenancy for C2 (enable plugin security, create domain properties file, create domain schema ...)
- Domains "domibus_C2Dom1" and "domibus_C2Dom2" are configured for C2.
- Create plugin users on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1", "userC1C2Dom2" linked to "originalSender" and domain "domibus_C2Dom2".
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,0).
- Certificate configured on domain "domibus_C2Dom1" is only present in the truststore of domain "domibus_C3Dom2".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="d920d89d-84fa-4ff7-9666-395964326551" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 0.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="4fea54bc-f44f-440b-8ebc-3c1e776a3f0f" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for both C2 and C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="db617f99-0ee4-4edb-b797-eccba63c4f85" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to WS" id="6e095b05-7df1-4f45-8a33-af39da5d79f2" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="06552a59-9d6f-4c0c-bfe8-b13cecd1b5dc" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 Domain1 ================";
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC2Dom2\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
log.info "================ Upload pmodes C2 Domain2 ================";
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC2Dom2\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="a7930a1a-cfcb-45b5-8fe5-8c0108ade5b8" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload truststores C2 Domain1 ================";
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
log.info "================ Upload truststores C2 Domain2 ================";
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")


</script></con:config></con:testStep><con:testStep type="request" id="bf061936-f04e-4170-a19c-15a17567a945" name="Submit Message"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>submitMessage</con:operation><con:request name="Submit Message" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="e022ccff-cc86-4b74-9723-3e474bc04cd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:_1="http://org.ecodex.backend/1_1/" xmlns:xm="http://www.w3.org/2005/05/xmlmime">
   <soap:Header>
      <ns:Messaging>
         <ns:UserMessage>
            <ns:MessageInfo>
               <ns:MessageId>-DomX56-</ns:MessageId>
            </ns:MessageInfo>
            <ns:PartyInfo>
               <ns:From>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-blue</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator</ns:Role>
               </ns:From>
               <ns:To>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-blue</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder</ns:Role>
               </ns:To>
            </ns:PartyInfo>
            <ns:CollaborationInfo>
               <ns:Service type="tc1">bdx:noprocess</ns:Service>
               <ns:Action>TC1Leg1</ns:Action>
            </ns:CollaborationInfo>
            <ns:MessageProperties>
               <ns:Property name="originalSender">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1</ns:Property>
               <ns:Property name="finalRecipient">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1</ns:Property>
            </ns:MessageProperties>
            <ns:PayloadInfo>
               <ns:PartInfo href="cid:message">
                  <ns:PartProperties>
                     <ns:Property name="MimeType">text/xml</ns:Property>
                  </ns:PartProperties>
               </ns:PartInfo>
            </ns:PayloadInfo>
         </ns:UserMessage>
      </ns:Messaging>
   </soap:Header>
   <soap:Body>
      <_1:submitRequest>
         <payload payloadId="cid:message">
            <value>PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=</value>
         </payload>
      </_1:submitRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="55691702-a96e-4270-b659-69659336509f" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="0437d1bc-ceaa-4c63-8cdd-a8d9332f02db" name="Not SOAP Fault"/><con:assertion type="GroovyScriptAssertion" id="8bfe8083-e19c-452d-8980-86635b045d8b" name="Script Assertion"><con:configuration><scriptText>def test = new Domibus(log,messageExchange,context)
test.waitForStatus("ACKNOWLEDGED", "", null, null, null, "C2Dom1", "C2Dom1")
test.finalize()</scriptText></con:configuration></con:assertion><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/submitMessage"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="e9eed857-6b3b-4d55-b159-b881de794a3f" name="getStatus C2 Dom1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getStatus</con:operation><con:request name="getStatus C2 Dom1" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="5bfa294e-cfc1-45e2-8020-c01c115a9252"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:statusRequest>\r
         <messageID>-DomX56-</messageID>\r
      </_1:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6802c3da-8316-4b9e-a0b0-5e5cd5e87571" name="SOAP Response"/><con:assertion type="Simple Contains" id="51f27293-b330-4af8-a8ea-64bd3ba84d71" name="Contains"><con:configuration><token>ACKNOWLEDGED</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="1007dc97-97a7-441c-8de3-0dae5d222059" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getStatus"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="737cd7f3-e4a4-4d72-8c7b-3f8fef83144d" name="getStatus C2 Dom1 R"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getStatus</con:operation><con:request name="getStatus C2 Dom1 R" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="5bfa294e-cfc1-45e2-8020-c01c115a9252"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:statusRequest>\r
         <messageID>-DomX56-_1</messageID>\r
      </_1:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6802c3da-8316-4b9e-a0b0-5e5cd5e87571" name="SOAP Response"/><con:assertion type="Simple Contains" id="51f27293-b330-4af8-a8ea-64bd3ba84d71" name="Contains"><con:configuration><token>RECEIVED</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="24e132f2-5877-43d5-84fe-efa1b07d8ab1" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getStatus"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="List Pending Messages C2 Dom1" id="e56b098f-190e-47b4-922e-e62d79b03492">
                <con:settings/>
                <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                    <con:interface>BackendService_1_1SoapBinding</con:interface>
                    <con:operation>listPendingMessages</con:operation>
                    <con:request name="List Pending Messages C2 Dom1" id="3bd62923-7ca0-487d-94d2-76fdfd82bf15">
                        <con:settings>
                            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
                        </con:settings>
                        <con:encoding>UTF-8</con:encoding>
                        <con:endpoint>${#Project#localUrl}/services/backend</con:endpoint>
                        <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">
   <soap:Header/>
   <soap:Body>
      <_1:listPendingMessagesRequest></_1:listPendingMessagesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
                        <con:assertion type="SOAP Response" id="15aaf1d5-2a16-4a4c-9f88-823775512faf"/>
                        <con:assertion type="Simple Contains" id="7c94bb26-69f3-4771-92ca-96b365c71ec7" name="Contains"><con:configuration><token>-DomX56-</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="3fb533ae-fe7e-46fc-bda4-56ebbea13b1e" name="Not SOAP Fault"/><con:credentials>
                            <con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType>
                        </con:credentials>
                        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
                        <con:jmsPropertyConfig/>
                        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
                        <con:wsrmConfig version="1.2"/>
                    </con:request>
                </con:config>
            </con:testStep><con:testStep type="request" id="8f8341e9-b541-4d08-9f2b-b23aeee25f05" name="retrieveMessage"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>retrieveMessage</con:operation><con:request name="retrieveMessage" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="85e5ccac-5aea-4b2f-94d8-ab1a46142d4e"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:retrieveMessageRequest>\r
         <messageID>-DomX56-_1</messageID>\r
      </_1:retrieveMessageRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" name="SOAP Response" id="210630ad-1205-4eb3-86c3-2efc781a8cb6"/><con:assertion type="SOAP Fault Assertion" id="78b4bb05-5a4f-41c3-a809-9fb968a74bf3" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/retrieveMessage"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="List Pending Messages C2 Dom1 After Download" id="8627ddc1-4698-4f05-a094-b557333748e1">
                <con:settings/>
                <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                    <con:interface>BackendService_1_1SoapBinding</con:interface>
                    <con:operation>listPendingMessages</con:operation>
                    <con:request name="List Pending Messages C2 Dom1 After Download" id="3bd62923-7ca0-487d-94d2-76fdfd82bf15">
                        <con:settings>
                            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
                        </con:settings>
                        <con:encoding>UTF-8</con:encoding>
                        <con:endpoint>${#Project#localUrl}/services/backend</con:endpoint>
                        <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">
   <soap:Header/>
   <soap:Body>
      <_1:listPendingMessagesRequest></_1:listPendingMessagesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
                        <con:assertion type="SOAP Response" id="15aaf1d5-2a16-4a4c-9f88-823775512faf"/>
                        <con:assertion type="SOAP Fault Assertion" id="af93e5ba-4c76-4cab-8452-0abff8db5e41" name="Not SOAP Fault"/><con:assertion type="Simple NotContains" id="eca7570d-af76-4f17-b6e4-160b32acae68" name="Not Contains"><con:configuration><token>-DomX56-</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials>
                            <con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType>
                        </con:credentials>
                        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
                        <con:jmsPropertyConfig/>
                        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
                        <con:wsrmConfig version="1.2"/>
                    </con:request>
                </con:config>
            </con:testStep><con:testStep type="request" id="74c22d3e-e456-4b4e-b71d-7cf8f529cd57" name="getStatus C2 Dom1 After Download"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getStatus</con:operation><con:request name="getStatus C2 Dom1 After Download" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="5bfa294e-cfc1-45e2-8020-c01c115a9252"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:statusRequest>\r
         <messageID>-DomX56-</messageID>\r
      </_1:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6802c3da-8316-4b9e-a0b0-5e5cd5e87571" name="SOAP Response"/><con:assertion type="Simple Contains" id="51f27293-b330-4af8-a8ea-64bd3ba84d71" name="Contains"><con:configuration><token>ACKNOWLEDGED</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="7ed36985-296c-49c2-9b28-07c7be4f6d47" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getStatus"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="6ee66b4d-3020-450d-9c4f-1b7e9bbbe112" name="getStatus C2 Dom1 R After Download"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getStatus</con:operation><con:request name="getStatus C2 Dom1 R After Download" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="5bfa294e-cfc1-45e2-8020-c01c115a9252"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:statusRequest>\r
         <messageID>-DomX56-_1</messageID>\r
      </_1:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6802c3da-8316-4b9e-a0b0-5e5cd5e87571" name="SOAP Response"/><con:assertion type="Simple Contains" id="51f27293-b330-4af8-a8ea-64bd3ba84d71" name="Contains"><con:configuration><token>(?s).*[DOWNLOADED|DELETED].*</token><ignoreCase>false</ignoreCase><useRegEx>true</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="986226cb-ec2b-45bd-984c-e3761704d50b" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getStatus"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="943361ca-34b3-411f-a75b-d8541ebf3bea" name="getMessageErrors C2 Dom1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getMessageErrors</con:operation><con:request name="getMessageErrors C2 Dom1" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="4aece6dd-167a-49cc-979b-a8d1ecebad84"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:getErrorsRequest>\r
         <messageID>-DomX56-</messageID>\r
      </_1:getErrorsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6c04b101-695b-445e-9406-a7fcb5b07ab6" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="e097eba2-b44b-400b-9d9d-f9f5a1be9707" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getMessageErrors"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="5ba8a07c-c21b-4555-9286-ca046e484f41" name="getMessageErrors C2 Dom1 R"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getMessageErrors</con:operation><con:request name="getMessageErrors C2 Dom1 R" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="4aece6dd-167a-49cc-979b-a8d1ecebad84"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:getErrorsRequest>\r
         <messageID>-DomX56-</messageID>\r
      </_1:getErrorsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6c04b101-695b-445e-9406-a7fcb5b07ab6" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="5418f8a3-85a5-48d1-8511-8838acabbb52" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getMessageErrors"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="229bb7d7-7c4e-4185-8761-281c6e9613f2" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="3a8ceeab-2e69-462e-95f1-931b9a9aa5a1" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX56-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="f9481fae-082d-493a-b5d6-927a6c7d2f86" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX57-Multitenancy-Pull MEP-Basic flow-ws" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="4865d3a4-0b6c-47e9-8f66-b442c714ec45"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Configure Multitenancy for C2 and C3 (enable plugin security, create domain properties file, create domain schema ...)
- Domains "domibus_C2Dom1" and "domibus_C2Dom2" are configured for C2.
- Domains "domibus_C3Dom1" and "domibus_C3Dom2" are configured for C3.
- Create plugin users on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1", "userC1C2Dom2" linked to "originalSender" and domain "domibus_C2Dom2".
- Create plugin users on C3: "userC4C3Dom1" linked to "originalSender" and domain "domibus_C3Dom1", "userC4C3Dom2" linked to "originalSender" and domain "domibus_C3Dom2".
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,2).
- Certificate configured on domain "domibus_C2Dom1" is only present in the truststore of domain "domibus_C3Dom2".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="a7631a77-4011-4e34-8d36-2e08b1945836" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "2")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 2.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="f44e74a4-8a0f-49b4-a31e-8b50265c72e4" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for both C2 and C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="058627e3-2d50-432f-9268-bf6fa68a0042" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
// Create users in C3
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom1","ROLE_USER","userC4C3Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom2","ROLE_USER","userC4C3Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="fd989bba-252a-4f51-850f-4ee68af70037" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log,"domibus_C3Dom1")
PModeUtils.uploadPmode("C3","default","\\red\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-red.xml",context,log,"domibus_C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="9eb64713-40d8-453c-b1ae-3e943acf1b09" disabled="true"><con:settings/><con:config><script>// Upload truststores

// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","special","\\Threegateways\\blue\\gateway_truststore.jks",context,log,"domibus_C3Dom1")
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to WS" id="c1150eed-bab6-4cf6-9a39-ecf28820c235" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom2")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendWebservice",context,log,"domibus_C3Dom1")
Domibus.setMessageFilters("C3","backendWebservice",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="request" id="83466031-74e8-4643-aa04-ccc5a03d72f0" name="Submit Message"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>submitMessage</con:operation><con:request name="Submit Message" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="e022ccff-cc86-4b74-9723-3e474bc04cd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:_1="http://org.ecodex.backend/1_1/" xmlns:xm="http://www.w3.org/2005/05/xmlmime">
   <soap:Header>
      <ns:Messaging>
         <ns:UserMessage>
            <ns:MessageInfo>
               <ns:MessageId>-DomX57-</ns:MessageId>
            </ns:MessageInfo>
            <ns:PartyInfo>
               <ns:From>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-blue</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator</ns:Role>
               </ns:From>
               <ns:To>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-red</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder</ns:Role>
               </ns:To>
            </ns:PartyInfo>
            <ns:CollaborationInfo>
               <ns:Service type="tc13">bdx:noprocess</ns:Service>
               <ns:Action>TC13Leg1</ns:Action>
            </ns:CollaborationInfo>
            <ns:MessageProperties>
               <ns:Property name="originalSender">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1</ns:Property>
               <ns:Property name="finalRecipient">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4</ns:Property>
            </ns:MessageProperties>
            <ns:PayloadInfo>
               <ns:PartInfo href="cid:message">
                  <ns:PartProperties>
                     <ns:Property name="MimeType">text/xml</ns:Property>
                  </ns:PartProperties>
               </ns:PartInfo>
            </ns:PayloadInfo>
         </ns:UserMessage>
      </ns:Messaging>
   </soap:Header>
   <soap:Body>
      <_1:submitRequest>
         <payload payloadId="cid:message">
            <value>PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=</value>
         </payload>
      </_1:submitRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="55691702-a96e-4270-b659-69659336509f" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="0437d1bc-ceaa-4c63-8cdd-a8d9332f02db" name="Not SOAP Fault"/><con:assertion type="GroovyScriptAssertion" id="8bfe8083-e19c-452d-8980-86635b045d8b" name="Script Assertion"><con:configuration><scriptText>def test = new Domibus(log,messageExchange,context)
test.waitForStatus("ACKNOWLEDGED", "RECEIVED", null, null, null, "C2Dom1", "C3Dom2")
test.finalize()</scriptText></con:configuration></con:assertion><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/submitMessage"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="7c980110-1302-437f-9e58-cf7c15dc6922" name="getStatus C2 Dom1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getStatus</con:operation><con:request name="getStatus C2 Dom1" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="5bfa294e-cfc1-45e2-8020-c01c115a9252"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:statusRequest>\r
         <messageID>-DomX57-</messageID>\r
      </_1:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6802c3da-8316-4b9e-a0b0-5e5cd5e87571" name="SOAP Response"/><con:assertion type="Simple Contains" id="51f27293-b330-4af8-a8ea-64bd3ba84d71" name="Contains"><con:configuration><token>ACKNOWLEDGED</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="1007dc97-97a7-441c-8de3-0dae5d222059" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getStatus"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="32ea9eab-c615-4fbc-9ad2-859d63715363" name="getStatus C3 Dom2"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getStatus</con:operation><con:request name="getStatus C3 Dom2" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="5bfa294e-cfc1-45e2-8020-c01c115a9252"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#remoteUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:statusRequest>\r
         <messageID>-DomX57-</messageID>\r
      </_1:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6802c3da-8316-4b9e-a0b0-5e5cd5e87571" name="SOAP Response"/><con:assertion type="Simple Contains" id="51f27293-b330-4af8-a8ea-64bd3ba84d71" name="Contains"><con:configuration><token>RECEIVED</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="24e132f2-5877-43d5-84fe-efa1b07d8ab1" name="Not SOAP Fault"/><con:credentials><con:username>userC4C3Dom2</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getStatus"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="List Pending Messages C3 Dom2" id="309b6740-8421-4d2a-beab-86e467d9ae17">
                <con:settings/>
                <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                    <con:interface>BackendService_1_1SoapBinding</con:interface>
                    <con:operation>listPendingMessages</con:operation>
                    <con:request name="List Pending Messages C3 Dom2" id="3bd62923-7ca0-487d-94d2-76fdfd82bf15">
                        <con:settings>
                            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
                        </con:settings>
                        <con:encoding>UTF-8</con:encoding>
                        <con:endpoint>${#Project#remoteUrl}/services/backend</con:endpoint>
                        <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">
   <soap:Header/>
   <soap:Body>
      <_1:listPendingMessagesRequest></_1:listPendingMessagesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
                        <con:assertion type="SOAP Response" id="15aaf1d5-2a16-4a4c-9f88-823775512faf"/>
                        <con:assertion type="Simple Contains" id="7c94bb26-69f3-4771-92ca-96b365c71ec7" name="Contains"><con:configuration><token>-DomX57-</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="3fb533ae-fe7e-46fc-bda4-56ebbea13b1e" name="Not SOAP Fault"/><con:credentials>
                            <con:username>userC4C3Dom2</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType>
                        </con:credentials>
                        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
                        <con:jmsPropertyConfig/>
                        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
                        <con:wsrmConfig version="1.2"/>
                    </con:request>
                </con:config>
            </con:testStep><con:testStep type="request" name="List Pending Messages C3 Dom1" id="63a5327c-b3c3-4455-b80d-3f9e127d634d">
                <con:settings/>
                <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                    <con:interface>BackendService_1_1SoapBinding</con:interface>
                    <con:operation>listPendingMessages</con:operation>
                    <con:request name="List Pending Messages C3 Dom1" id="3bd62923-7ca0-487d-94d2-76fdfd82bf15">
                        <con:settings>
                            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
                        </con:settings>
                        <con:encoding>UTF-8</con:encoding>
                        <con:endpoint>${#Project#remoteUrl}/services/backend</con:endpoint>
                        <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">
   <soap:Header/>
   <soap:Body>
      <_1:listPendingMessagesRequest></_1:listPendingMessagesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
                        <con:assertion type="SOAP Response" id="15aaf1d5-2a16-4a4c-9f88-823775512faf"/>
                        <con:assertion type="SOAP Fault Assertion" id="3fb533ae-fe7e-46fc-bda4-56ebbea13b1e" name="Not SOAP Fault"/><con:assertion type="Simple NotContains" id="b2792745-dd75-447c-b41f-c77ca3969365" name="Not Contains"><con:configuration><token>-DomX57-</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials>
                            <con:username>userC4C3Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType>
                        </con:credentials>
                        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
                        <con:jmsPropertyConfig/>
                        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
                        <con:wsrmConfig version="1.2"/>
                    </con:request>
                </con:config>
            </con:testStep><con:testStep type="request" id="dfeeef5f-3f9e-44cf-8646-a0833dc3ef6c" name="retrieveMessage"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>retrieveMessage</con:operation><con:request name="retrieveMessage" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="85e5ccac-5aea-4b2f-94d8-ab1a46142d4e"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#remoteUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:retrieveMessageRequest>\r
         <messageID>-DomX57-</messageID>\r
      </_1:retrieveMessageRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" name="SOAP Response" id="210630ad-1205-4eb3-86c3-2efc781a8cb6"/><con:assertion type="SOAP Fault Assertion" id="78b4bb05-5a4f-41c3-a809-9fb968a74bf3" name="Not SOAP Fault"/><con:credentials><con:username>userC4C3Dom2</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/retrieveMessage"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="List Pending Messages C3 Dom2 After Download" id="3e759bfe-baf5-4268-a0a9-5e3d63e38643">
                <con:settings/>
                <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                    <con:interface>BackendService_1_1SoapBinding</con:interface>
                    <con:operation>listPendingMessages</con:operation>
                    <con:request name="List Pending Messages C3 Dom2 After Download" id="3bd62923-7ca0-487d-94d2-76fdfd82bf15">
                        <con:settings>
                            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
                        </con:settings>
                        <con:encoding>UTF-8</con:encoding>
                        <con:endpoint>${#Project#remoteUrl}/services/backend</con:endpoint>
                        <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">
   <soap:Header/>
   <soap:Body>
      <_1:listPendingMessagesRequest></_1:listPendingMessagesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
                        <con:assertion type="SOAP Response" id="15aaf1d5-2a16-4a4c-9f88-823775512faf"/>
                        <con:assertion type="SOAP Fault Assertion" id="af93e5ba-4c76-4cab-8452-0abff8db5e41" name="Not SOAP Fault"/><con:assertion type="Simple NotContains" id="eca7570d-af76-4f17-b6e4-160b32acae68" name="Not Contains"><con:configuration><token>-DomX57-</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials>
                            <con:username>userC4C3Dom2</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType>
                        </con:credentials>
                        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
                        <con:jmsPropertyConfig/>
                        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
                        <con:wsrmConfig version="1.2"/>
                    </con:request>
                </con:config>
            </con:testStep><con:testStep type="request" id="164a2f8d-72bd-4b75-b4f0-08b20519bf78" name="getStatus C2 Dom1 After Download"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getStatus</con:operation><con:request name="getStatus C2 Dom1 After Download" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="5bfa294e-cfc1-45e2-8020-c01c115a9252"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:statusRequest>\r
         <messageID>-DomX57-</messageID>\r
      </_1:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6802c3da-8316-4b9e-a0b0-5e5cd5e87571" name="SOAP Response"/><con:assertion type="Simple Contains" id="51f27293-b330-4af8-a8ea-64bd3ba84d71" name="Contains"><con:configuration><token>ACKNOWLEDGED</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="7ed36985-296c-49c2-9b28-07c7be4f6d47" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getStatus"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="5d773f6e-6a8f-44e2-9658-1ebe9828c0f4" name="getStatus C3 Dom2 After Download"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getStatus</con:operation><con:request name="getStatus C3 Dom2 After Download" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="5bfa294e-cfc1-45e2-8020-c01c115a9252"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#remoteUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:statusRequest>\r
         <messageID>-DomX57-</messageID>\r
      </_1:statusRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6802c3da-8316-4b9e-a0b0-5e5cd5e87571" name="SOAP Response"/><con:assertion type="Simple Contains" id="51f27293-b330-4af8-a8ea-64bd3ba84d71" name="Contains"><con:configuration><token>(?s).*[DOWNLOADED|DELETED].*</token><ignoreCase>false</ignoreCase><useRegEx>true</useRegEx></con:configuration></con:assertion><con:assertion type="SOAP Fault Assertion" id="986226cb-ec2b-45bd-984c-e3761704d50b" name="Not SOAP Fault"/><con:credentials><con:username>userC4C3Dom2</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getStatus"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="71dc9673-e744-4845-963d-a6250478e1ac" name="getMessageErrors C2 Dom1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getMessageErrors</con:operation><con:request name="getMessageErrors C2 Dom1" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="4aece6dd-167a-49cc-979b-a8d1ecebad84"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:getErrorsRequest>\r
         <messageID>-DomX57-</messageID>\r
      </_1:getErrorsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6c04b101-695b-445e-9406-a7fcb5b07ab6" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="e097eba2-b44b-400b-9d9d-f9f5a1be9707" name="Not SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getMessageErrors"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="8e1dc610-111f-426d-80e3-17fb1cccb6c2" name="getMessageErrors C3 Dom2"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>getMessageErrors</con:operation><con:request name="getMessageErrors C3 Dom2" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="4aece6dd-167a-49cc-979b-a8d1ecebad84"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#remoteUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:_1="http://org.ecodex.backend/1_1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <_1:getErrorsRequest>\r
         <messageID>-DomX57-</messageID>\r
      </_1:getErrorsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6c04b101-695b-445e-9406-a7fcb5b07ab6" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="5418f8a3-85a5-48d1-8511-8838acabbb52" name="Not SOAP Fault"/><con:credentials><con:username>userC4C3Dom2</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/getMessageErrors"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="3a77a341-51e2-4d65-b8b3-cc6f99b7df73" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2")
// Remove users in C3
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom1")
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="5e93ed34-594e-4751-a809-665310ef2956" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX57-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="6a09f87c-44cc-481e-8f07-7a46cc44a6d6" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX59-Multitenancy-Pull MEP-Basic flow-fs" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="2017d5d9-b61b-40bd-b5fd-8ed538a4d4f4"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Create general DB schemas.
- Configure Multitenancy for C2 and C3 (enable plugin security, create domain properties file, create domain schema ...)
- Domains "domibus_C2Dom1" and "domibus_C2Dom2" are configured for C2.
- Domains "domibus_C3Dom1" and "domibus_C3Dom2" are configured for C3.
- Create plugin users on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1", "userC1C2Dom2" linked to "originalSender" and domain "domibus_C2Dom2".
- Create plugin users on C3: "userC4C3Dom1" linked to "originalSender" and domain "domibus_C3Dom1", "userC4C3Dom2" linked to "originalSender" and domain "domibus_C3Dom2".
- Set properties (multitenancyModeC2,multitenancyModeC3) to (2,2).
- Certificate configured on domain "domibus_C2Dom1" is only present in the truststore of domain "domibus_C3Dom2".
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="bd2acbf7-48b0-4bfe-aec1-f62d503a65b3" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "2")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 2.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security" id="1f358657-0d1d-4030-a3f0-9ea1ff9efa95" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for both C2 and C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="93cb4a76-766f-4604-8731-71215090cb4d" disabled="true"><con:settings/><con:config><script>// Create users in C2
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
// Create users in C3
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom1","ROLE_USER","userC4C3Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
Domibus.addPluginUser("C3",context,log,"domibus_C3Dom2","ROLE_USER","userC4C3Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="6f4c114a-3d39-4204-abb9-1f6107754f60" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log,"domibus_C3Dom1")
PModeUtils.uploadPmode("C3","default","\\red\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-red.xml",context,log,"domibus_C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="123d6bed-3fed-4e6b-8737-0792117daae5" disabled="true"><con:settings/><con:config><script>// Upload truststores

// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","special","\\Threegateways\\blue\\gateway_truststore.jks",context,log,"domibus_C3Dom1")
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filters to FS" id="cbefc5d5-0a15-498d-add9-480c4e488a44" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendFSPlugin",context,log,"domibus_C2Dom2")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendFSPlugin",context,log,"domibus_C3Dom1")
Domibus.setMessageFilters("C3","backendFSPlugin",context,log,"domibus_C3Dom2")
</script></con:config></con:testStep><con:testStep type="groovy" name="Submit Message" id="d3c92e18-b228-4ecd-b939-1d68a8e48b5d"><con:settings/><con:config><script>// Copy xml payload
def source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\pull\\Test_file.xml";
def dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\Test_file.xml";
Domibus.copyFile(source,dest,log)
// Copy pdf payload
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\pull\\fileSmall.pdf";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\fileSmall.pdf";
Domibus.copyFile(source,dest,log)
// Copy metadata file
source = context.expand('${projectDir}')+"\\resources\\PModesandKeystoresSpecialTests\\fsPlugin\\pull\\metadata.xml";
dest = context.expand('${#Project#pathBlue}')+"\\..\\fs_plugin_data\\domibus_C2Dom1\\OUT\\metadata.xml";
Domibus.copyFile(source,dest,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Test" id="035a2eae-55b2-4b2b-95d2-bd712e0d861c"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Check that the message is acknowledged.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="dbc48afd-92da-499c-94ab-36b67bbd9619" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom2")
// Remove users in C3
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom1")
Domibus.removePluginUser("C3",context,log,"domibus_C3Dom1","userC4C3Dom2");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="b4167628-c513-415d-86d3-4ce897a464a1" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX59-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="e2907f6f-317e-42ec-a372-1212ba406c1c" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DomX60-Multitenancy-Overwrite default properties" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Configuration" id="630e489d-1b9b-4d4f-aed4-0c1638096ee7"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Configure Multitenancy for C2 (enable plugin security, create domain properties file, create domain schema ...)
- Domain "domibus_C2Dom1" is configured for C2.
- Multitenany is not configured for C3.
- Create plugin authentication user on C2: "userC1C2Dom1" linked to "originalSender" and domain "domibus_C2Dom1".
- Create plugin authentication user on C3: "userC4" linked to "finalRecipient".
- Set properties (multitenancyModeC2,multitenancyModeC3) to (1,0).
- Certificate configured in default domain is not present in the truststore of C3.
""", log, testRunner)
</script></con:config></con:testStep><con:testStep type="groovy" name="Configure multitenancy mode" id="a7513cdf-2b85-4714-8710-8c41dd28f616" disabled="true"><con:settings/><con:config><script>testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC2", "2")
testRunner.testCase.testSuite.project.setPropertyValue("multitenancyModeC3", "0")
log.info "multitenancyModeC2 custom property set to 2.";
log.info "multitenancyModeC3 custom property set to 0.";</script></con:config></con:testStep><con:testStep type="groovy" name="Enable plugin security-C2" id="1cb4a1d3-5b04-41d3-aae5-c78410a1a153" disabled="true"><con:settings/><con:config><script>// TODO: automate
Domibus.showPopUpForManualConfigurationChange("""\
Enable plugin security for C2.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Create plugin users" id="4a4bda39-25da-486a-b65f-6a87da78f0d3" disabled="true"><con:settings/><con:config><script>// Create userC1 in C2 ("Default" domain)
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom1","ROLE_USER","userC1C2Dom1","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
Domibus.addPluginUser("C2",context,log,"domibus_C2Dom2","ROLE_USER","userC1C2Dom2","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1")
// Create userC4 in C3 ("Default" domain)
Domibus.addPluginUser("C3",context,log,"Default","ROLE_USER","userC4","DomibusEdel-12345","urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4")
</script></con:config></con:testStep><con:testStep type="groovy" name="Upload PModes" id="fc80143b-b180-4662-8439-94405b222cae" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload pmodes C2 ================"
PModeUtils.uploadPmode("C2","default","\\blue\\domibus_C2Dom1ToC3Dom2\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom1")
PModeUtils.uploadPmode("C2","default","\\blue\\domibus-pmode-blue.xml",context,log,"domibus_C2Dom2")

// C3
log.info "================ Upload pmodes C3 ================"
PModeUtils.uploadPmode("C3","default","\\red\\domibus-pmode-red.xml",context,log);</script></con:config></con:testStep><con:testStep type="groovy" name="Upload Truststores" id="db01f1b4-f1b3-44ad-8f55-d13ca690d351" disabled="true"><con:settings/><con:config><script>// C2
log.info "================ Upload truststores C2 ================"
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom1")
TruststoreUtils.uploadTruststore("C2","default","\\blue\\gateway_truststore.jks",context,log,"domibus_C2Dom2")
// C3
log.info "================ Upload truststores C3 ================"
TruststoreUtils.uploadTruststore("C3","default","\\red\\gateway_truststore.jks",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Set Message Filter WS" id="5c8172cc-92f0-48ec-a8eb-706736c659de" disabled="true"><con:settings/><con:config><script>// Select message filters for C2
Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom1")
Domibus.setMessageFilters("C2","backendWebservice",context,log,"domibus_C2Dom2")
// Select message filters for C3
Domibus.setMessageFilters("C3","backendWebservice",context,log)
</script></con:config></con:testStep><con:testStep type="groovy" name="Update property - test 1" id="ad6a6394-953b-4e84-9a8e-1de13e0c13c7"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- In file "domibus_C2Dom1-domibus.properties" set property "domibus.UI.title.name" to "New AC Title".
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Restart domibus C2 - test 1" id="48c82288-74fb-4925-8477-940c0c34666e"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Restart domibus C2.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Check Result - test 1" id="124d9175-b8f1-42c0-a40e-bd3accad9f6c"><con:settings/><con:config><script>Domibus.showPopUpForManualCheck("""\
- UI title takes the new value when domain "domibus_C2Dom1" is selected.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="delay" name="D1" id="9178ba1e-29bb-4a31-9e40-da5fc5fce944"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Update property - test 2" id="24f3565a-47fa-4508-b6cc-099298f19f94"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- In file "domibus_C3Dom2-domibus.properties" set property "domibus.msh.pull.cron" to a faster frequency than the default.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Restart domibus C3 - test 2" id="1bd41ddf-2d1c-4eaa-873f-bfbab6f53096"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Restart domibus C3.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Check Result - test 2" id="edde2287-75f6-46df-9e1f-03e895737599"><con:settings/><con:config><script>Domibus.showPopUpForManualCheck("""\
- Check that pull requests for domain "domibus_C3Dom2" occurs occording to the new set value.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="delay" name="D2" id="b88cb30e-5b37-4914-a515-5a02a28b229a"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Update property - test 3" id="948e6729-9b6d-4051-b819-0f8e63aac7c7"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- In file "domibus_C2Dom1-domibus.properties" set property "domibus.proxy.enabled" to "true".
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Restart domibus C2 - test 3" id="f35fcfbf-47ef-4944-85da-ffe4e2f936fa"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Restart domibus C2.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Check Result - test 3" id="6b12ec2f-2702-4688-af82-5a4e3fd68b7f"><con:settings/><con:config><script>Domibus.showPopUpForManualCheck("""\
- Proxy is enabled for domain "domibus_C2Dom1".
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="delay" name="D3" id="68082271-4f5c-4825-abfe-ecd193ef24eb"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Update property - test 4" id="d2b452cd-78a8-4e5d-925f-4602e7cd7fb3"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- In file "domibus_C2Dom1-domibus.properties" set property "domibus.sendMessage.messageIdPattern" to "^[A-Z]*$".
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Restart domibus C2 - test 4" id="a494dc90-8572-41b5-88f8-1da475bc7173"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Restart domibus C2.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="request" id="337f91b0-ce4a-49e4-bbf8-630b904004e1" name="Check Result - test 4"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>submitMessage</con:operation><con:request name="Check Result - test 4" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="e022ccff-cc86-4b74-9723-3e474bc04cd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:_1="http://org.ecodex.backend/1_1/" xmlns:xm="http://www.w3.org/2005/05/xmlmime">
   <soap:Header>
      <ns:Messaging>
         <ns:UserMessage>
            <ns:MessageInfo>
               <ns:MessageId>-DomX60-1-</ns:MessageId>
            </ns:MessageInfo>
            <ns:PartyInfo>
               <ns:From>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-blue</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator</ns:Role>
               </ns:From>
               <ns:To>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-red</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder</ns:Role>
               </ns:To>
            </ns:PartyInfo>
            <ns:CollaborationInfo>
               <ns:Service type="tc1">bdx:noprocess</ns:Service>
               <ns:Action>TC1Leg1</ns:Action>
            </ns:CollaborationInfo>
            <ns:MessageProperties>
               <ns:Property name="originalSender">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1</ns:Property>
               <ns:Property name="finalRecipient">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4</ns:Property>
            </ns:MessageProperties>
            <ns:PayloadInfo>
               <ns:PartInfo href="cid:message">
                  <ns:PartProperties>
                     <ns:Property name="MimeType">text/xml</ns:Property>
                  </ns:PartProperties>
               </ns:PartInfo>
            </ns:PayloadInfo>
         </ns:UserMessage>
      </ns:Messaging>
   </soap:Header>
   <soap:Body>
      <_1:submitRequest>
         <payload payloadId="cid:message">
            <value>PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=</value>
         </payload>
      </_1:submitRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="55691702-a96e-4270-b659-69659336509f" name="SOAP Response"/><con:assertion type="Not SOAP Fault Assertion" id="9bea8656-6d5d-48a9-8354-97360f0fddba" name="SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/submitMessage"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="D4" id="47531730-019c-4ce9-ba82-74ded13dfe56"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="groovy" name="Update property - test 5" id="0761fa3f-7d4b-4c76-a3fa-907e52f98fac"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- In file "domibus_C2Dom1-domibus.properties" set property "domibus.sender.trust.validation.onreceiving" to "true".
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="groovy" name="Restart domibus C2 - test 5" id="2b979dab-2d7c-4520-9926-e654cb31707c"><con:settings/><con:config><script>Domibus.showPopUpForManualConfigurationChange("""\
- Restart domibus C2.
""", log, testRunner) </script></con:config></con:testStep><con:testStep type="request" id="6537e38a-d2a7-4e30-8d6b-6d52c5013045" name="Check Result - test 5"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>BackendService_1_1SoapBinding</con:interface><con:operation>submitMessage</con:operation><con:request name="Check Result - test 5" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="e022ccff-cc86-4b74-9723-3e474bc04cd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#localUrl}/services/backend</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:_1="http://org.ecodex.backend/1_1/" xmlns:xm="http://www.w3.org/2005/05/xmlmime">
   <soap:Header>
      <ns:Messaging>
         <ns:UserMessage>
            <ns:MessageInfo>
               <ns:MessageId>-DomX60-2-</ns:MessageId>
            </ns:MessageInfo>
            <ns:PartyInfo>
               <ns:From>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">white-blue</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator</ns:Role>
               </ns:From>
               <ns:To>
                  <ns:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:unregistered">domibus-red</ns:PartyId>
                  <ns:Role>http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder</ns:Role>
               </ns:To>
            </ns:PartyInfo>
            <ns:CollaborationInfo>
               <ns:Service type="tc10">bdx:noprocess</ns:Service>
               <ns:Action>TC10Leg1</ns:Action>
            </ns:CollaborationInfo>
            <ns:MessageProperties>
               <ns:Property name="originalSender">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C1</ns:Property>
               <ns:Property name="finalRecipient">urn:oasis:names:tc:ebcore:partyid-type:unregistered:C4</ns:Property>
            </ns:MessageProperties>
            <ns:PayloadInfo>
               <ns:PartInfo href="cid:message">
                  <ns:PartProperties>
                     <ns:Property name="MimeType">text/xml</ns:Property>
                  </ns:PartProperties>
               </ns:PartInfo>
            </ns:PayloadInfo>
         </ns:UserMessage>
      </ns:Messaging>
   </soap:Header>
   <soap:Body>
      <_1:submitRequest>
         <payload payloadId="cid:message">
            <value>PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGhlbGxvPndvcmxkPC9oZWxsbz4=</value>
         </payload>
      </_1:submitRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="55691702-a96e-4270-b659-69659336509f" name="SOAP Response"/><con:assertion type="Not SOAP Fault Assertion" id="9bea8656-6d5d-48a9-8354-97360f0fddba" name="SOAP Fault"/><con:credentials><con:username>userC1C2Dom1</con:username><con:password>DomibusEdel-12345</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:preemptive>true</con:preemptive><con:authType>Preemptive</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://org.ecodex.backend/1_1/BackendInterface/submitMessage"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Delete plugin users" id="dc01cd0d-298e-45c8-bae4-273eb8662d7c" disabled="true"><con:settings/><con:config><script>// Remove users in C2
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom1","userC1C2Dom1")
Domibus.removePluginUser("C2",context,log,"domibus_C2Dom2","userC1C2Dom2")
// Remove users in C3
Domibus.removePluginUser("C3",context,log,"Default","userC4");</script></con:config></con:testStep><con:testStep type="groovy" name="Delete Message" id="55fc2258-e04a-46a1-b547-9728d6442e3f" disabled="true"><con:settings/><con:config><script>def test = new Domibus(log,null,context)
test.cleanDBMessageIDStartsWith(context.expand('-DomX60-'))
test.finalize()
</script></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:requirements/><con:properties><con:property><con:name>localUrl</con:name><con:value>http://localhost:8280/domibus</con:value></con:property><con:property><con:name>pathExeSender</con:name><con:value>${#Project#pathBlue}bin/</con:value></con:property><con:property><con:name>pathBlue</con:name><con:value>C:/ec/blue/domibus/</con:value></con:property><con:property><con:name>remoteUrl</con:name><con:value>http://localhost:8180/domibus</con:value></con:property><con:property><con:name>pathExeReceiver</con:name><con:value>${#Project#pathRed}bin/</con:value></con:property><con:property><con:name>pathRed</con:name><con:value>C:/ec/red/domibus/</con:value></con:property><con:property><con:name>greenUrl</con:name><con:value>http://localhost:8280/domibus</con:value></con:property><con:property><con:name>pathExeGreen</con:name><con:value>${#Project#pathGreen}/bin/</con:value></con:property><con:property><con:name>thirdGateway</con:name><con:value>false</con:value></con:property><con:property><con:name>reportFilePath</con:name><con:value>${projectDir}\\reports\\Domibus_SoapUI_report.csv</con:value></con:property><con:property><con:name>updateReport</con:name><con:value>true</con:value></con:property><con:property><con:name>pathGreen</con:name><con:value>C:/domibus/greenReceiver/domibus/</con:value></con:property><con:property><con:name>pdfAttachment</con:name><con:value>${projectDir}\\resources\\fileSmall.pdf </con:value></con:property><con:property><con:name>specialPModesPath</con:name><con:value>${projectDir}\\resources\\PModesandKeystoresSpecialTests</con:value></con:property><con:property><con:name>defaultPModesPath</con:name><con:value>${projectDir}\\resources\\PModesandKeystoresDefault</con:value></con:property><con:property><con:name>testEnvUrl</con:name><con:value>http://104.40.147.186:7005/domibus</con:value></con:property><con:property><con:name>moreThan100mbAttachment</con:name><con:value>${projectDir}\\resources\\videoplayback_mp4.pdf</con:value></con:property><con:property><con:name>subPathToDomibusProperties</con:name><con:value>conf/domibus/domibus.properties</con:value></con:property><con:property><con:name>allDomainsProperties</con:name><con:value>{"C2Default":{"site":"C2","domainName":"default","domNo":0,"dbType":"mysql","dbDriver":"com.mysql.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_blue?useLegacyDatetimeCode=false&amp;serverTimezone=UTC","dbUser":"root","dbPassword":"root"},  "C3Default":{"site":"C3","domainName":"default","domNo":0,"dbType":"mysql","dbDriver":"com.mysql.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_red?useLegacyDatetimeCode=false&amp;serverTimezone=UTC","dbUser":"root","dbPassword":"root"}, "C2Dom1":{"site":"C2","domainName":"domibus_C2Dom1","domNo":1,"dbType":"mysql","dbDriver":"com.mysql.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_c2dom1?useLegacyDatetimeCode=false&amp;serverTimezone=UTC","dbUser":"root","dbPassword":"root"}, "C2Dom2":{"site":"C2","domainName":"domibus_C2Dom2","domNo":2,"dbType":"mysql","dbDriver":"com.mysql.jdbc.Driver","dbJdbcUrl":"jdbc:mysql://localhost:3306/domibus_c2dom2?useLegacyDatetimeCode=false&amp;serverTimezone=UTC","dbUser":"root","dbPassword":"root"}}bc:oracle:thin:@localhost:1522/ORCL","dbUser":"domibus_red","dbPassword":"domibus_red"}}</con:value></con:property><con:property><con:name>multitenancyModeC2</con:name><con:value>0</con:value></con:property><con:property><con:name>multitenancyModeC3</con:name><con:value>0</con:value></con:property><con:property><con:name>defaultBlueDomainID</con:name><con:value>C2Default</con:value></con:property><con:property><con:name>defaultRedDomainId</con:name><con:value>C3Default</con:value></con:property><con:property><con:name>defaultGreenDomainID</con:name><con:value>thirdDefault</con:value></con:property><con:property><con:name>adminDefaultPassword</con:name><con:value>DomibusEdel-12345</con:value></con:property><con:property><con:name>pluginAdminC2Default</con:name><con:value>pa_c2dom1</con:value></con:property><con:property><con:name>unsecureLoginAllowed</con:name><con:value>false</con:value></con:property><con:property><con:name>pluginAdminC3Default</con:name><con:value>pa_c3dom1</con:value></con:property><con:property><con:name>allJMSDomainsProperties</con:name><con:value>{"C2Default":{"site":"C2","jmsClientType":"tomcat","jmsUrl":"tcp://localhost:61616","jmsServerUsername":"domibus","jmsServerPassword":"changeit","jmsPluginUsername":"","jmsPluginPassword":"","jmsQueue":"domibus.backend.jms.inQueue","jmsConnectionFactoryJNDI":"jms/RemoteConnectionFactory"},"C3Default":{"site":"C3","jmsClientType":"tomcat","jmsUrl":"tcp://localhost:61716","jmsServerUsername":"domibus","jmsServerPassword":"changeit","jmsPluginUsername":"","jmsPluginPassword":"","jmsQueue":"domibus.backend.jms.inQueue","jmsConnectionFactoryJNDI":"jms/RemoteConnectionFactory"}}</con:value></con:property><con:property><con:name>logsPathBlue</con:name><con:value>${#Project#pathBlue}logs/</con:value></con:property><con:property><con:name>logsPathRed</con:name><con:value>${#Project#pathRed}logs/</con:value></con:property></con:properties><con:wssContainer/><con:databaseConnectionContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:reporting><con:reportTemplates/><con:xmlTemplates/><con:parameters/></con:reporting><con:sensitiveInformation/></con:soapui-project>